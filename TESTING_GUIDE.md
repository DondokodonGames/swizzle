# 動作確認ガイド - 認証・ユーザー管理UI

このドキュメントでは、実装した8つの認証・ユーザー管理UI機能の動作確認方法を説明します。

## 事前準備

1. 開発サーバーを起動
```bash
npm run dev
```

2. ブラウザで `http://localhost:5173` を開く

---

## 問題1: 新規登録フォームのデザイン改善

### 確認方法

1. **アプリを起動してゲーム画面を開く**
2. **画面上部のトップバー左端の「👤」アイコンをクリック**
3. AuthModalが開く
4. 「アカウント作成」タブをクリック（下部のリンクまたはタブ）

### 期待される表示

- ✨ 大きなグラデーションアイコン（🎮、indigo→purple→pink）
- 📝 「アカウント作成」の大きな見出し（text-3xl）
- 🎨 美しいグラデーションボタン（indigo→purple→pink）
- 🔄 丸みのあるモダンなデザイン（rounded-3xl、p-8）
- 💫 ホバー時のスケールアニメーション

### 改善されたポイント

- アイコンサイズ: 16px → 20px
- パディング: p-6 → p-8
- 角丸: rounded-2xl → rounded-3xl
- ボタン: py-3 → py-4、font-semibold → font-bold
- グラデーション: from-pink-500 to-purple-600 → from-indigo-500 via-purple-500 to-pink-500

---

## 問題3: 言語設定の拡張

### 確認方法

1. AuthModalで「アカウント作成」を選択
2. フォームを下にスクロール
3. 「言語」ドロップダウンを開く

### 期待される表示

9つの言語オプション:
- 🇯🇵 日本語
- 🇺🇸 English
- 🇰🇷 한국어
- 🇨🇳 中文
- 🇫🇷 Français
- 🇩🇪 Deutsch
- 🇪🇸 Español
- 🇮🇹 Italiano
- 🇵🇹 Português

### 確認ポイント

- AuthModal、ProfileSetup、SignupPageで同じ言語オプションが表示される
- 選択した言語がプロフィールに正しく保存される
- ProfileSetupで現在の言語設定が正しく表示される

---

## 問題5: 専用の登録画面

### 確認方法（方法1: 直接アクセス）

1. ブラウザのアドレスバーに `/signup` を入力
   - 例: `http://localhost:5173/signup`
2. Enterキーを押す

### 確認方法（方法2: モーダルからのリンク）

1. ゲーム画面のトップバー「👤」アイコンをクリック
2. AuthModalで「アカウント作成」を選択
3. モーダル下部の「または 専用ページで登録」リンクをクリック

### 期待される表示

- 🎨 フルページのグラデーション背景（indigo→purple）
- 📱 レスポンシブデザイン（max-width: 500px）
- ✅ 全てのフィールドが見やすく配置
- 🔗 ログインページへのリンク
- 📝 13歳未満の保護者同意警告機能

### ログインページ

同様に `/login` でログインページにアクセス可能:
- `http://localhost:5173/login`

---

## 問題6: アバター表示

### 確認方法

1. **アカウントを作成してログイン**
2. **ゲーム画面のトップバー左端を確認**

### 期待される表示

**アバター画像がある場合:**
- 🖼️ 丸い画像（34px × 34px）
- ⚪ 白いボーダー（2px）
- 📐 object-fit: cover で綺麗に表示

**アバター画像がない場合:**
- 🔤 イニシャルが表示される（display_name または username の最初の文字）
- 🎨 グラデーション背景（rgba(255, 255, 255, 0.3)）
- ⚪ 丸い形状

### 確認ポイント

- GameSequence.tsxのトップバー（ゲーム画面）
- App.tsxの認証ユーザー情報（メイン画面）
- 両方で同じアバター表示ロジックが動作

---

## 問題7: プロフィール表示専用ページ

### 確認方法（方法1: 直接アクセス）

1. ログイン後、自分のユーザー名を確認
2. ブラウザのアドレスバーに `/profile/あなたのユーザー名` を入力
   - 例: `http://localhost:5173/profile/testuser`

### 確認方法（方法2: トップバーから）

1. ログイン後、トップバー左端のアバターをクリック
2. プロフィール編集モーダルが開く
3. （将来的に）モーダルから専用ページへのリンクを追加予定

### 期待される表示

- 🖼️ 大きなアバター画像（120px × 120px）
- 👤 ユーザー名、表示名、@ユーザー名
- 📝 自己紹介文
- 🌐 言語設定
- 📅 登録日
- 🎮 作成したゲーム一覧（近日実装予定）

### デザイン特徴

- グラデーション背景
- カード型レイアウト
- レスポンシブデザイン
- 「戻る」ボタン

---

## 問題8: アバター画像の変更

### 確認方法

1. **ログイン後、トップバー左端のアバター/イニシャルをクリック**
2. プロフィール編集モーダルが開く
3. 「👤 プロフィール」タブを選択（デフォルトで選択済み）
4. **「アバター画像」セクション**を確認

### アバター画像のアップロード手順

1. 「📷 画像を選択」ボタンをクリック
2. ファイル選択ダイアログが開く
3. 画像ファイル（PNG、JPG、GIF）を選択
   - **最大5MB**
   - 画像形式のみ受付

### 期待される表示

**選択前:**
- 🎨 グラデーション背景（pink→purple）
- 🔤 イニシャル表示

**選択後:**
- 🖼️ 選択した画像のプレビュー表示（24px × 24px）
- ❌ 削除ボタン（×）が右上に表示
- ⚠️ バリデーションメッセージ（エラー時）

**保存:**
- 💾 画面下部の「保存」ボタンをクリック
- ⏳ 「アップロード中...」表示
- ✅ 「プロフィールを保存しました！」メッセージ

### バリデーション

- ✅ 5MB以下の画像のみ
- ❌ 5MBを超える場合: 「画像サイズは5MB以下にしてください」
- ❌ 画像以外のファイル: 「画像ファイルを選択してください」

### アバター削除

1. 削除ボタン（×）をクリック
2. プレビューが消える
3. 「保存」ボタンをクリック
4. アバターが削除され、イニシャル表示に戻る

---

## 問題10: 保存ボタンの固定表示

### 確認方法

1. ログイン後、トップバーのアバターをクリック
2. プロフィール編集モーダルが開く
3. **全てのフィールドを確認しながらスクロール**

### 期待される動作

**修正前の問題:**
- ❌ モーダル全体がスクロール
- ❌ 保存ボタンが画面外に移動
- ❌ スクロールしないと保存できない

**修正後:**
- ✅ **保存ボタンが画面下部に固定表示**
- ✅ フォーム内容だけがスクロール
- ✅ いつでも保存ボタンが見える

### デザイン構造

```
┌─────────────────────┐
│ ヘッダー（固定）    │ ← flex-shrink-0
├─────────────────────┤
│                     │
│ スクロール可能な    │ ← flex-1 overflow-y-auto
│ フォーム内容        │
│                     │
├─────────────────────┤
│ 保存ボタン（固定）  │ ← flex-shrink-0
└─────────────────────┘
```

### ボタンの状態

- 🔴 変更なし: 無効化（disabled）
- 🟡 変更あり + エラー: 無効化
- 🟢 変更あり + エラーなし: 有効
- ⏳ アップロード中: 無効化 + 「アップロード中...」
- ⏳ 保存中: 無効化 + 「保存中...」

---

## トラブルシューティング

### AuthModalが表示されない

1. ブラウザのコンソールでエラーを確認
2. `VITE_ENABLE_AUTH=true` が設定されているか確認
3. Supabaseの接続を確認

### アバター画像がアップロードできない

1. Supabaseのストレージ設定を確認
2. `avatars` バケットが作成されているか確認
3. バケットのポリシー設定を確認（公開読み取り、認証済みユーザーの書き込み）

### 専用ページが404エラー

1. React Routerの設定を確認（App.tsx）
2. 開発サーバーを再起動
3. `/signup`, `/login`, `/profile/:username` ルートが定義されているか確認

### 言語設定が保存されない

1. ブラウザのコンソールでエラーを確認
2. Profileテーブルのlanguageカラムが存在するか確認
3. useAuth hookのupdateProfile関数を確認

---

## まとめ

全ての機能が正しく動作している場合:

- ✅ 問題1: モダンなデザインのAuthModal
- ✅ 問題3: 9言語対応の言語設定
- ✅ 問題5: `/signup`、`/login` の専用ページ
- ✅ 問題6: トップバーにアバター/イニシャル表示
- ✅ 問題7: `/profile/:username` の専用ページ
- ✅ 問題8: アバター画像のアップロード・削除
- ✅ 問題10: 保存ボタンが常に画面下部に固定表示

何か問題があれば、このガイドのトラブルシューティングセクションを参照するか、ブラウザのコンソールでエラーメッセージを確認してください。
