var Ix=Object.defineProperty;var Rx=(r,e,t)=>e in r?Ix(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var he=(r,e,t)=>(Rx(r,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var bs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ad(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Px(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),t}var _g={exports:{}},Tl={},wg={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ho=Symbol.for("react.element"),Mx=Symbol.for("react.portal"),kx=Symbol.for("react.fragment"),Dx=Symbol.for("react.strict_mode"),Bx=Symbol.for("react.profiler"),Ox=Symbol.for("react.provider"),Fx=Symbol.for("react.context"),Nx=Symbol.for("react.forward_ref"),Lx=Symbol.for("react.suspense"),Ux=Symbol.for("react.memo"),Gx=Symbol.for("react.lazy"),xf=Symbol.iterator;function zx(r){return r===null||typeof r!="object"?null:(r=xf&&r[xf]||r["@@iterator"],typeof r=="function"?r:null)}var Eg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Tg=Object.assign,Sg={};function Yn(r,e,t){this.props=r,this.context=e,this.refs=Sg,this.updater=t||Eg}Yn.prototype.isReactComponent={};Yn.prototype.setState=function(r,e){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,e,"setState")};Yn.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function bg(){}bg.prototype=Yn.prototype;function ld(r,e,t){this.props=r,this.context=e,this.refs=Sg,this.updater=t||Eg}var hd=ld.prototype=new bg;hd.constructor=ld;Tg(hd,Yn.prototype);hd.isPureReactComponent=!0;var _f=Array.isArray,Ag=Object.prototype.hasOwnProperty,ud={current:null},Cg={key:!0,ref:!0,__self:!0,__source:!0};function Ig(r,e,t){var i,n={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Ag.call(e,i)&&!Cg.hasOwnProperty(i)&&(n[i]=e[i]);var a=arguments.length-2;if(a===1)n.children=t;else if(1<a){for(var l=Array(a),h=0;h<a;h++)l[h]=arguments[h+2];n.children=l}if(r&&r.defaultProps)for(i in a=r.defaultProps,a)n[i]===void 0&&(n[i]=a[i]);return{$$typeof:ho,type:r,key:s,ref:o,props:n,_owner:ud.current}}function jx(r,e){return{$$typeof:ho,type:r.type,key:e,ref:r.ref,props:r.props,_owner:r._owner}}function cd(r){return typeof r=="object"&&r!==null&&r.$$typeof===ho}function Hx(r){var e={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(t){return e[t]})}var wf=/\/+/g;function Jl(r,e){return typeof r=="object"&&r!==null&&r.key!=null?Hx(""+r.key):e.toString(36)}function ca(r,e,t,i,n){var s=typeof r;(s==="undefined"||s==="boolean")&&(r=null);var o=!1;if(r===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(r.$$typeof){case ho:case Mx:o=!0}}if(o)return o=r,n=n(o),r=i===""?"."+Jl(o,0):i,_f(n)?(t="",r!=null&&(t=r.replace(wf,"$&/")+"/"),ca(n,e,t,"",function(h){return h})):n!=null&&(cd(n)&&(n=jx(n,t+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(wf,"$&/")+"/")+r)),e.push(n)),1;if(o=0,i=i===""?".":i+":",_f(r))for(var a=0;a<r.length;a++){s=r[a];var l=i+Jl(s,a);o+=ca(s,e,t,l,n)}else if(l=zx(r),typeof l=="function")for(r=l.call(r),a=0;!(s=r.next()).done;)s=s.value,l=i+Jl(s,a++),o+=ca(s,e,t,l,n);else if(s==="object")throw e=String(r),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function To(r,e,t){if(r==null)return r;var i=[],n=0;return ca(r,i,"","",function(s){return e.call(t,s,n++)}),i}function $x(r){if(r._status===-1){var e=r._result;e=e(),e.then(function(t){(r._status===0||r._status===-1)&&(r._status=1,r._result=t)},function(t){(r._status===0||r._status===-1)&&(r._status=2,r._result=t)}),r._status===-1&&(r._status=0,r._result=e)}if(r._status===1)return r._result.default;throw r._result}var nt={current:null},da={transition:null},Vx={ReactCurrentDispatcher:nt,ReactCurrentBatchConfig:da,ReactCurrentOwner:ud};function Rg(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:To,forEach:function(r,e,t){To(r,function(){e.apply(this,arguments)},t)},count:function(r){var e=0;return To(r,function(){e++}),e},toArray:function(r){return To(r,function(e){return e})||[]},only:function(r){if(!cd(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};re.Component=Yn;re.Fragment=kx;re.Profiler=Bx;re.PureComponent=ld;re.StrictMode=Dx;re.Suspense=Lx;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vx;re.act=Rg;re.cloneElement=function(r,e,t){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var i=Tg({},r.props),n=r.key,s=r.ref,o=r._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ud.current),e.key!==void 0&&(n=""+e.key),r.type&&r.type.defaultProps)var a=r.type.defaultProps;for(l in e)Ag.call(e,l)&&!Cg.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var h=0;h<l;h++)a[h]=arguments[h+2];i.children=a}return{$$typeof:ho,type:r.type,key:n,ref:s,props:i,_owner:o}};re.createContext=function(r){return r={$$typeof:Fx,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:Ox,_context:r},r.Consumer=r};re.createElement=Ig;re.createFactory=function(r){var e=Ig.bind(null,r);return e.type=r,e};re.createRef=function(){return{current:null}};re.forwardRef=function(r){return{$$typeof:Nx,render:r}};re.isValidElement=cd;re.lazy=function(r){return{$$typeof:Gx,_payload:{_status:-1,_result:r},_init:$x}};re.memo=function(r,e){return{$$typeof:Ux,type:r,compare:e===void 0?null:e}};re.startTransition=function(r){var e=da.transition;da.transition={};try{r()}finally{da.transition=e}};re.unstable_act=Rg;re.useCallback=function(r,e){return nt.current.useCallback(r,e)};re.useContext=function(r){return nt.current.useContext(r)};re.useDebugValue=function(){};re.useDeferredValue=function(r){return nt.current.useDeferredValue(r)};re.useEffect=function(r,e){return nt.current.useEffect(r,e)};re.useId=function(){return nt.current.useId()};re.useImperativeHandle=function(r,e,t){return nt.current.useImperativeHandle(r,e,t)};re.useInsertionEffect=function(r,e){return nt.current.useInsertionEffect(r,e)};re.useLayoutEffect=function(r,e){return nt.current.useLayoutEffect(r,e)};re.useMemo=function(r,e){return nt.current.useMemo(r,e)};re.useReducer=function(r,e,t){return nt.current.useReducer(r,e,t)};re.useRef=function(r){return nt.current.useRef(r)};re.useState=function(r){return nt.current.useState(r)};re.useSyncExternalStore=function(r,e,t){return nt.current.useSyncExternalStore(r,e,t)};re.useTransition=function(){return nt.current.useTransition()};re.version="18.3.1";wg.exports=re;var V=wg.exports;const uo=ad(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx=V,Xx=Symbol.for("react.element"),Yx=Symbol.for("react.fragment"),Kx=Object.prototype.hasOwnProperty,qx=Wx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zx={key:!0,ref:!0,__self:!0,__source:!0};function Pg(r,e,t){var i,n={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)Kx.call(e,i)&&!Zx.hasOwnProperty(i)&&(n[i]=e[i]);if(r&&r.defaultProps)for(i in e=r.defaultProps,e)n[i]===void 0&&(n[i]=e[i]);return{$$typeof:Xx,type:r,key:s,ref:o,props:n,_owner:qx.current}}Tl.Fragment=Yx;Tl.jsx=Pg;Tl.jsxs=Pg;_g.exports=Tl;var w=_g.exports,vu={},Mg={exports:{}},xt={},kg={exports:{}},Dg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function e(I,z){var C=I.length;I.push(z);e:for(;0<C;){var M=C-1>>>1,q=I[M];if(0<n(q,z))I[M]=z,I[C]=q,C=M;else break e}}function t(I){return I.length===0?null:I[0]}function i(I){if(I.length===0)return null;var z=I[0],C=I.pop();if(C!==z){I[0]=C;e:for(var M=0,q=I.length,se=q>>>1;M<se;){var ie=2*(M+1)-1,be=I[ie],le=ie+1,ve=I[le];if(0>n(be,C))le<q&&0>n(ve,be)?(I[M]=ve,I[le]=C,M=le):(I[M]=be,I[ie]=C,M=ie);else if(le<q&&0>n(ve,C))I[M]=ve,I[le]=C,M=le;else break e}}return z}function n(I,z){var C=I.sortIndex-z.sortIndex;return C!==0?C:I.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var l=[],h=[],u=1,c=null,d=3,f=!1,p=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(I){for(var z=t(h);z!==null;){if(z.callback===null)i(h);else if(z.startTime<=I)i(h),z.sortIndex=z.expirationTime,e(l,z);else break;z=t(h)}}function _(I){if(v=!1,m(I),!p)if(t(l)!==null)p=!0,j(E);else{var z=t(h);z!==null&&N(_,z.startTime-I)}}function E(I,z){p=!1,v&&(v=!1,g(S),S=-1),f=!0;var C=d;try{for(m(z),c=t(l);c!==null&&(!(c.expirationTime>z)||I&&!K());){var M=c.callback;if(typeof M=="function"){c.callback=null,d=c.priorityLevel;var q=M(c.expirationTime<=z);z=r.unstable_now(),typeof q=="function"?c.callback=q:c===t(l)&&i(l),m(z)}else i(l);c=t(l)}if(c!==null)var se=!0;else{var ie=t(h);ie!==null&&N(_,ie.startTime-z),se=!1}return se}finally{c=null,d=C,f=!1}}var b=!1,T=null,S=-1,P=5,R=-1;function K(){return!(r.unstable_now()-R<P)}function F(){if(T!==null){var I=r.unstable_now();R=I;var z=!0;try{z=T(!0,I)}finally{z?A():(b=!1,T=null)}}else b=!1}var A;if(typeof y=="function")A=function(){y(F)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,k=D.port2;D.port1.onmessage=F,A=function(){k.postMessage(null)}}else A=function(){x(F,0)};function j(I){T=I,b||(b=!0,A())}function N(I,z){S=x(function(){I(r.unstable_now())},z)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(I){I.callback=null},r.unstable_continueExecution=function(){p||f||(p=!0,j(E))},r.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<I?Math.floor(1e3/I):5},r.unstable_getCurrentPriorityLevel=function(){return d},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(I){switch(d){case 1:case 2:case 3:var z=3;break;default:z=d}var C=d;d=z;try{return I()}finally{d=C}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(I,z){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var C=d;d=I;try{return z()}finally{d=C}},r.unstable_scheduleCallback=function(I,z,C){var M=r.unstable_now();switch(typeof C=="object"&&C!==null?(C=C.delay,C=typeof C=="number"&&0<C?M+C:M):C=M,I){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=C+q,I={id:u++,callback:z,priorityLevel:I,startTime:C,expirationTime:q,sortIndex:-1},C>M?(I.sortIndex=C,e(h,I),t(l)===null&&I===t(h)&&(v?(g(S),S=-1):v=!0,N(_,C-M))):(I.sortIndex=q,e(l,I),p||f||(p=!0,j(E))),I},r.unstable_shouldYield=K,r.unstable_wrapCallback=function(I){var z=d;return function(){var C=d;d=z;try{return I.apply(this,arguments)}finally{d=C}}}})(Dg);kg.exports=Dg;var Qx=kg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jx=V,vt=Qx;function B(r){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+r,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+r+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Bg=new Set,Gs={};function $i(r,e){Ln(r,e),Ln(r+"Capture",e)}function Ln(r,e){for(Gs[r]=e,r=0;r<e.length;r++)Bg.add(e[r])}var Ir=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xu=Object.prototype.hasOwnProperty,e_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ef={},Tf={};function t_(r){return xu.call(Tf,r)?!0:xu.call(Ef,r)?!1:e_.test(r)?Tf[r]=!0:(Ef[r]=!0,!1)}function r_(r,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function i_(r,e,t,i){if(e===null||typeof e>"u"||r_(r,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function st(r,e,t,i,n,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=r,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ke={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Ke[r]=new st(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var e=r[0];Ke[e]=new st(e,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){Ke[r]=new st(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Ke[r]=new st(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Ke[r]=new st(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){Ke[r]=new st(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){Ke[r]=new st(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){Ke[r]=new st(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){Ke[r]=new st(r,5,!1,r.toLowerCase(),null,!1,!1)});var dd=/[\-:]([a-z])/g;function fd(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var e=r.replace(dd,fd);Ke[e]=new st(e,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var e=r.replace(dd,fd);Ke[e]=new st(e,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var e=r.replace(dd,fd);Ke[e]=new st(e,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){Ke[r]=new st(r,1,!1,r.toLowerCase(),null,!1,!1)});Ke.xlinkHref=new st("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){Ke[r]=new st(r,1,!1,r.toLowerCase(),null,!0,!0)});function pd(r,e,t,i){var n=Ke.hasOwnProperty(e)?Ke[e]:null;(n!==null?n.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(i_(e,t,n,i)&&(t=null),i||n===null?t_(e)&&(t===null?r.removeAttribute(e):r.setAttribute(e,""+t)):n.mustUseProperty?r[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,i=n.attributeNamespace,t===null?r.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,i?r.setAttributeNS(i,e,t):r.setAttribute(e,t))))}var Br=Jx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,So=Symbol.for("react.element"),hn=Symbol.for("react.portal"),un=Symbol.for("react.fragment"),md=Symbol.for("react.strict_mode"),_u=Symbol.for("react.profiler"),Og=Symbol.for("react.provider"),Fg=Symbol.for("react.context"),gd=Symbol.for("react.forward_ref"),wu=Symbol.for("react.suspense"),Eu=Symbol.for("react.suspense_list"),yd=Symbol.for("react.memo"),Ur=Symbol.for("react.lazy"),Ng=Symbol.for("react.offscreen"),Sf=Symbol.iterator;function ts(r){return r===null||typeof r!="object"?null:(r=Sf&&r[Sf]||r["@@iterator"],typeof r=="function"?r:null)}var Te=Object.assign,eh;function ps(r){if(eh===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);eh=e&&e[1]||""}return`
`+eh+r}var th=!1;function rh(r,e){if(!r||th)return"";th=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var i=h}Reflect.construct(r,[],e)}else{try{e.call()}catch(h){i=h}r.call(e.prototype)}else{try{throw Error()}catch(h){i=h}r()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var n=h.stack.split(`
`),s=i.stack.split(`
`),o=n.length-1,a=s.length-1;1<=o&&0<=a&&n[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(n[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||n[o]!==s[a]){var l=`
`+n[o].replace(" at new "," at ");return r.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",r.displayName)),l}while(1<=o&&0<=a);break}}}finally{th=!1,Error.prepareStackTrace=t}return(r=r?r.displayName||r.name:"")?ps(r):""}function n_(r){switch(r.tag){case 5:return ps(r.type);case 16:return ps("Lazy");case 13:return ps("Suspense");case 19:return ps("SuspenseList");case 0:case 2:case 15:return r=rh(r.type,!1),r;case 11:return r=rh(r.type.render,!1),r;case 1:return r=rh(r.type,!0),r;default:return""}}function Tu(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case un:return"Fragment";case hn:return"Portal";case _u:return"Profiler";case md:return"StrictMode";case wu:return"Suspense";case Eu:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Fg:return(r.displayName||"Context")+".Consumer";case Og:return(r._context.displayName||"Context")+".Provider";case gd:var e=r.render;return r=r.displayName,r||(r=e.displayName||e.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case yd:return e=r.displayName||null,e!==null?e:Tu(r.type)||"Memo";case Ur:e=r._payload,r=r._init;try{return Tu(r(e))}catch{}}return null}function s_(r){var e=r.type;switch(r.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=e.render,r=r.displayName||r.name||"",e.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tu(e);case 8:return e===md?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function si(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Lg(r){var e=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function o_(r){var e=Lg(r)?"checked":"value",t=Object.getOwnPropertyDescriptor(r.constructor.prototype,e),i=""+r[e];if(!r.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,s=t.set;return Object.defineProperty(r,e,{configurable:!0,get:function(){return n.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(r,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){r._valueTracker=null,delete r[e]}}}}function bo(r){r._valueTracker||(r._valueTracker=o_(r))}function Ug(r){if(!r)return!1;var e=r._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return r&&(i=Lg(r)?r.checked?"true":"false":r.value),r=i,r!==t?(e.setValue(r),!0):!1}function Ba(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Su(r,e){var t=e.checked;return Te({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??r._wrapperState.initialChecked})}function bf(r,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=si(e.value!=null?e.value:t),r._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Gg(r,e){e=e.checked,e!=null&&pd(r,"checked",e,!1)}function bu(r,e){Gg(r,e);var t=si(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&r.value===""||r.value!=t)&&(r.value=""+t):r.value!==""+t&&(r.value=""+t);else if(i==="submit"||i==="reset"){r.removeAttribute("value");return}e.hasOwnProperty("value")?Au(r,e.type,t):e.hasOwnProperty("defaultValue")&&Au(r,e.type,si(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(r.defaultChecked=!!e.defaultChecked)}function Af(r,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+r._wrapperState.initialValue,t||e===r.value||(r.value=e),r.defaultValue=e}t=r.name,t!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,t!==""&&(r.name=t)}function Au(r,e,t){(e!=="number"||Ba(r.ownerDocument)!==r)&&(t==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+t&&(r.defaultValue=""+t))}var ms=Array.isArray;function Sn(r,e,t,i){if(r=r.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<r.length;t++)n=e.hasOwnProperty("$"+r[t].value),r[t].selected!==n&&(r[t].selected=n),n&&i&&(r[t].defaultSelected=!0)}else{for(t=""+si(t),e=null,n=0;n<r.length;n++){if(r[n].value===t){r[n].selected=!0,i&&(r[n].defaultSelected=!0);return}e!==null||r[n].disabled||(e=r[n])}e!==null&&(e.selected=!0)}}function Cu(r,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return Te({},e,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Cf(r,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(B(92));if(ms(t)){if(1<t.length)throw Error(B(93));t=t[0]}e=t}e==null&&(e=""),t=e}r._wrapperState={initialValue:si(t)}}function zg(r,e){var t=si(e.value),i=si(e.defaultValue);t!=null&&(t=""+t,t!==r.value&&(r.value=t),e.defaultValue==null&&r.defaultValue!==t&&(r.defaultValue=t)),i!=null&&(r.defaultValue=""+i)}function If(r){var e=r.textContent;e===r._wrapperState.initialValue&&e!==""&&e!==null&&(r.value=e)}function jg(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Iu(r,e){return r==null||r==="http://www.w3.org/1999/xhtml"?jg(e):r==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Ao,Hg=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction(function(){return r(e,t,i,n)})}:r}(function(r,e){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=e;else{for(Ao=Ao||document.createElement("div"),Ao.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ao.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;e.firstChild;)r.appendChild(e.firstChild)}});function zs(r,e){if(e){var t=r.firstChild;if(t&&t===r.lastChild&&t.nodeType===3){t.nodeValue=e;return}}r.textContent=e}var As={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a_=["Webkit","ms","Moz","O"];Object.keys(As).forEach(function(r){a_.forEach(function(e){e=e+r.charAt(0).toUpperCase()+r.substring(1),As[e]=As[r]})});function $g(r,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||As.hasOwnProperty(r)&&As[r]?(""+e).trim():e+"px"}function Vg(r,e){r=r.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,n=$g(t,e[t],i);t==="float"&&(t="cssFloat"),i?r.setProperty(t,n):r[t]=n}}var l_=Te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ru(r,e){if(e){if(l_[r]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,r));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function Pu(r,e){if(r.indexOf("-")===-1)return typeof e.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mu=null;function vd(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ku=null,bn=null,An=null;function Rf(r){if(r=po(r)){if(typeof ku!="function")throw Error(B(280));var e=r.stateNode;e&&(e=Il(e),ku(r.stateNode,r.type,e))}}function Wg(r){bn?An?An.push(r):An=[r]:bn=r}function Xg(){if(bn){var r=bn,e=An;if(An=bn=null,Rf(r),e)for(r=0;r<e.length;r++)Rf(e[r])}}function Yg(r,e){return r(e)}function Kg(){}var ih=!1;function qg(r,e,t){if(ih)return r(e,t);ih=!0;try{return Yg(r,e,t)}finally{ih=!1,(bn!==null||An!==null)&&(Kg(),Xg())}}function js(r,e){var t=r.stateNode;if(t===null)return null;var i=Il(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(r=r.type,i=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!i;break e;default:r=!1}if(r)return null;if(t&&typeof t!="function")throw Error(B(231,e,typeof t));return t}var Du=!1;if(Ir)try{var rs={};Object.defineProperty(rs,"passive",{get:function(){Du=!0}}),window.addEventListener("test",rs,rs),window.removeEventListener("test",rs,rs)}catch{Du=!1}function h_(r,e,t,i,n,s,o,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(u){this.onError(u)}}var Cs=!1,Oa=null,Fa=!1,Bu=null,u_={onError:function(r){Cs=!0,Oa=r}};function c_(r,e,t,i,n,s,o,a,l){Cs=!1,Oa=null,h_.apply(u_,arguments)}function d_(r,e,t,i,n,s,o,a,l){if(c_.apply(this,arguments),Cs){if(Cs){var h=Oa;Cs=!1,Oa=null}else throw Error(B(198));Fa||(Fa=!0,Bu=h)}}function Vi(r){var e=r,t=r;if(r.alternate)for(;e.return;)e=e.return;else{r=e;do e=r,e.flags&4098&&(t=e.return),r=e.return;while(r)}return e.tag===3?t:null}function Zg(r){if(r.tag===13){var e=r.memoizedState;if(e===null&&(r=r.alternate,r!==null&&(e=r.memoizedState)),e!==null)return e.dehydrated}return null}function Pf(r){if(Vi(r)!==r)throw Error(B(188))}function f_(r){var e=r.alternate;if(!e){if(e=Vi(r),e===null)throw Error(B(188));return e!==r?null:r}for(var t=r,i=e;;){var n=t.return;if(n===null)break;var s=n.alternate;if(s===null){if(i=n.return,i!==null){t=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===t)return Pf(n),r;if(s===i)return Pf(n),e;s=s.sibling}throw Error(B(188))}if(t.return!==i.return)t=n,i=s;else{for(var o=!1,a=n.child;a;){if(a===t){o=!0,t=n,i=s;break}if(a===i){o=!0,i=n,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=n;break}if(a===i){o=!0,i=s,t=n;break}a=a.sibling}if(!o)throw Error(B(189))}}if(t.alternate!==i)throw Error(B(190))}if(t.tag!==3)throw Error(B(188));return t.stateNode.current===t?r:e}function Qg(r){return r=f_(r),r!==null?Jg(r):null}function Jg(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var e=Jg(r);if(e!==null)return e;r=r.sibling}return null}var e0=vt.unstable_scheduleCallback,Mf=vt.unstable_cancelCallback,p_=vt.unstable_shouldYield,m_=vt.unstable_requestPaint,Re=vt.unstable_now,g_=vt.unstable_getCurrentPriorityLevel,xd=vt.unstable_ImmediatePriority,t0=vt.unstable_UserBlockingPriority,Na=vt.unstable_NormalPriority,y_=vt.unstable_LowPriority,r0=vt.unstable_IdlePriority,Sl=null,ar=null;function v_(r){if(ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(Sl,r,void 0,(r.current.flags&128)===128)}catch{}}var Gt=Math.clz32?Math.clz32:w_,x_=Math.log,__=Math.LN2;function w_(r){return r>>>=0,r===0?32:31-(x_(r)/__|0)|0}var Co=64,Io=4194304;function gs(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function La(r,e){var t=r.pendingLanes;if(t===0)return 0;var i=0,n=r.suspendedLanes,s=r.pingedLanes,o=t&268435455;if(o!==0){var a=o&~n;a!==0?i=gs(a):(s&=o,s!==0&&(i=gs(s)))}else o=t&~n,o!==0?i=gs(o):s!==0&&(i=gs(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&n)&&(n=i&-i,s=e&-e,n>=s||n===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=r.entangledLanes,e!==0)for(r=r.entanglements,e&=i;0<e;)t=31-Gt(e),n=1<<t,i|=r[t],e&=~n;return i}function E_(r,e){switch(r){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function T_(r,e){for(var t=r.suspendedLanes,i=r.pingedLanes,n=r.expirationTimes,s=r.pendingLanes;0<s;){var o=31-Gt(s),a=1<<o,l=n[o];l===-1?(!(a&t)||a&i)&&(n[o]=E_(a,e)):l<=e&&(r.expiredLanes|=a),s&=~a}}function Ou(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function i0(){var r=Co;return Co<<=1,!(Co&4194240)&&(Co=64),r}function nh(r){for(var e=[],t=0;31>t;t++)e.push(r);return e}function co(r,e,t){r.pendingLanes|=e,e!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,e=31-Gt(e),r[e]=t}function S_(r,e){var t=r.pendingLanes&~e;r.pendingLanes=e,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=e,r.mutableReadLanes&=e,r.entangledLanes&=e,e=r.entanglements;var i=r.eventTimes;for(r=r.expirationTimes;0<t;){var n=31-Gt(t),s=1<<n;e[n]=0,i[n]=-1,r[n]=-1,t&=~s}}function _d(r,e){var t=r.entangledLanes|=e;for(r=r.entanglements;t;){var i=31-Gt(t),n=1<<i;n&e|r[i]&e&&(r[i]|=e),t&=~n}}var ae=0;function n0(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var s0,wd,o0,a0,l0,Fu=!1,Ro=[],qr=null,Zr=null,Qr=null,Hs=new Map,$s=new Map,jr=[],b_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kf(r,e){switch(r){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Zr=null;break;case"mouseover":case"mouseout":Qr=null;break;case"pointerover":case"pointerout":Hs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$s.delete(e.pointerId)}}function is(r,e,t,i,n,s){return r===null||r.nativeEvent!==s?(r={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[n]},e!==null&&(e=po(e),e!==null&&wd(e)),r):(r.eventSystemFlags|=i,e=r.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),r)}function A_(r,e,t,i,n){switch(e){case"focusin":return qr=is(qr,r,e,t,i,n),!0;case"dragenter":return Zr=is(Zr,r,e,t,i,n),!0;case"mouseover":return Qr=is(Qr,r,e,t,i,n),!0;case"pointerover":var s=n.pointerId;return Hs.set(s,is(Hs.get(s)||null,r,e,t,i,n)),!0;case"gotpointercapture":return s=n.pointerId,$s.set(s,is($s.get(s)||null,r,e,t,i,n)),!0}return!1}function h0(r){var e=Ai(r.target);if(e!==null){var t=Vi(e);if(t!==null){if(e=t.tag,e===13){if(e=Zg(t),e!==null){r.blockedOn=e,l0(r.priority,function(){o0(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){r.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}r.blockedOn=null}function fa(r){if(r.blockedOn!==null)return!1;for(var e=r.targetContainers;0<e.length;){var t=Nu(r.domEventName,r.eventSystemFlags,e[0],r.nativeEvent);if(t===null){t=r.nativeEvent;var i=new t.constructor(t.type,t);Mu=i,t.target.dispatchEvent(i),Mu=null}else return e=po(t),e!==null&&wd(e),r.blockedOn=t,!1;e.shift()}return!0}function Df(r,e,t){fa(r)&&t.delete(e)}function C_(){Fu=!1,qr!==null&&fa(qr)&&(qr=null),Zr!==null&&fa(Zr)&&(Zr=null),Qr!==null&&fa(Qr)&&(Qr=null),Hs.forEach(Df),$s.forEach(Df)}function ns(r,e){r.blockedOn===e&&(r.blockedOn=null,Fu||(Fu=!0,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,C_)))}function Vs(r){function e(n){return ns(n,r)}if(0<Ro.length){ns(Ro[0],r);for(var t=1;t<Ro.length;t++){var i=Ro[t];i.blockedOn===r&&(i.blockedOn=null)}}for(qr!==null&&ns(qr,r),Zr!==null&&ns(Zr,r),Qr!==null&&ns(Qr,r),Hs.forEach(e),$s.forEach(e),t=0;t<jr.length;t++)i=jr[t],i.blockedOn===r&&(i.blockedOn=null);for(;0<jr.length&&(t=jr[0],t.blockedOn===null);)h0(t),t.blockedOn===null&&jr.shift()}var Cn=Br.ReactCurrentBatchConfig,Ua=!0;function I_(r,e,t,i){var n=ae,s=Cn.transition;Cn.transition=null;try{ae=1,Ed(r,e,t,i)}finally{ae=n,Cn.transition=s}}function R_(r,e,t,i){var n=ae,s=Cn.transition;Cn.transition=null;try{ae=4,Ed(r,e,t,i)}finally{ae=n,Cn.transition=s}}function Ed(r,e,t,i){if(Ua){var n=Nu(r,e,t,i);if(n===null)ph(r,e,i,Ga,t),kf(r,i);else if(A_(n,r,e,t,i))i.stopPropagation();else if(kf(r,i),e&4&&-1<b_.indexOf(r)){for(;n!==null;){var s=po(n);if(s!==null&&s0(s),s=Nu(r,e,t,i),s===null&&ph(r,e,i,Ga,t),s===n)break;n=s}n!==null&&i.stopPropagation()}else ph(r,e,i,null,t)}}var Ga=null;function Nu(r,e,t,i){if(Ga=null,r=vd(i),r=Ai(r),r!==null)if(e=Vi(r),e===null)r=null;else if(t=e.tag,t===13){if(r=Zg(e),r!==null)return r;r=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;r=null}else e!==r&&(r=null);return Ga=r,null}function u0(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g_()){case xd:return 1;case t0:return 4;case Na:case y_:return 16;case r0:return 536870912;default:return 16}default:return 16}}var Vr=null,Td=null,pa=null;function c0(){if(pa)return pa;var r,e=Td,t=e.length,i,n="value"in Vr?Vr.value:Vr.textContent,s=n.length;for(r=0;r<t&&e[r]===n[r];r++);var o=t-r;for(i=1;i<=o&&e[t-i]===n[s-i];i++);return pa=n.slice(r,1<i?1-i:void 0)}function ma(r){var e=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&e===13&&(r=13)):r=e,r===10&&(r=13),32<=r||r===13?r:0}function Po(){return!0}function Bf(){return!1}function _t(r){function e(t,i,n,s,o){this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in r)r.hasOwnProperty(a)&&(t=r[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Po:Bf,this.isPropagationStopped=Bf,this}return Te(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Po)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Po)},persist:function(){},isPersistent:Po}),e}var Kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sd=_t(Kn),fo=Te({},Kn,{view:0,detail:0}),P_=_t(fo),sh,oh,ss,bl=Te({},fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bd,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ss&&(ss&&r.type==="mousemove"?(sh=r.screenX-ss.screenX,oh=r.screenY-ss.screenY):oh=sh=0,ss=r),sh)},movementY:function(r){return"movementY"in r?r.movementY:oh}}),Of=_t(bl),M_=Te({},bl,{dataTransfer:0}),k_=_t(M_),D_=Te({},fo,{relatedTarget:0}),ah=_t(D_),B_=Te({},Kn,{animationName:0,elapsedTime:0,pseudoElement:0}),O_=_t(B_),F_=Te({},Kn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),N_=_t(F_),L_=Te({},Kn,{data:0}),Ff=_t(L_),U_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},G_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j_(r){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(r):(r=z_[r])?!!e[r]:!1}function bd(){return j_}var H_=Te({},fo,{key:function(r){if(r.key){var e=U_[r.key]||r.key;if(e!=="Unidentified")return e}return r.type==="keypress"?(r=ma(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?G_[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bd,charCode:function(r){return r.type==="keypress"?ma(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ma(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),$_=_t(H_),V_=Te({},bl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nf=_t(V_),W_=Te({},fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bd}),X_=_t(W_),Y_=Te({},Kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),K_=_t(Y_),q_=Te({},bl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Z_=_t(q_),Q_=[9,13,27,32],Ad=Ir&&"CompositionEvent"in window,Is=null;Ir&&"documentMode"in document&&(Is=document.documentMode);var J_=Ir&&"TextEvent"in window&&!Is,d0=Ir&&(!Ad||Is&&8<Is&&11>=Is),Lf=String.fromCharCode(32),Uf=!1;function f0(r,e){switch(r){case"keyup":return Q_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p0(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var cn=!1;function e1(r,e){switch(r){case"compositionend":return p0(e);case"keypress":return e.which!==32?null:(Uf=!0,Lf);case"textInput":return r=e.data,r===Lf&&Uf?null:r;default:return null}}function t1(r,e){if(cn)return r==="compositionend"||!Ad&&f0(r,e)?(r=c0(),pa=Td=Vr=null,cn=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return d0&&e.locale!=="ko"?null:e.data;default:return null}}var r1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gf(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e==="input"?!!r1[r.type]:e==="textarea"}function m0(r,e,t,i){Wg(i),e=za(e,"onChange"),0<e.length&&(t=new Sd("onChange","change",null,t,i),r.push({event:t,listeners:e}))}var Rs=null,Ws=null;function i1(r){A0(r,0)}function Al(r){var e=pn(r);if(Ug(e))return r}function n1(r,e){if(r==="change")return e}var g0=!1;if(Ir){var lh;if(Ir){var hh="oninput"in document;if(!hh){var zf=document.createElement("div");zf.setAttribute("oninput","return;"),hh=typeof zf.oninput=="function"}lh=hh}else lh=!1;g0=lh&&(!document.documentMode||9<document.documentMode)}function jf(){Rs&&(Rs.detachEvent("onpropertychange",y0),Ws=Rs=null)}function y0(r){if(r.propertyName==="value"&&Al(Ws)){var e=[];m0(e,Ws,r,vd(r)),qg(i1,e)}}function s1(r,e,t){r==="focusin"?(jf(),Rs=e,Ws=t,Rs.attachEvent("onpropertychange",y0)):r==="focusout"&&jf()}function o1(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Al(Ws)}function a1(r,e){if(r==="click")return Al(e)}function l1(r,e){if(r==="input"||r==="change")return Al(e)}function h1(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var $t=typeof Object.is=="function"?Object.is:h1;function Xs(r,e){if($t(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;var t=Object.keys(r),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var n=t[i];if(!xu.call(e,n)||!$t(r[n],e[n]))return!1}return!0}function Hf(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function $f(r,e){var t=Hf(r);r=0;for(var i;t;){if(t.nodeType===3){if(i=r+t.textContent.length,r<=e&&i>=e)return{node:t,offset:e-r};r=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Hf(t)}}function v0(r,e){return r&&e?r===e?!0:r&&r.nodeType===3?!1:e&&e.nodeType===3?v0(r,e.parentNode):"contains"in r?r.contains(e):r.compareDocumentPosition?!!(r.compareDocumentPosition(e)&16):!1:!1}function x0(){for(var r=window,e=Ba();e instanceof r.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)r=e.contentWindow;else break;e=Ba(r.document)}return e}function Cd(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e&&(e==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||e==="textarea"||r.contentEditable==="true")}function u1(r){var e=x0(),t=r.focusedElem,i=r.selectionRange;if(e!==t&&t&&t.ownerDocument&&v0(t.ownerDocument.documentElement,t)){if(i!==null&&Cd(t)){if(e=i.start,r=i.end,r===void 0&&(r=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(r,t.value.length);else if(r=(e=t.ownerDocument||document)&&e.defaultView||window,r.getSelection){r=r.getSelection();var n=t.textContent.length,s=Math.min(i.start,n);i=i.end===void 0?s:Math.min(i.end,n),!r.extend&&s>i&&(n=i,i=s,s=n),n=$f(t,s);var o=$f(t,i);n&&o&&(r.rangeCount!==1||r.anchorNode!==n.node||r.anchorOffset!==n.offset||r.focusNode!==o.node||r.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),r.removeAllRanges(),s>i?(r.addRange(e),r.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),r.addRange(e)))}}for(e=[],r=t;r=r.parentNode;)r.nodeType===1&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)r=e[t],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var c1=Ir&&"documentMode"in document&&11>=document.documentMode,dn=null,Lu=null,Ps=null,Uu=!1;function Vf(r,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Uu||dn==null||dn!==Ba(i)||(i=dn,"selectionStart"in i&&Cd(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ps&&Xs(Ps,i)||(Ps=i,i=za(Lu,"onSelect"),0<i.length&&(e=new Sd("onSelect","select",null,e,t),r.push({event:e,listeners:i}),e.target=dn)))}function Mo(r,e){var t={};return t[r.toLowerCase()]=e.toLowerCase(),t["Webkit"+r]="webkit"+e,t["Moz"+r]="moz"+e,t}var fn={animationend:Mo("Animation","AnimationEnd"),animationiteration:Mo("Animation","AnimationIteration"),animationstart:Mo("Animation","AnimationStart"),transitionend:Mo("Transition","TransitionEnd")},uh={},_0={};Ir&&(_0=document.createElement("div").style,"AnimationEvent"in window||(delete fn.animationend.animation,delete fn.animationiteration.animation,delete fn.animationstart.animation),"TransitionEvent"in window||delete fn.transitionend.transition);function Cl(r){if(uh[r])return uh[r];if(!fn[r])return r;var e=fn[r],t;for(t in e)if(e.hasOwnProperty(t)&&t in _0)return uh[r]=e[t];return r}var w0=Cl("animationend"),E0=Cl("animationiteration"),T0=Cl("animationstart"),S0=Cl("transitionend"),b0=new Map,Wf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function li(r,e){b0.set(r,e),$i(e,[r])}for(var ch=0;ch<Wf.length;ch++){var dh=Wf[ch],d1=dh.toLowerCase(),f1=dh[0].toUpperCase()+dh.slice(1);li(d1,"on"+f1)}li(w0,"onAnimationEnd");li(E0,"onAnimationIteration");li(T0,"onAnimationStart");li("dblclick","onDoubleClick");li("focusin","onFocus");li("focusout","onBlur");li(S0,"onTransitionEnd");Ln("onMouseEnter",["mouseout","mouseover"]);Ln("onMouseLeave",["mouseout","mouseover"]);Ln("onPointerEnter",["pointerout","pointerover"]);Ln("onPointerLeave",["pointerout","pointerover"]);$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$i("onBeforeInput",["compositionend","keypress","textInput","paste"]);$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ys="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p1=new Set("cancel close invalid load scroll toggle".split(" ").concat(ys));function Xf(r,e,t){var i=r.type||"unknown-event";r.currentTarget=t,d_(i,e,void 0,r),r.currentTarget=null}function A0(r,e){e=(e&4)!==0;for(var t=0;t<r.length;t++){var i=r[t],n=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==s&&n.isPropagationStopped())break e;Xf(n,a,h),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,h=a.currentTarget,a=a.listener,l!==s&&n.isPropagationStopped())break e;Xf(n,a,h),s=l}}}if(Fa)throw r=Bu,Fa=!1,Bu=null,r}function ce(r,e){var t=e[$u];t===void 0&&(t=e[$u]=new Set);var i=r+"__bubble";t.has(i)||(C0(e,r,2,!1),t.add(i))}function fh(r,e,t){var i=0;e&&(i|=4),C0(t,r,i,e)}var ko="_reactListening"+Math.random().toString(36).slice(2);function Ys(r){if(!r[ko]){r[ko]=!0,Bg.forEach(function(t){t!=="selectionchange"&&(p1.has(t)||fh(t,!1,r),fh(t,!0,r))});var e=r.nodeType===9?r:r.ownerDocument;e===null||e[ko]||(e[ko]=!0,fh("selectionchange",!1,e))}}function C0(r,e,t,i){switch(u0(e)){case 1:var n=I_;break;case 4:n=R_;break;default:n=Ed}t=n.bind(null,e,t,r),n=void 0,!Du||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),i?n!==void 0?r.addEventListener(e,t,{capture:!0,passive:n}):r.addEventListener(e,t,!0):n!==void 0?r.addEventListener(e,t,{passive:n}):r.addEventListener(e,t,!1)}function ph(r,e,t,i,n){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===n||a.nodeType===8&&a.parentNode===n)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;o=o.return}for(;a!==null;){if(o=Ai(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}qg(function(){var h=s,u=vd(t),c=[];e:{var d=b0.get(r);if(d!==void 0){var f=Sd,p=r;switch(r){case"keypress":if(ma(t)===0)break e;case"keydown":case"keyup":f=$_;break;case"focusin":p="focus",f=ah;break;case"focusout":p="blur",f=ah;break;case"beforeblur":case"afterblur":f=ah;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Of;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=k_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=X_;break;case w0:case E0:case T0:f=O_;break;case S0:f=K_;break;case"scroll":f=P_;break;case"wheel":f=Z_;break;case"copy":case"cut":case"paste":f=N_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Nf}var v=(e&4)!==0,x=!v&&r==="scroll",g=v?d!==null?d+"Capture":null:d;v=[];for(var y=h,m;y!==null;){m=y;var _=m.stateNode;if(m.tag===5&&_!==null&&(m=_,g!==null&&(_=js(y,g),_!=null&&v.push(Ks(y,_,m)))),x)break;y=y.return}0<v.length&&(d=new f(d,p,null,t,u),c.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=r==="mouseover"||r==="pointerover",f=r==="mouseout"||r==="pointerout",d&&t!==Mu&&(p=t.relatedTarget||t.fromElement)&&(Ai(p)||p[Rr]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=h,p=p?Ai(p):null,p!==null&&(x=Vi(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=h),f!==p)){if(v=Of,_="onMouseLeave",g="onMouseEnter",y="mouse",(r==="pointerout"||r==="pointerover")&&(v=Nf,_="onPointerLeave",g="onPointerEnter",y="pointer"),x=f==null?d:pn(f),m=p==null?d:pn(p),d=new v(_,y+"leave",f,t,u),d.target=x,d.relatedTarget=m,_=null,Ai(u)===h&&(v=new v(g,y+"enter",p,t,u),v.target=m,v.relatedTarget=x,_=v),x=_,f&&p)t:{for(v=f,g=p,y=0,m=v;m;m=Ki(m))y++;for(m=0,_=g;_;_=Ki(_))m++;for(;0<y-m;)v=Ki(v),y--;for(;0<m-y;)g=Ki(g),m--;for(;y--;){if(v===g||g!==null&&v===g.alternate)break t;v=Ki(v),g=Ki(g)}v=null}else v=null;f!==null&&Yf(c,d,f,v,!1),p!==null&&x!==null&&Yf(c,x,p,v,!0)}}e:{if(d=h?pn(h):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var E=n1;else if(Gf(d))if(g0)E=l1;else{E=o1;var b=s1}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=a1);if(E&&(E=E(r,h))){m0(c,E,t,u);break e}b&&b(r,d,h),r==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&Au(d,"number",d.value)}switch(b=h?pn(h):window,r){case"focusin":(Gf(b)||b.contentEditable==="true")&&(dn=b,Lu=h,Ps=null);break;case"focusout":Ps=Lu=dn=null;break;case"mousedown":Uu=!0;break;case"contextmenu":case"mouseup":case"dragend":Uu=!1,Vf(c,t,u);break;case"selectionchange":if(c1)break;case"keydown":case"keyup":Vf(c,t,u)}var T;if(Ad)e:{switch(r){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else cn?f0(r,t)&&(S="onCompositionEnd"):r==="keydown"&&t.keyCode===229&&(S="onCompositionStart");S&&(d0&&t.locale!=="ko"&&(cn||S!=="onCompositionStart"?S==="onCompositionEnd"&&cn&&(T=c0()):(Vr=u,Td="value"in Vr?Vr.value:Vr.textContent,cn=!0)),b=za(h,S),0<b.length&&(S=new Ff(S,r,null,t,u),c.push({event:S,listeners:b}),T?S.data=T:(T=p0(t),T!==null&&(S.data=T)))),(T=J_?e1(r,t):t1(r,t))&&(h=za(h,"onBeforeInput"),0<h.length&&(u=new Ff("onBeforeInput","beforeinput",null,t,u),c.push({event:u,listeners:h}),u.data=T))}A0(c,e)})}function Ks(r,e,t){return{instance:r,listener:e,currentTarget:t}}function za(r,e){for(var t=e+"Capture",i=[];r!==null;){var n=r,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=js(r,t),s!=null&&i.unshift(Ks(r,s,n)),s=js(r,e),s!=null&&i.push(Ks(r,s,n))),r=r.return}return i}function Ki(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Yf(r,e,t,i,n){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,h=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&h!==null&&(a=h,n?(l=js(t,s),l!=null&&o.unshift(Ks(t,l,a))):n||(l=js(t,s),l!=null&&o.push(Ks(t,l,a)))),t=t.return}o.length!==0&&r.push({event:e,listeners:o})}var m1=/\r\n?/g,g1=/\u0000|\uFFFD/g;function Kf(r){return(typeof r=="string"?r:""+r).replace(m1,`
`).replace(g1,"")}function Do(r,e,t){if(e=Kf(e),Kf(r)!==e&&t)throw Error(B(425))}function ja(){}var Gu=null,zu=null;function ju(r,e){return r==="textarea"||r==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hu=typeof setTimeout=="function"?setTimeout:void 0,y1=typeof clearTimeout=="function"?clearTimeout:void 0,qf=typeof Promise=="function"?Promise:void 0,v1=typeof queueMicrotask=="function"?queueMicrotask:typeof qf<"u"?function(r){return qf.resolve(null).then(r).catch(x1)}:Hu;function x1(r){setTimeout(function(){throw r})}function mh(r,e){var t=e,i=0;do{var n=t.nextSibling;if(r.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(i===0){r.removeChild(n),Vs(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=n}while(t);Vs(e)}function Jr(r){for(;r!=null;r=r.nextSibling){var e=r.nodeType;if(e===1||e===3)break;if(e===8){if(e=r.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return r}function Zf(r){r=r.previousSibling;for(var e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return r;e--}else t==="/$"&&e++}r=r.previousSibling}return null}var qn=Math.random().toString(36).slice(2),sr="__reactFiber$"+qn,qs="__reactProps$"+qn,Rr="__reactContainer$"+qn,$u="__reactEvents$"+qn,_1="__reactListeners$"+qn,w1="__reactHandles$"+qn;function Ai(r){var e=r[sr];if(e)return e;for(var t=r.parentNode;t;){if(e=t[Rr]||t[sr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(r=Zf(r);r!==null;){if(t=r[sr])return t;r=Zf(r)}return e}r=t,t=r.parentNode}return null}function po(r){return r=r[sr]||r[Rr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function pn(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(B(33))}function Il(r){return r[qs]||null}var Vu=[],mn=-1;function hi(r){return{current:r}}function fe(r){0>mn||(r.current=Vu[mn],Vu[mn]=null,mn--)}function ue(r,e){mn++,Vu[mn]=r.current,r.current=e}var oi={},et=hi(oi),ht=hi(!1),Oi=oi;function Un(r,e){var t=r.type.contextTypes;if(!t)return oi;var i=r.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in t)n[s]=e[s];return i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=e,r.__reactInternalMemoizedMaskedChildContext=n),n}function ut(r){return r=r.childContextTypes,r!=null}function Ha(){fe(ht),fe(et)}function Qf(r,e,t){if(et.current!==oi)throw Error(B(168));ue(et,e),ue(ht,t)}function I0(r,e,t){var i=r.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var n in i)if(!(n in e))throw Error(B(108,s_(r)||"Unknown",n));return Te({},t,i)}function $a(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||oi,Oi=et.current,ue(et,r),ue(ht,ht.current),!0}function Jf(r,e,t){var i=r.stateNode;if(!i)throw Error(B(169));t?(r=I0(r,e,Oi),i.__reactInternalMemoizedMergedChildContext=r,fe(ht),fe(et),ue(et,r)):fe(ht),ue(ht,t)}var xr=null,Rl=!1,gh=!1;function R0(r){xr===null?xr=[r]:xr.push(r)}function E1(r){Rl=!0,R0(r)}function ui(){if(!gh&&xr!==null){gh=!0;var r=0,e=ae;try{var t=xr;for(ae=1;r<t.length;r++){var i=t[r];do i=i(!0);while(i!==null)}xr=null,Rl=!1}catch(n){throw xr!==null&&(xr=xr.slice(r+1)),e0(xd,ui),n}finally{ae=e,gh=!1}}return null}var gn=[],yn=0,Va=null,Wa=0,Et=[],Tt=0,Fi=null,_r=1,wr="";function mi(r,e){gn[yn++]=Wa,gn[yn++]=Va,Va=r,Wa=e}function P0(r,e,t){Et[Tt++]=_r,Et[Tt++]=wr,Et[Tt++]=Fi,Fi=r;var i=_r;r=wr;var n=32-Gt(i)-1;i&=~(1<<n),t+=1;var s=32-Gt(e)+n;if(30<s){var o=n-n%5;s=(i&(1<<o)-1).toString(32),i>>=o,n-=o,_r=1<<32-Gt(e)+n|t<<n|i,wr=s+r}else _r=1<<s|t<<n|i,wr=r}function Id(r){r.return!==null&&(mi(r,1),P0(r,1,0))}function Rd(r){for(;r===Va;)Va=gn[--yn],gn[yn]=null,Wa=gn[--yn],gn[yn]=null;for(;r===Fi;)Fi=Et[--Tt],Et[Tt]=null,wr=Et[--Tt],Et[Tt]=null,_r=Et[--Tt],Et[Tt]=null}var yt=null,mt=null,ye=!1,Lt=null;function M0(r,e){var t=St(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=r,e=r.deletions,e===null?(r.deletions=[t],r.flags|=16):e.push(t)}function ep(r,e){switch(r.tag){case 5:var t=r.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(r.stateNode=e,yt=r,mt=Jr(e.firstChild),!0):!1;case 6:return e=r.pendingProps===""||e.nodeType!==3?null:e,e!==null?(r.stateNode=e,yt=r,mt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Fi!==null?{id:_r,overflow:wr}:null,r.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=St(18,null,null,0),t.stateNode=e,t.return=r,r.child=t,yt=r,mt=null,!0):!1;default:return!1}}function Wu(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Xu(r){if(ye){var e=mt;if(e){var t=e;if(!ep(r,e)){if(Wu(r))throw Error(B(418));e=Jr(t.nextSibling);var i=yt;e&&ep(r,e)?M0(i,t):(r.flags=r.flags&-4097|2,ye=!1,yt=r)}}else{if(Wu(r))throw Error(B(418));r.flags=r.flags&-4097|2,ye=!1,yt=r}}}function tp(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;yt=r}function Bo(r){if(r!==yt)return!1;if(!ye)return tp(r),ye=!0,!1;var e;if((e=r.tag!==3)&&!(e=r.tag!==5)&&(e=r.type,e=e!=="head"&&e!=="body"&&!ju(r.type,r.memoizedProps)),e&&(e=mt)){if(Wu(r))throw k0(),Error(B(418));for(;e;)M0(r,e),e=Jr(e.nextSibling)}if(tp(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(B(317));e:{for(r=r.nextSibling,e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="/$"){if(e===0){mt=Jr(r.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}r=r.nextSibling}mt=null}}else mt=yt?Jr(r.stateNode.nextSibling):null;return!0}function k0(){for(var r=mt;r;)r=Jr(r.nextSibling)}function Gn(){mt=yt=null,ye=!1}function Pd(r){Lt===null?Lt=[r]:Lt.push(r)}var T1=Br.ReactCurrentBatchConfig;function os(r,e,t){if(r=t.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(B(309));var i=t.stateNode}if(!i)throw Error(B(147,r));var n=i,s=""+r;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=n.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof r!="string")throw Error(B(284));if(!t._owner)throw Error(B(290,r))}return r}function Oo(r,e){throw r=Object.prototype.toString.call(e),Error(B(31,r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r))}function rp(r){var e=r._init;return e(r._payload)}function D0(r){function e(g,y){if(r){var m=g.deletions;m===null?(g.deletions=[y],g.flags|=16):m.push(y)}}function t(g,y){if(!r)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function i(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function n(g,y){return g=ii(g,y),g.index=0,g.sibling=null,g}function s(g,y,m){return g.index=m,r?(m=g.alternate,m!==null?(m=m.index,m<y?(g.flags|=2,y):m):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return r&&g.alternate===null&&(g.flags|=2),g}function a(g,y,m,_){return y===null||y.tag!==6?(y=Th(m,g.mode,_),y.return=g,y):(y=n(y,m),y.return=g,y)}function l(g,y,m,_){var E=m.type;return E===un?u(g,y,m.props.children,_,m.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ur&&rp(E)===y.type)?(_=n(y,m.props),_.ref=os(g,y,m),_.return=g,_):(_=Ea(m.type,m.key,m.props,null,g.mode,_),_.ref=os(g,y,m),_.return=g,_)}function h(g,y,m,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==m.containerInfo||y.stateNode.implementation!==m.implementation?(y=Sh(m,g.mode,_),y.return=g,y):(y=n(y,m.children||[]),y.return=g,y)}function u(g,y,m,_,E){return y===null||y.tag!==7?(y=Pi(m,g.mode,_,E),y.return=g,y):(y=n(y,m),y.return=g,y)}function c(g,y,m){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Th(""+y,g.mode,m),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case So:return m=Ea(y.type,y.key,y.props,null,g.mode,m),m.ref=os(g,null,y),m.return=g,m;case hn:return y=Sh(y,g.mode,m),y.return=g,y;case Ur:var _=y._init;return c(g,_(y._payload),m)}if(ms(y)||ts(y))return y=Pi(y,g.mode,m,null),y.return=g,y;Oo(g,y)}return null}function d(g,y,m,_){var E=y!==null?y.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return E!==null?null:a(g,y,""+m,_);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case So:return m.key===E?l(g,y,m,_):null;case hn:return m.key===E?h(g,y,m,_):null;case Ur:return E=m._init,d(g,y,E(m._payload),_)}if(ms(m)||ts(m))return E!==null?null:u(g,y,m,_,null);Oo(g,m)}return null}function f(g,y,m,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(m)||null,a(y,g,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case So:return g=g.get(_.key===null?m:_.key)||null,l(y,g,_,E);case hn:return g=g.get(_.key===null?m:_.key)||null,h(y,g,_,E);case Ur:var b=_._init;return f(g,y,m,b(_._payload),E)}if(ms(_)||ts(_))return g=g.get(m)||null,u(y,g,_,E,null);Oo(y,_)}return null}function p(g,y,m,_){for(var E=null,b=null,T=y,S=y=0,P=null;T!==null&&S<m.length;S++){T.index>S?(P=T,T=null):P=T.sibling;var R=d(g,T,m[S],_);if(R===null){T===null&&(T=P);break}r&&T&&R.alternate===null&&e(g,T),y=s(R,y,S),b===null?E=R:b.sibling=R,b=R,T=P}if(S===m.length)return t(g,T),ye&&mi(g,S),E;if(T===null){for(;S<m.length;S++)T=c(g,m[S],_),T!==null&&(y=s(T,y,S),b===null?E=T:b.sibling=T,b=T);return ye&&mi(g,S),E}for(T=i(g,T);S<m.length;S++)P=f(T,g,S,m[S],_),P!==null&&(r&&P.alternate!==null&&T.delete(P.key===null?S:P.key),y=s(P,y,S),b===null?E=P:b.sibling=P,b=P);return r&&T.forEach(function(K){return e(g,K)}),ye&&mi(g,S),E}function v(g,y,m,_){var E=ts(m);if(typeof E!="function")throw Error(B(150));if(m=E.call(m),m==null)throw Error(B(151));for(var b=E=null,T=y,S=y=0,P=null,R=m.next();T!==null&&!R.done;S++,R=m.next()){T.index>S?(P=T,T=null):P=T.sibling;var K=d(g,T,R.value,_);if(K===null){T===null&&(T=P);break}r&&T&&K.alternate===null&&e(g,T),y=s(K,y,S),b===null?E=K:b.sibling=K,b=K,T=P}if(R.done)return t(g,T),ye&&mi(g,S),E;if(T===null){for(;!R.done;S++,R=m.next())R=c(g,R.value,_),R!==null&&(y=s(R,y,S),b===null?E=R:b.sibling=R,b=R);return ye&&mi(g,S),E}for(T=i(g,T);!R.done;S++,R=m.next())R=f(T,g,S,R.value,_),R!==null&&(r&&R.alternate!==null&&T.delete(R.key===null?S:R.key),y=s(R,y,S),b===null?E=R:b.sibling=R,b=R);return r&&T.forEach(function(F){return e(g,F)}),ye&&mi(g,S),E}function x(g,y,m,_){if(typeof m=="object"&&m!==null&&m.type===un&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case So:e:{for(var E=m.key,b=y;b!==null;){if(b.key===E){if(E=m.type,E===un){if(b.tag===7){t(g,b.sibling),y=n(b,m.props.children),y.return=g,g=y;break e}}else if(b.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ur&&rp(E)===b.type){t(g,b.sibling),y=n(b,m.props),y.ref=os(g,b,m),y.return=g,g=y;break e}t(g,b);break}else e(g,b);b=b.sibling}m.type===un?(y=Pi(m.props.children,g.mode,_,m.key),y.return=g,g=y):(_=Ea(m.type,m.key,m.props,null,g.mode,_),_.ref=os(g,y,m),_.return=g,g=_)}return o(g);case hn:e:{for(b=m.key;y!==null;){if(y.key===b)if(y.tag===4&&y.stateNode.containerInfo===m.containerInfo&&y.stateNode.implementation===m.implementation){t(g,y.sibling),y=n(y,m.children||[]),y.return=g,g=y;break e}else{t(g,y);break}else e(g,y);y=y.sibling}y=Sh(m,g.mode,_),y.return=g,g=y}return o(g);case Ur:return b=m._init,x(g,y,b(m._payload),_)}if(ms(m))return p(g,y,m,_);if(ts(m))return v(g,y,m,_);Oo(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,y!==null&&y.tag===6?(t(g,y.sibling),y=n(y,m),y.return=g,g=y):(t(g,y),y=Th(m,g.mode,_),y.return=g,g=y),o(g)):t(g,y)}return x}var zn=D0(!0),B0=D0(!1),Xa=hi(null),Ya=null,vn=null,Md=null;function kd(){Md=vn=Ya=null}function Dd(r){var e=Xa.current;fe(Xa),r._currentValue=e}function Yu(r,e,t){for(;r!==null;){var i=r.alternate;if((r.childLanes&e)!==e?(r.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),r===t)break;r=r.return}}function In(r,e){Ya=r,Md=vn=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&e&&(at=!0),r.firstContext=null)}function It(r){var e=r._currentValue;if(Md!==r)if(r={context:r,memoizedValue:e,next:null},vn===null){if(Ya===null)throw Error(B(308));vn=r,Ya.dependencies={lanes:0,firstContext:r}}else vn=vn.next=r;return e}var Ci=null;function Bd(r){Ci===null?Ci=[r]:Ci.push(r)}function O0(r,e,t,i){var n=e.interleaved;return n===null?(t.next=t,Bd(e)):(t.next=n.next,n.next=t),e.interleaved=t,Pr(r,i)}function Pr(r,e){r.lanes|=e;var t=r.alternate;for(t!==null&&(t.lanes|=e),t=r,r=r.return;r!==null;)r.childLanes|=e,t=r.alternate,t!==null&&(t.childLanes|=e),t=r,r=r.return;return t.tag===3?t.stateNode:null}var Gr=!1;function Od(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function F0(r,e){r=r.updateQueue,e.updateQueue===r&&(e.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Ar(r,e){return{eventTime:r,lane:e,tag:0,payload:null,callback:null,next:null}}function ei(r,e,t){var i=r.updateQueue;if(i===null)return null;if(i=i.shared,oe&2){var n=i.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),i.pending=e,Pr(r,t)}return n=i.interleaved,n===null?(e.next=e,Bd(i)):(e.next=n.next,n.next=e),i.interleaved=e,Pr(r,t)}function ga(r,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=r.pendingLanes,t|=i,e.lanes=t,_d(r,t)}}function ip(r,e){var t=r.updateQueue,i=r.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var n=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?n=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?n=s=e:s=s.next=e}else n=s=e;t={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:i.shared,effects:i.effects},r.updateQueue=t;return}r=t.lastBaseUpdate,r===null?t.firstBaseUpdate=e:r.next=e,t.lastBaseUpdate=e}function Ka(r,e,t,i){var n=r.updateQueue;Gr=!1;var s=n.firstBaseUpdate,o=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var l=a,h=l.next;l.next=null,o===null?s=h:o.next=h,o=l;var u=r.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=h:a.next=h,u.lastBaseUpdate=l))}if(s!==null){var c=n.baseState;o=0,u=h=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((i&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=r,v=a;switch(d=e,f=t,v.tag){case 1:if(p=v.payload,typeof p=="function"){c=p.call(f,c,d);break e}c=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,d=typeof p=="function"?p.call(f,c,d):p,d==null)break e;c=Te({},c,d);break e;case 2:Gr=!0}}a.callback!==null&&a.lane!==0&&(r.flags|=64,d=n.effects,d===null?n.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(h=u=f,l=c):u=u.next=f,o|=d;if(a=a.next,a===null){if(a=n.shared.pending,a===null)break;d=a,a=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(1);if(u===null&&(l=c),n.baseState=l,n.firstBaseUpdate=h,n.lastBaseUpdate=u,e=n.shared.interleaved,e!==null){n=e;do o|=n.lane,n=n.next;while(n!==e)}else s===null&&(n.shared.lanes=0);Li|=o,r.lanes=o,r.memoizedState=c}}function np(r,e,t){if(r=e.effects,e.effects=null,r!==null)for(e=0;e<r.length;e++){var i=r[e],n=i.callback;if(n!==null){if(i.callback=null,i=t,typeof n!="function")throw Error(B(191,n));n.call(i)}}}var mo={},lr=hi(mo),Zs=hi(mo),Qs=hi(mo);function Ii(r){if(r===mo)throw Error(B(174));return r}function Fd(r,e){switch(ue(Qs,e),ue(Zs,r),ue(lr,mo),r=e.nodeType,r){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Iu(null,"");break;default:r=r===8?e.parentNode:e,e=r.namespaceURI||null,r=r.tagName,e=Iu(e,r)}fe(lr),ue(lr,e)}function jn(){fe(lr),fe(Zs),fe(Qs)}function N0(r){Ii(Qs.current);var e=Ii(lr.current),t=Iu(e,r.type);e!==t&&(ue(Zs,r),ue(lr,t))}function Nd(r){Zs.current===r&&(fe(lr),fe(Zs))}var _e=hi(0);function qa(r){for(var e=r;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yh=[];function Ld(){for(var r=0;r<yh.length;r++)yh[r]._workInProgressVersionPrimary=null;yh.length=0}var ya=Br.ReactCurrentDispatcher,vh=Br.ReactCurrentBatchConfig,Ni=0,Ee=null,Ne=null,Ge=null,Za=!1,Ms=!1,Js=0,S1=0;function Ze(){throw Error(B(321))}function Ud(r,e){if(e===null)return!1;for(var t=0;t<e.length&&t<r.length;t++)if(!$t(r[t],e[t]))return!1;return!0}function Gd(r,e,t,i,n,s){if(Ni=s,Ee=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ya.current=r===null||r.memoizedState===null?I1:R1,r=t(i,n),Ms){s=0;do{if(Ms=!1,Js=0,25<=s)throw Error(B(301));s+=1,Ge=Ne=null,e.updateQueue=null,ya.current=P1,r=t(i,n)}while(Ms)}if(ya.current=Qa,e=Ne!==null&&Ne.next!==null,Ni=0,Ge=Ne=Ee=null,Za=!1,e)throw Error(B(300));return r}function zd(){var r=Js!==0;return Js=0,r}function tr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ge===null?Ee.memoizedState=Ge=r:Ge=Ge.next=r,Ge}function Rt(){if(Ne===null){var r=Ee.alternate;r=r!==null?r.memoizedState:null}else r=Ne.next;var e=Ge===null?Ee.memoizedState:Ge.next;if(e!==null)Ge=e,Ne=r;else{if(r===null)throw Error(B(310));Ne=r,r={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},Ge===null?Ee.memoizedState=Ge=r:Ge=Ge.next=r}return Ge}function eo(r,e){return typeof e=="function"?e(r):e}function xh(r){var e=Rt(),t=e.queue;if(t===null)throw Error(B(311));t.lastRenderedReducer=r;var i=Ne,n=i.baseQueue,s=t.pending;if(s!==null){if(n!==null){var o=n.next;n.next=s.next,s.next=o}i.baseQueue=n=s,t.pending=null}if(n!==null){s=n.next,i=i.baseState;var a=o=null,l=null,h=s;do{var u=h.lane;if((Ni&u)===u)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:r(i,h.action);else{var c={lane:u,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(a=l=c,o=i):l=l.next=c,Ee.lanes|=u,Li|=u}h=h.next}while(h!==null&&h!==s);l===null?o=i:l.next=a,$t(i,e.memoizedState)||(at=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(r=t.interleaved,r!==null){n=r;do s=n.lane,Ee.lanes|=s,Li|=s,n=n.next;while(n!==r)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function _h(r){var e=Rt(),t=e.queue;if(t===null)throw Error(B(311));t.lastRenderedReducer=r;var i=t.dispatch,n=t.pending,s=e.memoizedState;if(n!==null){t.pending=null;var o=n=n.next;do s=r(s,o.action),o=o.next;while(o!==n);$t(s,e.memoizedState)||(at=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function L0(){}function U0(r,e){var t=Ee,i=Rt(),n=e(),s=!$t(i.memoizedState,n);if(s&&(i.memoizedState=n,at=!0),i=i.queue,jd(j0.bind(null,t,i,r),[r]),i.getSnapshot!==e||s||Ge!==null&&Ge.memoizedState.tag&1){if(t.flags|=2048,to(9,z0.bind(null,t,i,n,e),void 0,null),je===null)throw Error(B(349));Ni&30||G0(t,e,n)}return n}function G0(r,e,t){r.flags|=16384,r={getSnapshot:e,value:t},e=Ee.updateQueue,e===null?(e={lastEffect:null,stores:null},Ee.updateQueue=e,e.stores=[r]):(t=e.stores,t===null?e.stores=[r]:t.push(r))}function z0(r,e,t,i){e.value=t,e.getSnapshot=i,H0(e)&&$0(r)}function j0(r,e,t){return t(function(){H0(e)&&$0(r)})}function H0(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!$t(r,t)}catch{return!0}}function $0(r){var e=Pr(r,1);e!==null&&zt(e,r,1,-1)}function sp(r){var e=tr();return typeof r=="function"&&(r=r()),e.memoizedState=e.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:r},e.queue=r,r=r.dispatch=C1.bind(null,Ee,r),[e.memoizedState,r]}function to(r,e,t,i){return r={tag:r,create:e,destroy:t,deps:i,next:null},e=Ee.updateQueue,e===null?(e={lastEffect:null,stores:null},Ee.updateQueue=e,e.lastEffect=r.next=r):(t=e.lastEffect,t===null?e.lastEffect=r.next=r:(i=t.next,t.next=r,r.next=i,e.lastEffect=r)),r}function V0(){return Rt().memoizedState}function va(r,e,t,i){var n=tr();Ee.flags|=r,n.memoizedState=to(1|e,t,void 0,i===void 0?null:i)}function Pl(r,e,t,i){var n=Rt();i=i===void 0?null:i;var s=void 0;if(Ne!==null){var o=Ne.memoizedState;if(s=o.destroy,i!==null&&Ud(i,o.deps)){n.memoizedState=to(e,t,s,i);return}}Ee.flags|=r,n.memoizedState=to(1|e,t,s,i)}function op(r,e){return va(8390656,8,r,e)}function jd(r,e){return Pl(2048,8,r,e)}function W0(r,e){return Pl(4,2,r,e)}function X0(r,e){return Pl(4,4,r,e)}function Y0(r,e){if(typeof e=="function")return r=r(),e(r),function(){e(null)};if(e!=null)return r=r(),e.current=r,function(){e.current=null}}function K0(r,e,t){return t=t!=null?t.concat([r]):null,Pl(4,4,Y0.bind(null,e,r),t)}function Hd(){}function q0(r,e){var t=Rt();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Ud(e,i[1])?i[0]:(t.memoizedState=[r,e],r)}function Z0(r,e){var t=Rt();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Ud(e,i[1])?i[0]:(r=r(),t.memoizedState=[r,e],r)}function Q0(r,e,t){return Ni&21?($t(t,e)||(t=i0(),Ee.lanes|=t,Li|=t,r.baseState=!0),e):(r.baseState&&(r.baseState=!1,at=!0),r.memoizedState=t)}function b1(r,e){var t=ae;ae=t!==0&&4>t?t:4,r(!0);var i=vh.transition;vh.transition={};try{r(!1),e()}finally{ae=t,vh.transition=i}}function J0(){return Rt().memoizedState}function A1(r,e,t){var i=ri(r);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},ey(r))ty(e,t);else if(t=O0(r,e,t,i),t!==null){var n=it();zt(t,r,i,n),ry(t,e,i)}}function C1(r,e,t){var i=ri(r),n={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(ey(r))ty(e,n);else{var s=r.alternate;if(r.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(n.hasEagerState=!0,n.eagerState=a,$t(a,o)){var l=e.interleaved;l===null?(n.next=n,Bd(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}t=O0(r,e,n,i),t!==null&&(n=it(),zt(t,r,i,n),ry(t,e,i))}}function ey(r){var e=r.alternate;return r===Ee||e!==null&&e===Ee}function ty(r,e){Ms=Za=!0;var t=r.pending;t===null?e.next=e:(e.next=t.next,t.next=e),r.pending=e}function ry(r,e,t){if(t&4194240){var i=e.lanes;i&=r.pendingLanes,t|=i,e.lanes=t,_d(r,t)}}var Qa={readContext:It,useCallback:Ze,useContext:Ze,useEffect:Ze,useImperativeHandle:Ze,useInsertionEffect:Ze,useLayoutEffect:Ze,useMemo:Ze,useReducer:Ze,useRef:Ze,useState:Ze,useDebugValue:Ze,useDeferredValue:Ze,useTransition:Ze,useMutableSource:Ze,useSyncExternalStore:Ze,useId:Ze,unstable_isNewReconciler:!1},I1={readContext:It,useCallback:function(r,e){return tr().memoizedState=[r,e===void 0?null:e],r},useContext:It,useEffect:op,useImperativeHandle:function(r,e,t){return t=t!=null?t.concat([r]):null,va(4194308,4,Y0.bind(null,e,r),t)},useLayoutEffect:function(r,e){return va(4194308,4,r,e)},useInsertionEffect:function(r,e){return va(4,2,r,e)},useMemo:function(r,e){var t=tr();return e=e===void 0?null:e,r=r(),t.memoizedState=[r,e],r},useReducer:function(r,e,t){var i=tr();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:e},i.queue=r,r=r.dispatch=A1.bind(null,Ee,r),[i.memoizedState,r]},useRef:function(r){var e=tr();return r={current:r},e.memoizedState=r},useState:sp,useDebugValue:Hd,useDeferredValue:function(r){return tr().memoizedState=r},useTransition:function(){var r=sp(!1),e=r[0];return r=b1.bind(null,r[1]),tr().memoizedState=r,[e,r]},useMutableSource:function(){},useSyncExternalStore:function(r,e,t){var i=Ee,n=tr();if(ye){if(t===void 0)throw Error(B(407));t=t()}else{if(t=e(),je===null)throw Error(B(349));Ni&30||G0(i,e,t)}n.memoizedState=t;var s={value:t,getSnapshot:e};return n.queue=s,op(j0.bind(null,i,s,r),[r]),i.flags|=2048,to(9,z0.bind(null,i,s,t,e),void 0,null),t},useId:function(){var r=tr(),e=je.identifierPrefix;if(ye){var t=wr,i=_r;t=(i&~(1<<32-Gt(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Js++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=S1++,e=":"+e+"r"+t.toString(32)+":";return r.memoizedState=e},unstable_isNewReconciler:!1},R1={readContext:It,useCallback:q0,useContext:It,useEffect:jd,useImperativeHandle:K0,useInsertionEffect:W0,useLayoutEffect:X0,useMemo:Z0,useReducer:xh,useRef:V0,useState:function(){return xh(eo)},useDebugValue:Hd,useDeferredValue:function(r){var e=Rt();return Q0(e,Ne.memoizedState,r)},useTransition:function(){var r=xh(eo)[0],e=Rt().memoizedState;return[r,e]},useMutableSource:L0,useSyncExternalStore:U0,useId:J0,unstable_isNewReconciler:!1},P1={readContext:It,useCallback:q0,useContext:It,useEffect:jd,useImperativeHandle:K0,useInsertionEffect:W0,useLayoutEffect:X0,useMemo:Z0,useReducer:_h,useRef:V0,useState:function(){return _h(eo)},useDebugValue:Hd,useDeferredValue:function(r){var e=Rt();return Ne===null?e.memoizedState=r:Q0(e,Ne.memoizedState,r)},useTransition:function(){var r=_h(eo)[0],e=Rt().memoizedState;return[r,e]},useMutableSource:L0,useSyncExternalStore:U0,useId:J0,unstable_isNewReconciler:!1};function Ft(r,e){if(r&&r.defaultProps){e=Te({},e),r=r.defaultProps;for(var t in r)e[t]===void 0&&(e[t]=r[t]);return e}return e}function Ku(r,e,t,i){e=r.memoizedState,t=t(i,e),t=t==null?e:Te({},e,t),r.memoizedState=t,r.lanes===0&&(r.updateQueue.baseState=t)}var Ml={isMounted:function(r){return(r=r._reactInternals)?Vi(r)===r:!1},enqueueSetState:function(r,e,t){r=r._reactInternals;var i=it(),n=ri(r),s=Ar(i,n);s.payload=e,t!=null&&(s.callback=t),e=ei(r,s,n),e!==null&&(zt(e,r,n,i),ga(e,r,n))},enqueueReplaceState:function(r,e,t){r=r._reactInternals;var i=it(),n=ri(r),s=Ar(i,n);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=ei(r,s,n),e!==null&&(zt(e,r,n,i),ga(e,r,n))},enqueueForceUpdate:function(r,e){r=r._reactInternals;var t=it(),i=ri(r),n=Ar(t,i);n.tag=2,e!=null&&(n.callback=e),e=ei(r,n,i),e!==null&&(zt(e,r,i,t),ga(e,r,i))}};function ap(r,e,t,i,n,s,o){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Xs(t,i)||!Xs(n,s):!0}function iy(r,e,t){var i=!1,n=oi,s=e.contextType;return typeof s=="object"&&s!==null?s=It(s):(n=ut(e)?Oi:et.current,i=e.contextTypes,s=(i=i!=null)?Un(r,n):oi),e=new e(t,s),r.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ml,r.stateNode=e,e._reactInternals=r,i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=n,r.__reactInternalMemoizedMaskedChildContext=s),e}function lp(r,e,t,i){r=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==r&&Ml.enqueueReplaceState(e,e.state,null)}function qu(r,e,t,i){var n=r.stateNode;n.props=t,n.state=r.memoizedState,n.refs={},Od(r);var s=e.contextType;typeof s=="object"&&s!==null?n.context=It(s):(s=ut(e)?Oi:et.current,n.context=Un(r,s)),n.state=r.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ku(r,e,s,t),n.state=r.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&Ml.enqueueReplaceState(n,n.state,null),Ka(r,t,n,i),n.state=r.memoizedState),typeof n.componentDidMount=="function"&&(r.flags|=4194308)}function Hn(r,e){try{var t="",i=e;do t+=n_(i),i=i.return;while(i);var n=t}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:r,source:e,stack:n,digest:null}}function wh(r,e,t){return{value:r,source:null,stack:t??null,digest:e??null}}function Zu(r,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var M1=typeof WeakMap=="function"?WeakMap:Map;function ny(r,e,t){t=Ar(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){el||(el=!0,ac=i),Zu(r,e)},t}function sy(r,e,t){t=Ar(-1,t),t.tag=3;var i=r.type.getDerivedStateFromError;if(typeof i=="function"){var n=e.value;t.payload=function(){return i(n)},t.callback=function(){Zu(r,e)}}var s=r.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Zu(r,e),typeof i!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function hp(r,e,t){var i=r.pingCache;if(i===null){i=r.pingCache=new M1;var n=new Set;i.set(e,n)}else n=i.get(e),n===void 0&&(n=new Set,i.set(e,n));n.has(t)||(n.add(t),r=V1.bind(null,r,e,t),e.then(r,r))}function up(r){do{var e;if((e=r.tag===13)&&(e=r.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return r;r=r.return}while(r!==null);return null}function cp(r,e,t,i,n){return r.mode&1?(r.flags|=65536,r.lanes=n,r):(r===e?r.flags|=65536:(r.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ar(-1,1),e.tag=2,ei(t,e,1))),t.lanes|=1),r)}var k1=Br.ReactCurrentOwner,at=!1;function tt(r,e,t,i){e.child=r===null?B0(e,null,t,i):zn(e,r.child,t,i)}function dp(r,e,t,i,n){t=t.render;var s=e.ref;return In(e,n),i=Gd(r,e,t,i,s,n),t=zd(),r!==null&&!at?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~n,Mr(r,e,n)):(ye&&t&&Id(e),e.flags|=1,tt(r,e,i,n),e.child)}function fp(r,e,t,i,n){if(r===null){var s=t.type;return typeof s=="function"&&!Zd(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,oy(r,e,s,i,n)):(r=Ea(t.type,null,i,e,e.mode,n),r.ref=e.ref,r.return=e,e.child=r)}if(s=r.child,!(r.lanes&n)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Xs,t(o,i)&&r.ref===e.ref)return Mr(r,e,n)}return e.flags|=1,r=ii(s,i),r.ref=e.ref,r.return=e,e.child=r}function oy(r,e,t,i,n){if(r!==null){var s=r.memoizedProps;if(Xs(s,i)&&r.ref===e.ref)if(at=!1,e.pendingProps=i=s,(r.lanes&n)!==0)r.flags&131072&&(at=!0);else return e.lanes=r.lanes,Mr(r,e,n)}return Qu(r,e,t,i,n)}function ay(r,e,t){var i=e.pendingProps,n=i.children,s=r!==null?r.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ue(_n,pt),pt|=t;else{if(!(t&1073741824))return r=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:r,cachePool:null,transitions:null},e.updateQueue=null,ue(_n,pt),pt|=r,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,ue(_n,pt),pt|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,ue(_n,pt),pt|=i;return tt(r,e,n,t),e.child}function ly(r,e){var t=e.ref;(r===null&&t!==null||r!==null&&r.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Qu(r,e,t,i,n){var s=ut(t)?Oi:et.current;return s=Un(e,s),In(e,n),t=Gd(r,e,t,i,s,n),i=zd(),r!==null&&!at?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~n,Mr(r,e,n)):(ye&&i&&Id(e),e.flags|=1,tt(r,e,t,n),e.child)}function pp(r,e,t,i,n){if(ut(t)){var s=!0;$a(e)}else s=!1;if(In(e,n),e.stateNode===null)xa(r,e),iy(e,t,i),qu(e,t,i,n),i=!0;else if(r===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,h=t.contextType;typeof h=="object"&&h!==null?h=It(h):(h=ut(t)?Oi:et.current,h=Un(e,h));var u=t.getDerivedStateFromProps,c=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";c||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==h)&&lp(e,o,i,h),Gr=!1;var d=e.memoizedState;o.state=d,Ka(e,i,o,n),l=e.memoizedState,a!==i||d!==l||ht.current||Gr?(typeof u=="function"&&(Ku(e,t,u,i),l=e.memoizedState),(a=Gr||ap(e,t,a,i,d,l,h))?(c||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=h,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,F0(r,e),a=e.memoizedProps,h=e.type===e.elementType?a:Ft(e.type,a),o.props=h,c=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=It(l):(l=ut(t)?Oi:et.current,l=Un(e,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==c||d!==l)&&lp(e,o,i,l),Gr=!1,d=e.memoizedState,o.state=d,Ka(e,i,o,n);var p=e.memoizedState;a!==c||d!==p||ht.current||Gr?(typeof f=="function"&&(Ku(e,t,f,i),p=e.memoizedState),(h=Gr||ap(e,t,h,i,d,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===r.memoizedProps&&d===r.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===r.memoizedProps&&d===r.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=h):(typeof o.componentDidUpdate!="function"||a===r.memoizedProps&&d===r.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===r.memoizedProps&&d===r.memoizedState||(e.flags|=1024),i=!1)}return Ju(r,e,t,i,s,n)}function Ju(r,e,t,i,n,s){ly(r,e);var o=(e.flags&128)!==0;if(!i&&!o)return n&&Jf(e,t,!1),Mr(r,e,s);i=e.stateNode,k1.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,r!==null&&o?(e.child=zn(e,r.child,null,s),e.child=zn(e,null,a,s)):tt(r,e,a,s),e.memoizedState=i.state,n&&Jf(e,t,!0),e.child}function hy(r){var e=r.stateNode;e.pendingContext?Qf(r,e.pendingContext,e.pendingContext!==e.context):e.context&&Qf(r,e.context,!1),Fd(r,e.containerInfo)}function mp(r,e,t,i,n){return Gn(),Pd(n),e.flags|=256,tt(r,e,t,i),e.child}var ec={dehydrated:null,treeContext:null,retryLane:0};function tc(r){return{baseLanes:r,cachePool:null,transitions:null}}function uy(r,e,t){var i=e.pendingProps,n=_e.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=r!==null&&r.memoizedState===null?!1:(n&2)!==0),a?(s=!0,e.flags&=-129):(r===null||r.memoizedState!==null)&&(n|=1),ue(_e,n&1),r===null)return Xu(e),r=e.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(e.mode&1?r.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,r=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Bl(o,i,0,null),r=Pi(r,i,t,null),s.return=e,r.return=e,s.sibling=r,e.child=s,e.child.memoizedState=tc(t),e.memoizedState=ec,r):$d(e,o));if(n=r.memoizedState,n!==null&&(a=n.dehydrated,a!==null))return D1(r,e,o,i,a,n,t);if(s){s=i.fallback,o=e.mode,n=r.child,a=n.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==n?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=ii(n,l),i.subtreeFlags=n.subtreeFlags&14680064),a!==null?s=ii(a,s):(s=Pi(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=r.child.memoizedState,o=o===null?tc(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=r.childLanes&~t,e.memoizedState=ec,i}return s=r.child,r=s.sibling,i=ii(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,r!==null&&(t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)),e.child=i,e.memoizedState=null,i}function $d(r,e){return e=Bl({mode:"visible",children:e},r.mode,0,null),e.return=r,r.child=e}function Fo(r,e,t,i){return i!==null&&Pd(i),zn(e,r.child,null,t),r=$d(e,e.pendingProps.children),r.flags|=2,e.memoizedState=null,r}function D1(r,e,t,i,n,s,o){if(t)return e.flags&256?(e.flags&=-257,i=wh(Error(B(422))),Fo(r,e,o,i)):e.memoizedState!==null?(e.child=r.child,e.flags|=128,null):(s=i.fallback,n=e.mode,i=Bl({mode:"visible",children:i.children},n,0,null),s=Pi(s,n,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&zn(e,r.child,null,o),e.child.memoizedState=tc(o),e.memoizedState=ec,s);if(!(e.mode&1))return Fo(r,e,o,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(B(419)),i=wh(s,i,void 0),Fo(r,e,o,i)}if(a=(o&r.childLanes)!==0,at||a){if(i=je,i!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|o)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,Pr(r,n),zt(i,r,n,-1))}return qd(),i=wh(Error(B(421))),Fo(r,e,o,i)}return n.data==="$?"?(e.flags|=128,e.child=r.child,e=W1.bind(null,r),n._reactRetry=e,null):(r=s.treeContext,mt=Jr(n.nextSibling),yt=e,ye=!0,Lt=null,r!==null&&(Et[Tt++]=_r,Et[Tt++]=wr,Et[Tt++]=Fi,_r=r.id,wr=r.overflow,Fi=e),e=$d(e,i.children),e.flags|=4096,e)}function gp(r,e,t){r.lanes|=e;var i=r.alternate;i!==null&&(i.lanes|=e),Yu(r.return,e,t)}function Eh(r,e,t,i,n){var s=r.memoizedState;s===null?r.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:n}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=n)}function cy(r,e,t){var i=e.pendingProps,n=i.revealOrder,s=i.tail;if(tt(r,e,i.children,t),i=_e.current,i&2)i=i&1|2,e.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=e.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&gp(r,t,e);else if(r.tag===19)gp(r,t,e);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}i&=1}if(ue(_e,i),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)r=t.alternate,r!==null&&qa(r)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),Eh(e,!1,n,t,s);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(r=n.alternate,r!==null&&qa(r)===null){e.child=n;break}r=n.sibling,n.sibling=t,t=n,n=r}Eh(e,!0,t,null,s);break;case"together":Eh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xa(r,e){!(e.mode&1)&&r!==null&&(r.alternate=null,e.alternate=null,e.flags|=2)}function Mr(r,e,t){if(r!==null&&(e.dependencies=r.dependencies),Li|=e.lanes,!(t&e.childLanes))return null;if(r!==null&&e.child!==r.child)throw Error(B(153));if(e.child!==null){for(r=e.child,t=ii(r,r.pendingProps),e.child=t,t.return=e;r.sibling!==null;)r=r.sibling,t=t.sibling=ii(r,r.pendingProps),t.return=e;t.sibling=null}return e.child}function B1(r,e,t){switch(e.tag){case 3:hy(e),Gn();break;case 5:N0(e);break;case 1:ut(e.type)&&$a(e);break;case 4:Fd(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,n=e.memoizedProps.value;ue(Xa,i._currentValue),i._currentValue=n;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ue(_e,_e.current&1),e.flags|=128,null):t&e.child.childLanes?uy(r,e,t):(ue(_e,_e.current&1),r=Mr(r,e,t),r!==null?r.sibling:null);ue(_e,_e.current&1);break;case 19:if(i=(t&e.childLanes)!==0,r.flags&128){if(i)return cy(r,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),ue(_e,_e.current),i)break;return null;case 22:case 23:return e.lanes=0,ay(r,e,t)}return Mr(r,e,t)}var dy,rc,fy,py;dy=function(r,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)r.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};rc=function(){};fy=function(r,e,t,i){var n=r.memoizedProps;if(n!==i){r=e.stateNode,Ii(lr.current);var s=null;switch(t){case"input":n=Su(r,n),i=Su(r,i),s=[];break;case"select":n=Te({},n,{value:void 0}),i=Te({},i,{value:void 0}),s=[];break;case"textarea":n=Cu(r,n),i=Cu(r,i),s=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(r.onclick=ja)}Ru(t,i);var o;t=null;for(h in n)if(!i.hasOwnProperty(h)&&n.hasOwnProperty(h)&&n[h]!=null)if(h==="style"){var a=n[h];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Gs.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var l=i[h];if(a=n!=null?n[h]:void 0,i.hasOwnProperty(h)&&l!==a&&(l!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(h,t)),t=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Gs.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&ce("scroll",r),s||a===l||(s=[])):(s=s||[]).push(h,l))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};py=function(r,e,t,i){t!==i&&(e.flags|=4)};function as(r,e){if(!ye)switch(r.tailMode){case"hidden":e=r.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?r.tail=null:t.sibling=null;break;case"collapsed":t=r.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||r.tail===null?r.tail=null:r.tail.sibling=null:i.sibling=null}}function Qe(r){var e=r.alternate!==null&&r.alternate.child===r.child,t=0,i=0;if(e)for(var n=r.child;n!==null;)t|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=r,n=n.sibling;else for(n=r.child;n!==null;)t|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=r,n=n.sibling;return r.subtreeFlags|=i,r.childLanes=t,e}function O1(r,e,t){var i=e.pendingProps;switch(Rd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qe(e),null;case 1:return ut(e.type)&&Ha(),Qe(e),null;case 3:return i=e.stateNode,jn(),fe(ht),fe(et),Ld(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(r===null||r.child===null)&&(Bo(e)?e.flags|=4:r===null||r.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Lt!==null&&(uc(Lt),Lt=null))),rc(r,e),Qe(e),null;case 5:Nd(e);var n=Ii(Qs.current);if(t=e.type,r!==null&&e.stateNode!=null)fy(r,e,t,i,n),r.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(B(166));return Qe(e),null}if(r=Ii(lr.current),Bo(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[sr]=e,i[qs]=s,r=(e.mode&1)!==0,t){case"dialog":ce("cancel",i),ce("close",i);break;case"iframe":case"object":case"embed":ce("load",i);break;case"video":case"audio":for(n=0;n<ys.length;n++)ce(ys[n],i);break;case"source":ce("error",i);break;case"img":case"image":case"link":ce("error",i),ce("load",i);break;case"details":ce("toggle",i);break;case"input":bf(i,s),ce("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},ce("invalid",i);break;case"textarea":Cf(i,s),ce("invalid",i)}Ru(t,s),n=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Do(i.textContent,a,r),n=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Do(i.textContent,a,r),n=["children",""+a]):Gs.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ce("scroll",i)}switch(t){case"input":bo(i),Af(i,s,!0);break;case"textarea":bo(i),If(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=ja)}i=n,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=jg(t)),r==="http://www.w3.org/1999/xhtml"?t==="script"?(r=o.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof i.is=="string"?r=o.createElement(t,{is:i.is}):(r=o.createElement(t),t==="select"&&(o=r,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):r=o.createElementNS(r,t),r[sr]=e,r[qs]=i,dy(r,e,!1,!1),e.stateNode=r;e:{switch(o=Pu(t,i),t){case"dialog":ce("cancel",r),ce("close",r),n=i;break;case"iframe":case"object":case"embed":ce("load",r),n=i;break;case"video":case"audio":for(n=0;n<ys.length;n++)ce(ys[n],r);n=i;break;case"source":ce("error",r),n=i;break;case"img":case"image":case"link":ce("error",r),ce("load",r),n=i;break;case"details":ce("toggle",r),n=i;break;case"input":bf(r,i),n=Su(r,i),ce("invalid",r);break;case"option":n=i;break;case"select":r._wrapperState={wasMultiple:!!i.multiple},n=Te({},i,{value:void 0}),ce("invalid",r);break;case"textarea":Cf(r,i),n=Cu(r,i),ce("invalid",r);break;default:n=i}Ru(t,n),a=n;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Vg(r,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Hg(r,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&zs(r,l):typeof l=="number"&&zs(r,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Gs.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ce("scroll",r):l!=null&&pd(r,s,l,o))}switch(t){case"input":bo(r),Af(r,i,!1);break;case"textarea":bo(r),If(r);break;case"option":i.value!=null&&r.setAttribute("value",""+si(i.value));break;case"select":r.multiple=!!i.multiple,s=i.value,s!=null?Sn(r,!!i.multiple,s,!1):i.defaultValue!=null&&Sn(r,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(r.onclick=ja)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qe(e),null;case 6:if(r&&e.stateNode!=null)py(r,e,r.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(B(166));if(t=Ii(Qs.current),Ii(lr.current),Bo(e)){if(i=e.stateNode,t=e.memoizedProps,i[sr]=e,(s=i.nodeValue!==t)&&(r=yt,r!==null))switch(r.tag){case 3:Do(i.nodeValue,t,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Do(i.nodeValue,t,(r.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[sr]=e,e.stateNode=i}return Qe(e),null;case 13:if(fe(_e),i=e.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(ye&&mt!==null&&e.mode&1&&!(e.flags&128))k0(),Gn(),e.flags|=98560,s=!1;else if(s=Bo(e),i!==null&&i.dehydrated!==null){if(r===null){if(!s)throw Error(B(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(B(317));s[sr]=e}else Gn(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qe(e),s=!1}else Lt!==null&&(uc(Lt),Lt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(r!==null&&r.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(r===null||_e.current&1?Le===0&&(Le=3):qd())),e.updateQueue!==null&&(e.flags|=4),Qe(e),null);case 4:return jn(),rc(r,e),r===null&&Ys(e.stateNode.containerInfo),Qe(e),null;case 10:return Dd(e.type._context),Qe(e),null;case 17:return ut(e.type)&&Ha(),Qe(e),null;case 19:if(fe(_e),s=e.memoizedState,s===null)return Qe(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)as(s,!1);else{if(Le!==0||r!==null&&r.flags&128)for(r=e.child;r!==null;){if(o=qa(r),o!==null){for(e.flags|=128,as(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,r=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,r=o.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t=t.sibling;return ue(_e,_e.current&1|2),e.child}r=r.sibling}s.tail!==null&&Re()>$n&&(e.flags|=128,i=!0,as(s,!1),e.lanes=4194304)}else{if(!i)if(r=qa(o),r!==null){if(e.flags|=128,i=!0,t=r.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),as(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ye)return Qe(e),null}else 2*Re()-s.renderingStartTime>$n&&t!==1073741824&&(e.flags|=128,i=!0,as(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Re(),e.sibling=null,t=_e.current,ue(_e,i?t&1|2:t&1),e):(Qe(e),null);case 22:case 23:return Kd(),i=e.memoizedState!==null,r!==null&&r.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?pt&1073741824&&(Qe(e),e.subtreeFlags&6&&(e.flags|=8192)):Qe(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function F1(r,e){switch(Rd(e),e.tag){case 1:return ut(e.type)&&Ha(),r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 3:return jn(),fe(ht),fe(et),Ld(),r=e.flags,r&65536&&!(r&128)?(e.flags=r&-65537|128,e):null;case 5:return Nd(e),null;case 13:if(fe(_e),r=e.memoizedState,r!==null&&r.dehydrated!==null){if(e.alternate===null)throw Error(B(340));Gn()}return r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 19:return fe(_e),null;case 4:return jn(),null;case 10:return Dd(e.type._context),null;case 22:case 23:return Kd(),null;case 24:return null;default:return null}}var No=!1,Je=!1,N1=typeof WeakSet=="function"?WeakSet:Set,H=null;function xn(r,e){var t=r.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Ce(r,e,i)}else t.current=null}function ic(r,e,t){try{t()}catch(i){Ce(r,e,i)}}var yp=!1;function L1(r,e){if(Gu=Ua,r=x0(),Cd(r)){if("selectionStart"in r)var t={start:r.selectionStart,end:r.selectionEnd};else e:{t=(t=r.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,h=0,u=0,c=r,d=null;t:for(;;){for(var f;c!==t||n!==0&&c.nodeType!==3||(a=o+n),c!==s||i!==0&&c.nodeType!==3||(l=o+i),c.nodeType===3&&(o+=c.nodeValue.length),(f=c.firstChild)!==null;)d=c,c=f;for(;;){if(c===r)break t;if(d===t&&++h===n&&(a=o),d===s&&++u===i&&(l=o),(f=c.nextSibling)!==null)break;c=d,d=c.parentNode}c=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(zu={focusedElem:r,selectionRange:t},Ua=!1,H=e;H!==null;)if(e=H,r=e.child,(e.subtreeFlags&1028)!==0&&r!==null)r.return=e,H=r;else for(;H!==null;){e=H;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,x=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:Ft(e.type,v),x);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(_){Ce(e,e.return,_)}if(r=e.sibling,r!==null){r.return=e.return,H=r;break}H=e.return}return p=yp,yp=!1,p}function ks(r,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&r)===r){var s=n.destroy;n.destroy=void 0,s!==void 0&&ic(e,t,s)}n=n.next}while(n!==i)}}function kl(r,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&r)===r){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function nc(r){var e=r.ref;if(e!==null){var t=r.stateNode;switch(r.tag){case 5:r=t;break;default:r=t}typeof e=="function"?e(r):e.current=r}}function my(r){var e=r.alternate;e!==null&&(r.alternate=null,my(e)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(e=r.stateNode,e!==null&&(delete e[sr],delete e[qs],delete e[$u],delete e[_1],delete e[w1])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function gy(r){return r.tag===5||r.tag===3||r.tag===4}function vp(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||gy(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function sc(r,e,t){var i=r.tag;if(i===5||i===6)r=r.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(r,e):t.insertBefore(r,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(r,t)):(e=t,e.appendChild(r)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=ja));else if(i!==4&&(r=r.child,r!==null))for(sc(r,e,t),r=r.sibling;r!==null;)sc(r,e,t),r=r.sibling}function oc(r,e,t){var i=r.tag;if(i===5||i===6)r=r.stateNode,e?t.insertBefore(r,e):t.appendChild(r);else if(i!==4&&(r=r.child,r!==null))for(oc(r,e,t),r=r.sibling;r!==null;)oc(r,e,t),r=r.sibling}var We=null,Nt=!1;function Or(r,e,t){for(t=t.child;t!==null;)yy(r,e,t),t=t.sibling}function yy(r,e,t){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(Sl,t)}catch{}switch(t.tag){case 5:Je||xn(t,e);case 6:var i=We,n=Nt;We=null,Or(r,e,t),We=i,Nt=n,We!==null&&(Nt?(r=We,t=t.stateNode,r.nodeType===8?r.parentNode.removeChild(t):r.removeChild(t)):We.removeChild(t.stateNode));break;case 18:We!==null&&(Nt?(r=We,t=t.stateNode,r.nodeType===8?mh(r.parentNode,t):r.nodeType===1&&mh(r,t),Vs(r)):mh(We,t.stateNode));break;case 4:i=We,n=Nt,We=t.stateNode.containerInfo,Nt=!0,Or(r,e,t),We=i,Nt=n;break;case 0:case 11:case 14:case 15:if(!Je&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var s=n,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ic(t,e,o),n=n.next}while(n!==i)}Or(r,e,t);break;case 1:if(!Je&&(xn(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){Ce(t,e,a)}Or(r,e,t);break;case 21:Or(r,e,t);break;case 22:t.mode&1?(Je=(i=Je)||t.memoizedState!==null,Or(r,e,t),Je=i):Or(r,e,t);break;default:Or(r,e,t)}}function xp(r){var e=r.updateQueue;if(e!==null){r.updateQueue=null;var t=r.stateNode;t===null&&(t=r.stateNode=new N1),e.forEach(function(i){var n=X1.bind(null,r,i);t.has(i)||(t.add(i),i.then(n,n))})}}function Mt(r,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var n=t[i];try{var s=r,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:We=a.stateNode,Nt=!1;break e;case 3:We=a.stateNode.containerInfo,Nt=!0;break e;case 4:We=a.stateNode.containerInfo,Nt=!0;break e}a=a.return}if(We===null)throw Error(B(160));yy(s,o,n),We=null,Nt=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(h){Ce(n,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vy(e,r),e=e.sibling}function vy(r,e){var t=r.alternate,i=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Mt(e,r),Yt(r),i&4){try{ks(3,r,r.return),kl(3,r)}catch(v){Ce(r,r.return,v)}try{ks(5,r,r.return)}catch(v){Ce(r,r.return,v)}}break;case 1:Mt(e,r),Yt(r),i&512&&t!==null&&xn(t,t.return);break;case 5:if(Mt(e,r),Yt(r),i&512&&t!==null&&xn(t,t.return),r.flags&32){var n=r.stateNode;try{zs(n,"")}catch(v){Ce(r,r.return,v)}}if(i&4&&(n=r.stateNode,n!=null)){var s=r.memoizedProps,o=t!==null?t.memoizedProps:s,a=r.type,l=r.updateQueue;if(r.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Gg(n,s),Pu(a,o);var h=Pu(a,s);for(o=0;o<l.length;o+=2){var u=l[o],c=l[o+1];u==="style"?Vg(n,c):u==="dangerouslySetInnerHTML"?Hg(n,c):u==="children"?zs(n,c):pd(n,u,c,h)}switch(a){case"input":bu(n,s);break;case"textarea":zg(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Sn(n,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?Sn(n,!!s.multiple,s.defaultValue,!0):Sn(n,!!s.multiple,s.multiple?[]:"",!1))}n[qs]=s}catch(v){Ce(r,r.return,v)}}break;case 6:if(Mt(e,r),Yt(r),i&4){if(r.stateNode===null)throw Error(B(162));n=r.stateNode,s=r.memoizedProps;try{n.nodeValue=s}catch(v){Ce(r,r.return,v)}}break;case 3:if(Mt(e,r),Yt(r),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Vs(e.containerInfo)}catch(v){Ce(r,r.return,v)}break;case 4:Mt(e,r),Yt(r);break;case 13:Mt(e,r),Yt(r),n=r.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(Xd=Re())),i&4&&xp(r);break;case 22:if(u=t!==null&&t.memoizedState!==null,r.mode&1?(Je=(h=Je)||u,Mt(e,r),Je=h):Mt(e,r),Yt(r),i&8192){if(h=r.memoizedState!==null,(r.stateNode.isHidden=h)&&!u&&r.mode&1)for(H=r,u=r.child;u!==null;){for(c=H=u;H!==null;){switch(d=H,f=d.child,d.tag){case 0:case 11:case 14:case 15:ks(4,d,d.return);break;case 1:xn(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){i=d,t=d.return;try{e=i,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(v){Ce(i,t,v)}}break;case 5:xn(d,d.return);break;case 22:if(d.memoizedState!==null){wp(c);continue}}f!==null?(f.return=d,H=f):wp(c)}u=u.sibling}e:for(u=null,c=r;;){if(c.tag===5){if(u===null){u=c;try{n=c.stateNode,h?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=c.stateNode,l=c.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=$g("display",o))}catch(v){Ce(r,r.return,v)}}}else if(c.tag===6){if(u===null)try{c.stateNode.nodeValue=h?"":c.memoizedProps}catch(v){Ce(r,r.return,v)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===r)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===r)break e;for(;c.sibling===null;){if(c.return===null||c.return===r)break e;u===c&&(u=null),c=c.return}u===c&&(u=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:Mt(e,r),Yt(r),i&4&&xp(r);break;case 21:break;default:Mt(e,r),Yt(r)}}function Yt(r){var e=r.flags;if(e&2){try{e:{for(var t=r.return;t!==null;){if(gy(t)){var i=t;break e}t=t.return}throw Error(B(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(zs(n,""),i.flags&=-33);var s=vp(r);oc(r,s,n);break;case 3:case 4:var o=i.stateNode.containerInfo,a=vp(r);sc(r,a,o);break;default:throw Error(B(161))}}catch(l){Ce(r,r.return,l)}r.flags&=-3}e&4096&&(r.flags&=-4097)}function U1(r,e,t){H=r,xy(r)}function xy(r,e,t){for(var i=(r.mode&1)!==0;H!==null;){var n=H,s=n.child;if(n.tag===22&&i){var o=n.memoizedState!==null||No;if(!o){var a=n.alternate,l=a!==null&&a.memoizedState!==null||Je;a=No;var h=Je;if(No=o,(Je=l)&&!h)for(H=n;H!==null;)o=H,l=o.child,o.tag===22&&o.memoizedState!==null?Ep(n):l!==null?(l.return=o,H=l):Ep(n);for(;s!==null;)H=s,xy(s),s=s.sibling;H=n,No=a,Je=h}_p(r)}else n.subtreeFlags&8772&&s!==null?(s.return=n,H=s):_p(r)}}function _p(r){for(;H!==null;){var e=H;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Je||kl(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Je)if(t===null)i.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:Ft(e.type,t.memoizedProps);i.componentDidUpdate(n,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&np(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}np(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var u=h.memoizedState;if(u!==null){var c=u.dehydrated;c!==null&&Vs(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}Je||e.flags&512&&nc(e)}catch(d){Ce(e,e.return,d)}}if(e===r){H=null;break}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}}function wp(r){for(;H!==null;){var e=H;if(e===r){H=null;break}var t=e.sibling;if(t!==null){t.return=e.return,H=t;break}H=e.return}}function Ep(r){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{kl(4,e)}catch(l){Ce(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var n=e.return;try{i.componentDidMount()}catch(l){Ce(e,n,l)}}var s=e.return;try{nc(e)}catch(l){Ce(e,s,l)}break;case 5:var o=e.return;try{nc(e)}catch(l){Ce(e,o,l)}}}catch(l){Ce(e,e.return,l)}if(e===r){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var G1=Math.ceil,Ja=Br.ReactCurrentDispatcher,Vd=Br.ReactCurrentOwner,Ct=Br.ReactCurrentBatchConfig,oe=0,je=null,ke=null,Ye=0,pt=0,_n=hi(0),Le=0,ro=null,Li=0,Dl=0,Wd=0,Ds=null,ot=null,Xd=0,$n=1/0,yr=null,el=!1,ac=null,ti=null,Lo=!1,Wr=null,tl=0,Bs=0,lc=null,_a=-1,wa=0;function it(){return oe&6?Re():_a!==-1?_a:_a=Re()}function ri(r){return r.mode&1?oe&2&&Ye!==0?Ye&-Ye:T1.transition!==null?(wa===0&&(wa=i0()),wa):(r=ae,r!==0||(r=window.event,r=r===void 0?16:u0(r.type)),r):1}function zt(r,e,t,i){if(50<Bs)throw Bs=0,lc=null,Error(B(185));co(r,t,i),(!(oe&2)||r!==je)&&(r===je&&(!(oe&2)&&(Dl|=t),Le===4&&Hr(r,Ye)),ct(r,i),t===1&&oe===0&&!(e.mode&1)&&($n=Re()+500,Rl&&ui()))}function ct(r,e){var t=r.callbackNode;T_(r,e);var i=La(r,r===je?Ye:0);if(i===0)t!==null&&Mf(t),r.callbackNode=null,r.callbackPriority=0;else if(e=i&-i,r.callbackPriority!==e){if(t!=null&&Mf(t),e===1)r.tag===0?E1(Tp.bind(null,r)):R0(Tp.bind(null,r)),v1(function(){!(oe&6)&&ui()}),t=null;else{switch(n0(i)){case 1:t=xd;break;case 4:t=t0;break;case 16:t=Na;break;case 536870912:t=r0;break;default:t=Na}t=Cy(t,_y.bind(null,r))}r.callbackPriority=e,r.callbackNode=t}}function _y(r,e){if(_a=-1,wa=0,oe&6)throw Error(B(327));var t=r.callbackNode;if(Rn()&&r.callbackNode!==t)return null;var i=La(r,r===je?Ye:0);if(i===0)return null;if(i&30||i&r.expiredLanes||e)e=rl(r,i);else{e=i;var n=oe;oe|=2;var s=Ey();(je!==r||Ye!==e)&&(yr=null,$n=Re()+500,Ri(r,e));do try{H1();break}catch(a){wy(r,a)}while(1);kd(),Ja.current=s,oe=n,ke!==null?e=0:(je=null,Ye=0,e=Le)}if(e!==0){if(e===2&&(n=Ou(r),n!==0&&(i=n,e=hc(r,n))),e===1)throw t=ro,Ri(r,0),Hr(r,i),ct(r,Re()),t;if(e===6)Hr(r,i);else{if(n=r.current.alternate,!(i&30)&&!z1(n)&&(e=rl(r,i),e===2&&(s=Ou(r),s!==0&&(i=s,e=hc(r,s))),e===1))throw t=ro,Ri(r,0),Hr(r,i),ct(r,Re()),t;switch(r.finishedWork=n,r.finishedLanes=i,e){case 0:case 1:throw Error(B(345));case 2:gi(r,ot,yr);break;case 3:if(Hr(r,i),(i&130023424)===i&&(e=Xd+500-Re(),10<e)){if(La(r,0)!==0)break;if(n=r.suspendedLanes,(n&i)!==i){it(),r.pingedLanes|=r.suspendedLanes&n;break}r.timeoutHandle=Hu(gi.bind(null,r,ot,yr),e);break}gi(r,ot,yr);break;case 4:if(Hr(r,i),(i&4194240)===i)break;for(e=r.eventTimes,n=-1;0<i;){var o=31-Gt(i);s=1<<o,o=e[o],o>n&&(n=o),i&=~s}if(i=n,i=Re()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*G1(i/1960))-i,10<i){r.timeoutHandle=Hu(gi.bind(null,r,ot,yr),i);break}gi(r,ot,yr);break;case 5:gi(r,ot,yr);break;default:throw Error(B(329))}}}return ct(r,Re()),r.callbackNode===t?_y.bind(null,r):null}function hc(r,e){var t=Ds;return r.current.memoizedState.isDehydrated&&(Ri(r,e).flags|=256),r=rl(r,e),r!==2&&(e=ot,ot=t,e!==null&&uc(e)),r}function uc(r){ot===null?ot=r:ot.push.apply(ot,r)}function z1(r){for(var e=r;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var n=t[i],s=n.getSnapshot;n=n.value;try{if(!$t(s(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hr(r,e){for(e&=~Wd,e&=~Dl,r.suspendedLanes|=e,r.pingedLanes&=~e,r=r.expirationTimes;0<e;){var t=31-Gt(e),i=1<<t;r[t]=-1,e&=~i}}function Tp(r){if(oe&6)throw Error(B(327));Rn();var e=La(r,0);if(!(e&1))return ct(r,Re()),null;var t=rl(r,e);if(r.tag!==0&&t===2){var i=Ou(r);i!==0&&(e=i,t=hc(r,i))}if(t===1)throw t=ro,Ri(r,0),Hr(r,e),ct(r,Re()),t;if(t===6)throw Error(B(345));return r.finishedWork=r.current.alternate,r.finishedLanes=e,gi(r,ot,yr),ct(r,Re()),null}function Yd(r,e){var t=oe;oe|=1;try{return r(e)}finally{oe=t,oe===0&&($n=Re()+500,Rl&&ui())}}function Ui(r){Wr!==null&&Wr.tag===0&&!(oe&6)&&Rn();var e=oe;oe|=1;var t=Ct.transition,i=ae;try{if(Ct.transition=null,ae=1,r)return r()}finally{ae=i,Ct.transition=t,oe=e,!(oe&6)&&ui()}}function Kd(){pt=_n.current,fe(_n)}function Ri(r,e){r.finishedWork=null,r.finishedLanes=0;var t=r.timeoutHandle;if(t!==-1&&(r.timeoutHandle=-1,y1(t)),ke!==null)for(t=ke.return;t!==null;){var i=t;switch(Rd(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Ha();break;case 3:jn(),fe(ht),fe(et),Ld();break;case 5:Nd(i);break;case 4:jn();break;case 13:fe(_e);break;case 19:fe(_e);break;case 10:Dd(i.type._context);break;case 22:case 23:Kd()}t=t.return}if(je=r,ke=r=ii(r.current,null),Ye=pt=e,Le=0,ro=null,Wd=Dl=Li=0,ot=Ds=null,Ci!==null){for(e=0;e<Ci.length;e++)if(t=Ci[e],i=t.interleaved,i!==null){t.interleaved=null;var n=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=n,i.next=o}t.pending=i}Ci=null}return r}function wy(r,e){do{var t=ke;try{if(kd(),ya.current=Qa,Za){for(var i=Ee.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}Za=!1}if(Ni=0,Ge=Ne=Ee=null,Ms=!1,Js=0,Vd.current=null,t===null||t.return===null){Le=1,ro=e,ke=null;break}e:{var s=r,o=t.return,a=t,l=e;if(e=Ye,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,u=a,c=u.tag;if(!(u.mode&1)&&(c===0||c===11||c===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=up(o);if(f!==null){f.flags&=-257,cp(f,o,a,s,e),f.mode&1&&hp(s,h,e),e=f,l=h;var p=e.updateQueue;if(p===null){var v=new Set;v.add(l),e.updateQueue=v}else p.add(l);break e}else{if(!(e&1)){hp(s,h,e),qd();break e}l=Error(B(426))}}else if(ye&&a.mode&1){var x=up(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),cp(x,o,a,s,e),Pd(Hn(l,a));break e}}s=l=Hn(l,a),Le!==4&&(Le=2),Ds===null?Ds=[s]:Ds.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=ny(s,l,e);ip(s,g);break e;case 1:a=l;var y=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ti===null||!ti.has(m)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=sy(s,a,e);ip(s,_);break e}}s=s.return}while(s!==null)}Sy(t)}catch(E){e=E,ke===t&&t!==null&&(ke=t=t.return);continue}break}while(1)}function Ey(){var r=Ja.current;return Ja.current=Qa,r===null?Qa:r}function qd(){(Le===0||Le===3||Le===2)&&(Le=4),je===null||!(Li&268435455)&&!(Dl&268435455)||Hr(je,Ye)}function rl(r,e){var t=oe;oe|=2;var i=Ey();(je!==r||Ye!==e)&&(yr=null,Ri(r,e));do try{j1();break}catch(n){wy(r,n)}while(1);if(kd(),oe=t,Ja.current=i,ke!==null)throw Error(B(261));return je=null,Ye=0,Le}function j1(){for(;ke!==null;)Ty(ke)}function H1(){for(;ke!==null&&!p_();)Ty(ke)}function Ty(r){var e=Ay(r.alternate,r,pt);r.memoizedProps=r.pendingProps,e===null?Sy(r):ke=e,Vd.current=null}function Sy(r){var e=r;do{var t=e.alternate;if(r=e.return,e.flags&32768){if(t=F1(t,e),t!==null){t.flags&=32767,ke=t;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Le=6,ke=null;return}}else if(t=O1(t,e,pt),t!==null){ke=t;return}if(e=e.sibling,e!==null){ke=e;return}ke=e=r}while(e!==null);Le===0&&(Le=5)}function gi(r,e,t){var i=ae,n=Ct.transition;try{Ct.transition=null,ae=1,$1(r,e,t,i)}finally{Ct.transition=n,ae=i}return null}function $1(r,e,t,i){do Rn();while(Wr!==null);if(oe&6)throw Error(B(327));t=r.finishedWork;var n=r.finishedLanes;if(t===null)return null;if(r.finishedWork=null,r.finishedLanes=0,t===r.current)throw Error(B(177));r.callbackNode=null,r.callbackPriority=0;var s=t.lanes|t.childLanes;if(S_(r,s),r===je&&(ke=je=null,Ye=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Lo||(Lo=!0,Cy(Na,function(){return Rn(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Ct.transition,Ct.transition=null;var o=ae;ae=1;var a=oe;oe|=4,Vd.current=null,L1(r,t),vy(t,r),u1(zu),Ua=!!Gu,zu=Gu=null,r.current=t,U1(t),m_(),oe=a,ae=o,Ct.transition=s}else r.current=t;if(Lo&&(Lo=!1,Wr=r,tl=n),s=r.pendingLanes,s===0&&(ti=null),v_(t.stateNode),ct(r,Re()),e!==null)for(i=r.onRecoverableError,t=0;t<e.length;t++)n=e[t],i(n.value,{componentStack:n.stack,digest:n.digest});if(el)throw el=!1,r=ac,ac=null,r;return tl&1&&r.tag!==0&&Rn(),s=r.pendingLanes,s&1?r===lc?Bs++:(Bs=0,lc=r):Bs=0,ui(),null}function Rn(){if(Wr!==null){var r=n0(tl),e=Ct.transition,t=ae;try{if(Ct.transition=null,ae=16>r?16:r,Wr===null)var i=!1;else{if(r=Wr,Wr=null,tl=0,oe&6)throw Error(B(331));var n=oe;for(oe|=4,H=r.current;H!==null;){var s=H,o=s.child;if(H.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var h=a[l];for(H=h;H!==null;){var u=H;switch(u.tag){case 0:case 11:case 15:ks(8,u,s)}var c=u.child;if(c!==null)c.return=u,H=c;else for(;H!==null;){u=H;var d=u.sibling,f=u.return;if(my(u),u===h){H=null;break}if(d!==null){d.return=f,H=d;break}H=f}}}var p=s.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var x=v.sibling;v.sibling=null,v=x}while(v!==null)}}H=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,H=o;else e:for(;H!==null;){if(s=H,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ks(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,H=g;break e}H=s.return}}var y=r.current;for(H=y;H!==null;){o=H;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,H=m;else e:for(o=y;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:kl(9,a)}}catch(E){Ce(a,a.return,E)}if(a===o){H=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,H=_;break e}H=a.return}}if(oe=n,ui(),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(Sl,r)}catch{}i=!0}return i}finally{ae=t,Ct.transition=e}}return!1}function Sp(r,e,t){e=Hn(t,e),e=ny(r,e,1),r=ei(r,e,1),e=it(),r!==null&&(co(r,1,e),ct(r,e))}function Ce(r,e,t){if(r.tag===3)Sp(r,r,t);else for(;e!==null;){if(e.tag===3){Sp(e,r,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ti===null||!ti.has(i))){r=Hn(t,r),r=sy(e,r,1),e=ei(e,r,1),r=it(),e!==null&&(co(e,1,r),ct(e,r));break}}e=e.return}}function V1(r,e,t){var i=r.pingCache;i!==null&&i.delete(e),e=it(),r.pingedLanes|=r.suspendedLanes&t,je===r&&(Ye&t)===t&&(Le===4||Le===3&&(Ye&130023424)===Ye&&500>Re()-Xd?Ri(r,0):Wd|=t),ct(r,e)}function by(r,e){e===0&&(r.mode&1?(e=Io,Io<<=1,!(Io&130023424)&&(Io=4194304)):e=1);var t=it();r=Pr(r,e),r!==null&&(co(r,e,t),ct(r,t))}function W1(r){var e=r.memoizedState,t=0;e!==null&&(t=e.retryLane),by(r,t)}function X1(r,e){var t=0;switch(r.tag){case 13:var i=r.stateNode,n=r.memoizedState;n!==null&&(t=n.retryLane);break;case 19:i=r.stateNode;break;default:throw Error(B(314))}i!==null&&i.delete(e),by(r,t)}var Ay;Ay=function(r,e,t){if(r!==null)if(r.memoizedProps!==e.pendingProps||ht.current)at=!0;else{if(!(r.lanes&t)&&!(e.flags&128))return at=!1,B1(r,e,t);at=!!(r.flags&131072)}else at=!1,ye&&e.flags&1048576&&P0(e,Wa,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;xa(r,e),r=e.pendingProps;var n=Un(e,et.current);In(e,t),n=Gd(null,e,i,r,n,t);var s=zd();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ut(i)?(s=!0,$a(e)):s=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Od(e),n.updater=Ml,e.stateNode=n,n._reactInternals=e,qu(e,i,r,t),e=Ju(null,e,i,!0,s,t)):(e.tag=0,ye&&s&&Id(e),tt(null,e,n,t),e=e.child),e;case 16:i=e.elementType;e:{switch(xa(r,e),r=e.pendingProps,n=i._init,i=n(i._payload),e.type=i,n=e.tag=K1(i),r=Ft(i,r),n){case 0:e=Qu(null,e,i,r,t);break e;case 1:e=pp(null,e,i,r,t);break e;case 11:e=dp(null,e,i,r,t);break e;case 14:e=fp(null,e,i,Ft(i.type,r),t);break e}throw Error(B(306,i,""))}return e;case 0:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:Ft(i,n),Qu(r,e,i,n,t);case 1:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:Ft(i,n),pp(r,e,i,n,t);case 3:e:{if(hy(e),r===null)throw Error(B(387));i=e.pendingProps,s=e.memoizedState,n=s.element,F0(r,e),Ka(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){n=Hn(Error(B(423)),e),e=mp(r,e,i,t,n);break e}else if(i!==n){n=Hn(Error(B(424)),e),e=mp(r,e,i,t,n);break e}else for(mt=Jr(e.stateNode.containerInfo.firstChild),yt=e,ye=!0,Lt=null,t=B0(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Gn(),i===n){e=Mr(r,e,t);break e}tt(r,e,i,t)}e=e.child}return e;case 5:return N0(e),r===null&&Xu(e),i=e.type,n=e.pendingProps,s=r!==null?r.memoizedProps:null,o=n.children,ju(i,n)?o=null:s!==null&&ju(i,s)&&(e.flags|=32),ly(r,e),tt(r,e,o,t),e.child;case 6:return r===null&&Xu(e),null;case 13:return uy(r,e,t);case 4:return Fd(e,e.stateNode.containerInfo),i=e.pendingProps,r===null?e.child=zn(e,null,i,t):tt(r,e,i,t),e.child;case 11:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:Ft(i,n),dp(r,e,i,n,t);case 7:return tt(r,e,e.pendingProps,t),e.child;case 8:return tt(r,e,e.pendingProps.children,t),e.child;case 12:return tt(r,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,n=e.pendingProps,s=e.memoizedProps,o=n.value,ue(Xa,i._currentValue),i._currentValue=o,s!==null)if($t(s.value,o)){if(s.children===n.children&&!ht.current){e=Mr(r,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Ar(-1,t&-t),l.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var u=h.pending;u===null?l.next=l:(l.next=u.next,u.next=l),h.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Yu(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(B(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Yu(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}tt(r,e,n.children,t),e=e.child}return e;case 9:return n=e.type,i=e.pendingProps.children,In(e,t),n=It(n),i=i(n),e.flags|=1,tt(r,e,i,t),e.child;case 14:return i=e.type,n=Ft(i,e.pendingProps),n=Ft(i.type,n),fp(r,e,i,n,t);case 15:return oy(r,e,e.type,e.pendingProps,t);case 17:return i=e.type,n=e.pendingProps,n=e.elementType===i?n:Ft(i,n),xa(r,e),e.tag=1,ut(i)?(r=!0,$a(e)):r=!1,In(e,t),iy(e,i,n),qu(e,i,n,t),Ju(null,e,i,!0,r,t);case 19:return cy(r,e,t);case 22:return ay(r,e,t)}throw Error(B(156,e.tag))};function Cy(r,e){return e0(r,e)}function Y1(r,e,t,i){this.tag=r,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function St(r,e,t,i){return new Y1(r,e,t,i)}function Zd(r){return r=r.prototype,!(!r||!r.isReactComponent)}function K1(r){if(typeof r=="function")return Zd(r)?1:0;if(r!=null){if(r=r.$$typeof,r===gd)return 11;if(r===yd)return 14}return 2}function ii(r,e){var t=r.alternate;return t===null?(t=St(r.tag,e,r.key,r.mode),t.elementType=r.elementType,t.type=r.type,t.stateNode=r.stateNode,t.alternate=r,r.alternate=t):(t.pendingProps=e,t.type=r.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=r.flags&14680064,t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,e=r.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=r.sibling,t.index=r.index,t.ref=r.ref,t}function Ea(r,e,t,i,n,s){var o=2;if(i=r,typeof r=="function")Zd(r)&&(o=1);else if(typeof r=="string")o=5;else e:switch(r){case un:return Pi(t.children,n,s,e);case md:o=8,n|=8;break;case _u:return r=St(12,t,e,n|2),r.elementType=_u,r.lanes=s,r;case wu:return r=St(13,t,e,n),r.elementType=wu,r.lanes=s,r;case Eu:return r=St(19,t,e,n),r.elementType=Eu,r.lanes=s,r;case Ng:return Bl(t,n,s,e);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Og:o=10;break e;case Fg:o=9;break e;case gd:o=11;break e;case yd:o=14;break e;case Ur:o=16,i=null;break e}throw Error(B(130,r==null?r:typeof r,""))}return e=St(o,t,e,n),e.elementType=r,e.type=i,e.lanes=s,e}function Pi(r,e,t,i){return r=St(7,r,i,e),r.lanes=t,r}function Bl(r,e,t,i){return r=St(22,r,i,e),r.elementType=Ng,r.lanes=t,r.stateNode={isHidden:!1},r}function Th(r,e,t){return r=St(6,r,null,e),r.lanes=t,r}function Sh(r,e,t){return e=St(4,r.children!==null?r.children:[],r.key,e),e.lanes=t,e.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},e}function q1(r,e,t,i,n){this.tag=e,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nh(0),this.expirationTimes=nh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nh(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Qd(r,e,t,i,n,s,o,a,l){return r=new q1(r,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=St(3,null,null,e),r.current=s,s.stateNode=r,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Od(s),r}function Z1(r,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hn,key:i==null?null:""+i,children:r,containerInfo:e,implementation:t}}function Iy(r){if(!r)return oi;r=r._reactInternals;e:{if(Vi(r)!==r||r.tag!==1)throw Error(B(170));var e=r;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ut(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(r.tag===1){var t=r.type;if(ut(t))return I0(r,t,e)}return e}function Ry(r,e,t,i,n,s,o,a,l){return r=Qd(t,i,!0,r,n,s,o,a,l),r.context=Iy(null),t=r.current,i=it(),n=ri(t),s=Ar(i,n),s.callback=e??null,ei(t,s,n),r.current.lanes=n,co(r,n,i),ct(r,i),r}function Ol(r,e,t,i){var n=e.current,s=it(),o=ri(n);return t=Iy(t),e.context===null?e.context=t:e.pendingContext=t,e=Ar(s,o),e.payload={element:r},i=i===void 0?null:i,i!==null&&(e.callback=i),r=ei(n,e,o),r!==null&&(zt(r,n,o,s),ga(r,n,o)),o}function il(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function bp(r,e){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var t=r.retryLane;r.retryLane=t!==0&&t<e?t:e}}function Jd(r,e){bp(r,e),(r=r.alternate)&&bp(r,e)}function Q1(){return null}var Py=typeof reportError=="function"?reportError:function(r){console.error(r)};function ef(r){this._internalRoot=r}Fl.prototype.render=ef.prototype.render=function(r){var e=this._internalRoot;if(e===null)throw Error(B(409));Ol(r,e,null,null)};Fl.prototype.unmount=ef.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var e=r.containerInfo;Ui(function(){Ol(null,r,null,null)}),e[Rr]=null}};function Fl(r){this._internalRoot=r}Fl.prototype.unstable_scheduleHydration=function(r){if(r){var e=a0();r={blockedOn:null,target:r,priority:e};for(var t=0;t<jr.length&&e!==0&&e<jr[t].priority;t++);jr.splice(t,0,r),t===0&&h0(r)}};function tf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Nl(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Ap(){}function J1(r,e,t,i,n){if(n){if(typeof i=="function"){var s=i;i=function(){var h=il(o);s.call(h)}}var o=Ry(e,i,r,0,null,!1,!1,"",Ap);return r._reactRootContainer=o,r[Rr]=o.current,Ys(r.nodeType===8?r.parentNode:r),Ui(),o}for(;n=r.lastChild;)r.removeChild(n);if(typeof i=="function"){var a=i;i=function(){var h=il(l);a.call(h)}}var l=Qd(r,0,!1,null,null,!1,!1,"",Ap);return r._reactRootContainer=l,r[Rr]=l.current,Ys(r.nodeType===8?r.parentNode:r),Ui(function(){Ol(e,l,t,i)}),l}function Ll(r,e,t,i,n){var s=t._reactRootContainer;if(s){var o=s;if(typeof n=="function"){var a=n;n=function(){var l=il(o);a.call(l)}}Ol(e,o,r,n)}else o=J1(t,e,r,n,i);return il(o)}s0=function(r){switch(r.tag){case 3:var e=r.stateNode;if(e.current.memoizedState.isDehydrated){var t=gs(e.pendingLanes);t!==0&&(_d(e,t|1),ct(e,Re()),!(oe&6)&&($n=Re()+500,ui()))}break;case 13:Ui(function(){var i=Pr(r,1);if(i!==null){var n=it();zt(i,r,1,n)}}),Jd(r,1)}};wd=function(r){if(r.tag===13){var e=Pr(r,134217728);if(e!==null){var t=it();zt(e,r,134217728,t)}Jd(r,134217728)}};o0=function(r){if(r.tag===13){var e=ri(r),t=Pr(r,e);if(t!==null){var i=it();zt(t,r,e,i)}Jd(r,e)}};a0=function(){return ae};l0=function(r,e){var t=ae;try{return ae=r,e()}finally{ae=t}};ku=function(r,e,t){switch(e){case"input":if(bu(r,t),e=t.name,t.type==="radio"&&e!=null){for(t=r;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==r&&i.form===r.form){var n=Il(i);if(!n)throw Error(B(90));Ug(i),bu(i,n)}}}break;case"textarea":zg(r,t);break;case"select":e=t.value,e!=null&&Sn(r,!!t.multiple,e,!1)}};Yg=Yd;Kg=Ui;var ew={usingClientEntryPoint:!1,Events:[po,pn,Il,Wg,Xg,Yd]},ls={findFiberByHostInstance:Ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tw={bundleType:ls.bundleType,version:ls.version,rendererPackageName:ls.rendererPackageName,rendererConfig:ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Br.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Qg(r),r===null?null:r.stateNode},findFiberByHostInstance:ls.findFiberByHostInstance||Q1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uo.isDisabled&&Uo.supportsFiber)try{Sl=Uo.inject(tw),ar=Uo}catch{}}xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ew;xt.createPortal=function(r,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tf(e))throw Error(B(200));return Z1(r,e,null,t)};xt.createRoot=function(r,e){if(!tf(r))throw Error(B(299));var t=!1,i="",n=Py;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=Qd(r,1,!1,null,null,t,!1,i,n),r[Rr]=e.current,Ys(r.nodeType===8?r.parentNode:r),new ef(e)};xt.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var e=r._reactInternals;if(e===void 0)throw typeof r.render=="function"?Error(B(188)):(r=Object.keys(r).join(","),Error(B(268,r)));return r=Qg(e),r=r===null?null:r.stateNode,r};xt.flushSync=function(r){return Ui(r)};xt.hydrate=function(r,e,t){if(!Nl(e))throw Error(B(200));return Ll(null,r,e,!0,t)};xt.hydrateRoot=function(r,e,t){if(!tf(r))throw Error(B(405));var i=t!=null&&t.hydratedSources||null,n=!1,s="",o=Py;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Ry(e,null,r,1,t??null,n,!1,s,o),r[Rr]=e.current,Ys(r),i)for(r=0;r<i.length;r++)t=i[r],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new Fl(e)};xt.render=function(r,e,t){if(!Nl(e))throw Error(B(200));return Ll(null,r,e,!1,t)};xt.unmountComponentAtNode=function(r){if(!Nl(r))throw Error(B(40));return r._reactRootContainer?(Ui(function(){Ll(null,null,r,!1,function(){r._reactRootContainer=null,r[Rr]=null})}),!0):!1};xt.unstable_batchedUpdates=Yd;xt.unstable_renderSubtreeIntoContainer=function(r,e,t,i){if(!Nl(t))throw Error(B(200));if(r==null||r._reactInternals===void 0)throw Error(B(38));return Ll(r,e,t,!1,i)};xt.version="18.3.1-next-f1338f8080-20240426";function My(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(My)}catch(r){console.error(r)}}My(),Mg.exports=xt;var rw=Mg.exports,Cp=rw;vu.createRoot=Cp.createRoot,vu.hydrateRoot=Cp.hydrateRoot;const iw="modulepreload",nw=function(r){return"/"+r},Ip={},ge=function(e,t,i){if(!t||t.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=nw(s),s in Ip)return;Ip[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let u=n.length-1;u>=0;u--){const c=n[u];if(c.href===s&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const h=document.createElement("link");if(h.rel=o?"stylesheet":iw,o||(h.as="script",h.crossOrigin=""),h.href=s,document.head.appendChild(h),o)return new Promise((u,c)=>{h.addEventListener("load",u),h.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var Wi=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(Wi||{}),ky=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))(ky||{}),cc=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(cc||{}),Z=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(Z||{}),or=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(or||{}),O=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(O||{}),Pn=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(Pn||{}),Y=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(Y||{}),U=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(U||{}),Er=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(Er||{}),ni=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(ni||{}),dr=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(dr||{}),lt=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(lt||{}),ir=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(ir||{}),rf=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(rf||{}),bt=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(bt||{}),Oe=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(Oe||{}),Me=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(Me||{}),hr=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(hr||{});const sw={createCanvas:(r,e)=>{const t=document.createElement("canvas");return t.width=r,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,e)=>fetch(r,e),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},G={ADAPTER:sw,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var bh=/iPhone/i,Rp=/iPod/i,Pp=/iPad/i,Mp=/\biOS-universal(?:.+)Mac\b/i,Ah=/\bAndroid(?:.+)Mobile\b/i,kp=/Android/i,qi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Go=/Silk/i,mr=/Windows Phone/i,Dp=/\bWindows(?:.+)ARM\b/i,Bp=/BlackBerry/i,Op=/BB10/i,Fp=/Opera Mini/i,Np=/\b(CriOS|Chrome)(?:.+)Mobile/i,Lp=/Mobile(?:.+)Firefox\b/i,Up=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function ow(r){return function(e){return e.test(r)}}function Gp(r){var e={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?e.userAgent=r:r&&r.userAgent&&(e={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var t=e.userAgent,i=t.split("[FBAN");typeof i[1]<"u"&&(t=i[0]),i=t.split("Twitter"),typeof i[1]<"u"&&(t=i[0]);var n=ow(t),s={apple:{phone:n(bh)&&!n(mr),ipod:n(Rp),tablet:!n(bh)&&(n(Pp)||Up(e))&&!n(mr),universal:n(Mp),device:(n(bh)||n(Rp)||n(Pp)||n(Mp)||Up(e))&&!n(mr)},amazon:{phone:n(qi),tablet:!n(qi)&&n(Go),device:n(qi)||n(Go)},android:{phone:!n(mr)&&n(qi)||!n(mr)&&n(Ah),tablet:!n(mr)&&!n(qi)&&!n(Ah)&&(n(Go)||n(kp)),device:!n(mr)&&(n(qi)||n(Go)||n(Ah)||n(kp))||n(/\bokhttp\b/i)},windows:{phone:n(mr),tablet:n(Dp),device:n(mr)||n(Dp)},other:{blackberry:n(Bp),blackberry10:n(Op),opera:n(Fp),firefox:n(Lp),chrome:n(Np),device:n(Bp)||n(Op)||n(Fp)||n(Lp)||n(Np)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const aw=Gp.default??Gp,Tr=aw(globalThis.navigator);G.RETINA_PREFIX=/@([0-9\.]+)x/;G.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Dy={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function n(l,h,u){this.fn=l,this.context=h,this.once=u||!1}function s(l,h,u,c,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new n(u,c||l,d),p=t?t+h:h;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,h){--l._eventsCount===0?l._events=new i:delete l._events[h]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],u,c;if(this._eventsCount===0)return h;for(c in u=this._events)e.call(u,c)&&h.push(t?c.slice(1):c);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(u)):h},a.prototype.listeners=function(h){var u=t?t+h:h,c=this._events[u];if(!c)return[];if(c.fn)return[c.fn];for(var d=0,f=c.length,p=new Array(f);d<f;d++)p[d]=c[d].fn;return p},a.prototype.listenerCount=function(h){var u=t?t+h:h,c=this._events[u];return c?c.fn?1:c.length:0},a.prototype.emit=function(h,u,c,d,f,p){var v=t?t+h:h;if(!this._events[v])return!1;var x=this._events[v],g=arguments.length,y,m;if(x.fn){switch(x.once&&this.removeListener(h,x.fn,void 0,!0),g){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,c),!0;case 4:return x.fn.call(x.context,u,c,d),!0;case 5:return x.fn.call(x.context,u,c,d,f),!0;case 6:return x.fn.call(x.context,u,c,d,f,p),!0}for(m=1,y=new Array(g-1);m<g;m++)y[m-1]=arguments[m];x.fn.apply(x.context,y)}else{var _=x.length,E;for(m=0;m<_;m++)switch(x[m].once&&this.removeListener(h,x[m].fn,void 0,!0),g){case 1:x[m].fn.call(x[m].context);break;case 2:x[m].fn.call(x[m].context,u);break;case 3:x[m].fn.call(x[m].context,u,c);break;case 4:x[m].fn.call(x[m].context,u,c,d);break;default:if(!y)for(E=1,y=new Array(g-1);E<g;E++)y[E-1]=arguments[E];x[m].fn.apply(x[m].context,y)}}return!0},a.prototype.on=function(h,u,c){return s(this,h,u,c,!1)},a.prototype.once=function(h,u,c){return s(this,h,u,c,!0)},a.prototype.removeListener=function(h,u,c,d){var f=t?t+h:h;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!d||p.once)&&(!c||p.context===c)&&o(this,f);else{for(var v=0,x=[],g=p.length;v<g;v++)(p[v].fn!==u||d&&!p[v].once||c&&p[v].context!==c)&&x.push(p[v]);x.length?this._events[f]=x.length===1?x[0]:x:o(this,f)}return this},a.prototype.removeAllListeners=function(h){var u;return h?(u=t?t+h:h,this._events[u]&&o(this,u)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,r.exports=a})(Dy);var lw=Dy.exports;const go=ad(lw);var nf={exports:{}};nf.exports=Ul;nf.exports.default=Ul;function Ul(r,e,t){t=t||2;var i=e&&e.length,n=i?e[0]*t:r.length,s=By(r,0,n,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,h,u,c,d,f;if(i&&(s=fw(r,e,s,t)),r.length>80*t){a=h=r[0],l=u=r[1];for(var p=t;p<n;p+=t)c=r[p],d=r[p+1],c<a&&(a=c),d<l&&(l=d),c>h&&(h=c),d>u&&(u=d);f=Math.max(h-a,u-l),f=f!==0?32767/f:0}return io(s,o,t,a,l,f,0),o}function By(r,e,t,i,n){var s,o;if(n===pc(r,e,t,i)>0)for(s=e;s<t;s+=i)o=zp(s,r[s],r[s+1],o);else for(s=t-i;s>=e;s-=i)o=zp(s,r[s],r[s+1],o);return o&&Gl(o,o.next)&&(so(o),o=o.next),o}function Gi(r,e){if(!r)return r;e||(e=r);var t=r,i;do if(i=!1,!t.steiner&&(Gl(t,t.next)||we(t.prev,t,t.next)===0)){if(so(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function io(r,e,t,i,n,s,o){if(r){!o&&s&&vw(r,i,n,s);for(var a=r,l,h;r.prev!==r.next;){if(l=r.prev,h=r.next,s?uw(r,i,n,s):hw(r)){e.push(l.i/t|0),e.push(r.i/t|0),e.push(h.i/t|0),so(r),r=h.next,a=h.next;continue}if(r=h,r===a){o?o===1?(r=cw(Gi(r),e,t),io(r,e,t,i,n,s,2)):o===2&&dw(r,e,t,i,n,s):io(Gi(r),e,t,i,n,s,1);break}}}}function hw(r){var e=r.prev,t=r,i=r.next;if(we(e,t,i)>=0)return!1;for(var n=e.x,s=t.x,o=i.x,a=e.y,l=t.y,h=i.y,u=n<s?n<o?n:o:s<o?s:o,c=a<l?a<h?a:h:l<h?l:h,d=n>s?n>o?n:o:s>o?s:o,f=a>l?a>h?a:h:l>h?l:h,p=i.next;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=c&&p.y<=f&&wn(n,a,s,l,o,h,p.x,p.y)&&we(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function uw(r,e,t,i){var n=r.prev,s=r,o=r.next;if(we(n,s,o)>=0)return!1;for(var a=n.x,l=s.x,h=o.x,u=n.y,c=s.y,d=o.y,f=a<l?a<h?a:h:l<h?l:h,p=u<c?u<d?u:d:c<d?c:d,v=a>l?a>h?a:h:l>h?l:h,x=u>c?u>d?u:d:c>d?c:d,g=dc(f,p,e,t,i),y=dc(v,x,e,t,i),m=r.prevZ,_=r.nextZ;m&&m.z>=g&&_&&_.z<=y;){if(m.x>=f&&m.x<=v&&m.y>=p&&m.y<=x&&m!==n&&m!==o&&wn(a,u,l,c,h,d,m.x,m.y)&&we(m.prev,m,m.next)>=0||(m=m.prevZ,_.x>=f&&_.x<=v&&_.y>=p&&_.y<=x&&_!==n&&_!==o&&wn(a,u,l,c,h,d,_.x,_.y)&&we(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;m&&m.z>=g;){if(m.x>=f&&m.x<=v&&m.y>=p&&m.y<=x&&m!==n&&m!==o&&wn(a,u,l,c,h,d,m.x,m.y)&&we(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;_&&_.z<=y;){if(_.x>=f&&_.x<=v&&_.y>=p&&_.y<=x&&_!==n&&_!==o&&wn(a,u,l,c,h,d,_.x,_.y)&&we(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function cw(r,e,t){var i=r;do{var n=i.prev,s=i.next.next;!Gl(n,s)&&Oy(n,i,i.next,s)&&no(n,s)&&no(s,n)&&(e.push(n.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),so(i),so(i.next),i=r=s),i=i.next}while(i!==r);return Gi(i)}function dw(r,e,t,i,n,s){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&ww(o,a)){var l=Fy(o,a);o=Gi(o,o.next),l=Gi(l,l.next),io(o,e,t,i,n,s,0),io(l,e,t,i,n,s,0);return}a=a.next}o=o.next}while(o!==r)}function fw(r,e,t,i){var n=[],s,o,a,l,h;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:r.length,h=By(r,a,l,i,!1),h===h.next&&(h.steiner=!0),n.push(_w(h));for(n.sort(pw),s=0;s<n.length;s++)t=mw(n[s],t);return t}function pw(r,e){return r.x-e.x}function mw(r,e){var t=gw(r,e);if(!t)return e;var i=Fy(t,r);return Gi(i,i.next),Gi(t,t.next)}function gw(r,e){var t=e,i=r.x,n=r.y,s=-1/0,o;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){var a=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,h=o.x,u=o.y,c=1/0,d;t=o;do i>=t.x&&t.x>=h&&i!==t.x&&wn(n<u?i:s,n,h,u,n<u?s:i,n,t.x,t.y)&&(d=Math.abs(n-t.y)/(i-t.x),no(t,r)&&(d<c||d===c&&(t.x>o.x||t.x===o.x&&yw(o,t)))&&(o=t,c=d)),t=t.next;while(t!==l);return o}function yw(r,e){return we(r.prev,r,e.prev)<0&&we(e.next,r,r.next)<0}function vw(r,e,t,i){var n=r;do n.z===0&&(n.z=dc(n.x,n.y,e,t,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==r);n.prevZ.nextZ=null,n.prevZ=null,xw(n)}function xw(r){var e,t,i,n,s,o,a,l,h=1;do{for(t=r,r=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<h&&(a++,i=i.nextZ,!!i);e++);for(l=h;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(n=t,t=t.nextZ,a--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:r=n,n.prevZ=s,s=n;t=i}s.nextZ=null,h*=2}while(o>1);return r}function dc(r,e,t,i,n){return r=(r-t)*n|0,e=(e-i)*n|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function _w(r){var e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function wn(r,e,t,i,n,s,o,a){return(n-o)*(e-a)>=(r-o)*(s-a)&&(r-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(n-o)*(i-a)}function ww(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!Ew(r,e)&&(no(r,e)&&no(e,r)&&Tw(r,e)&&(we(r.prev,r,e.prev)||we(r,e.prev,e))||Gl(r,e)&&we(r.prev,r,r.next)>0&&we(e.prev,e,e.next)>0)}function we(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function Gl(r,e){return r.x===e.x&&r.y===e.y}function Oy(r,e,t,i){var n=jo(we(r,e,t)),s=jo(we(r,e,i)),o=jo(we(t,i,r)),a=jo(we(t,i,e));return!!(n!==s&&o!==a||n===0&&zo(r,t,e)||s===0&&zo(r,i,e)||o===0&&zo(t,r,i)||a===0&&zo(t,e,i))}function zo(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function jo(r){return r>0?1:r<0?-1:0}function Ew(r,e){var t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&Oy(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function no(r,e){return we(r.prev,r,r.next)<0?we(r,e,r.next)>=0&&we(r,r.prev,e)>=0:we(r,e,r.prev)<0||we(r,r.next,e)<0}function Tw(r,e){var t=r,i=!1,n=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&n<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==r);return i}function Fy(r,e){var t=new fc(r.i,r.x,r.y),i=new fc(e.i,e.x,e.y),n=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=n,n.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function zp(r,e,t,i){var n=new fc(r,e,t);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function so(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function fc(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ul.deviation=function(r,e,t,i){var n=e&&e.length,s=n?e[0]*t:r.length,o=Math.abs(pc(r,0,s,t));if(n)for(var a=0,l=e.length;a<l;a++){var h=e[a]*t,u=a<l-1?e[a+1]*t:r.length;o-=Math.abs(pc(r,h,u,t))}var c=0;for(a=0;a<i.length;a+=3){var d=i[a]*t,f=i[a+1]*t,p=i[a+2]*t;c+=Math.abs((r[d]-r[p])*(r[f+1]-r[d+1])-(r[d]-r[f])*(r[p+1]-r[d+1]))}return o===0&&c===0?0:Math.abs((c-o)/o)};function pc(r,e,t,i){for(var n=0,s=e,o=t-i;s<t;s+=i)n+=(r[o]-r[s])*(r[s+1]+r[o+1]),o=s;return n}Ul.flatten=function(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,n=0;n<r.length;n++){for(var s=0;s<r[n].length;s++)for(var o=0;o<e;o++)t.vertices.push(r[n][s][o]);n>0&&(i+=r[n-1].length,t.holes.push(i))}return t};var Sw=nf.exports;const bw=ad(Sw);var nl={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */nl.exports;(function(r,e){(function(t){var i=e&&!e.nodeType&&e,n=r&&!r.nodeType&&r,s=typeof bs=="object"&&bs;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,h=1,u=26,c=38,d=700,f=72,p=128,v="-",x=/^xn--/,g=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=l-h,E=Math.floor,b=String.fromCharCode,T;function S(C){throw new RangeError(m[C])}function P(C,M){for(var q=C.length,se=[];q--;)se[q]=M(C[q]);return se}function R(C,M){var q=C.split("@"),se="";q.length>1&&(se=q[0]+"@",C=q[1]),C=C.replace(y,".");var ie=C.split("."),be=P(ie,M).join(".");return se+be}function K(C){for(var M=[],q=0,se=C.length,ie,be;q<se;)ie=C.charCodeAt(q++),ie>=55296&&ie<=56319&&q<se?(be=C.charCodeAt(q++),(be&64512)==56320?M.push(((ie&1023)<<10)+(be&1023)+65536):(M.push(ie),q--)):M.push(ie);return M}function F(C){return P(C,function(M){var q="";return M>65535&&(M-=65536,q+=b(M>>>10&1023|55296),M=56320|M&1023),q+=b(M),q}).join("")}function A(C){return C-48<10?C-22:C-65<26?C-65:C-97<26?C-97:l}function D(C,M){return C+22+75*(C<26)-((M!=0)<<5)}function k(C,M,q){var se=0;for(C=q?E(C/d):C>>1,C+=E(C/M);C>_*u>>1;se+=l)C=E(C/_);return E(se+(_+1)*C/(C+c))}function j(C){var M=[],q=C.length,se,ie=0,be=p,le=f,ve,qe,dt,$e,me,Pe,De,Wt,Xt;for(ve=C.lastIndexOf(v),ve<0&&(ve=0),qe=0;qe<ve;++qe)C.charCodeAt(qe)>=128&&S("not-basic"),M.push(C.charCodeAt(qe));for(dt=ve>0?ve+1:0;dt<q;){for($e=ie,me=1,Pe=l;dt>=q&&S("invalid-input"),De=A(C.charCodeAt(dt++)),(De>=l||De>E((a-ie)/me))&&S("overflow"),ie+=De*me,Wt=Pe<=le?h:Pe>=le+u?u:Pe-le,!(De<Wt);Pe+=l)Xt=l-Wt,me>E(a/Xt)&&S("overflow"),me*=Xt;se=M.length+1,le=k(ie-$e,se,$e==0),E(ie/se)>a-be&&S("overflow"),be+=E(ie/se),ie%=se,M.splice(ie++,0,be)}return F(M)}function N(C){var M,q,se,ie,be,le,ve,qe,dt,$e,me,Pe=[],De,Wt,Xt,es;for(C=K(C),De=C.length,M=p,q=0,be=f,le=0;le<De;++le)me=C[le],me<128&&Pe.push(b(me));for(se=ie=Pe.length,ie&&Pe.push(v);se<De;){for(ve=a,le=0;le<De;++le)me=C[le],me>=M&&me<ve&&(ve=me);for(Wt=se+1,ve-M>E((a-q)/Wt)&&S("overflow"),q+=(ve-M)*Wt,M=ve,le=0;le<De;++le)if(me=C[le],me<M&&++q>a&&S("overflow"),me==M){for(qe=q,dt=l;$e=dt<=be?h:dt>=be+u?u:dt-be,!(qe<$e);dt+=l)es=qe-$e,Xt=l-$e,Pe.push(b(D($e+es%Xt,0))),qe=E(es/Xt);Pe.push(b(D(qe,0))),be=k(q,Wt,se==ie),q=0,++se}++q,++M}return Pe.join("")}function I(C){return R(C,function(M){return x.test(M)?j(M.slice(4).toLowerCase()):M})}function z(C){return R(C,function(M){return g.test(M)?"xn--"+N(M):M})}if(o={version:"1.4.1",ucs2:{decode:K,encode:F},decode:j,encode:N,toASCII:z,toUnicode:I},i&&n)if(r.exports==i)n.exports=o;else for(T in o)o.hasOwnProperty(T)&&(i[T]=o[T]);else t.punycode=o})(bs)})(nl,nl.exports);var Aw=nl.exports,Zn=TypeError;const Cw={},Iw=Object.freeze(Object.defineProperty({__proto__:null,default:Cw},Symbol.toStringTag,{value:"Module"})),Rw=Px(Iw);var sf=typeof Map=="function"&&Map.prototype,Ch=Object.getOwnPropertyDescriptor&&sf?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,sl=sf&&Ch&&typeof Ch.get=="function"?Ch.get:null,jp=sf&&Map.prototype.forEach,of=typeof Set=="function"&&Set.prototype,Ih=Object.getOwnPropertyDescriptor&&of?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ol=of&&Ih&&typeof Ih.get=="function"?Ih.get:null,Hp=of&&Set.prototype.forEach,Pw=typeof WeakMap=="function"&&WeakMap.prototype,Os=Pw?WeakMap.prototype.has:null,Mw=typeof WeakSet=="function"&&WeakSet.prototype,Fs=Mw?WeakSet.prototype.has:null,kw=typeof WeakRef=="function"&&WeakRef.prototype,$p=kw?WeakRef.prototype.deref:null,Dw=Boolean.prototype.valueOf,Bw=Object.prototype.toString,Ow=Function.prototype.toString,Fw=String.prototype.match,af=String.prototype.slice,Xr=String.prototype.replace,Nw=String.prototype.toUpperCase,Vp=String.prototype.toLowerCase,Ny=RegExp.prototype.test,Wp=Array.prototype.concat,nr=Array.prototype.join,Lw=Array.prototype.slice,Xp=Math.floor,mc=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Rh=Object.getOwnPropertySymbols,gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ns=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Vn||"symbol")?Symbol.toStringTag:null,Ly=Object.prototype.propertyIsEnumerable,Yp=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function Kp(r,e){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||Ny.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var i=r<0?-Xp(-r):Xp(r);if(i!==r){var n=String(i),s=af.call(e,n.length+1);return Xr.call(n,t,"$&_")+"."+Xr.call(Xr.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Xr.call(e,t,"$&_")}var yc=Rw,qp=yc.custom,Zp=zy(qp)?qp:null,Uy={__proto__:null,double:'"',single:"'"},Uw={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},zl=function r(e,t,i,n){var s=t||{};if(vr(s,"quoteStyle")&&!vr(Uy,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(vr(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=vr(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(vr(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(vr(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Hy(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?Kp(e,l):l}if(typeof e=="bigint"){var h=String(e)+"n";return a?Kp(e,h):h}var u=typeof s.depth>"u"?5:s.depth;if(typeof i>"u"&&(i=0),i>=u&&u>0&&typeof e=="object")return vc(e)?"[Array]":"[Object]";var c=iE(s,i);if(typeof n>"u")n=[];else if(jy(n,e)>=0)return"[Circular]";function d(A,D,k){if(D&&(n=Lw.call(n),n.push(D)),k){var j={depth:s.depth};return vr(s,"quoteStyle")&&(j.quoteStyle=s.quoteStyle),r(A,j,i+1,n)}return r(A,s,i+1,n)}if(typeof e=="function"&&!Qp(e)){var f=Yw(e),p=Ho(e,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+nr.call(p,", ")+" }":"")}if(zy(e)){var v=Vn?Xr.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):gc.call(e);return typeof e=="object"&&!Vn?hs(v):v}if(eE(e)){for(var x="<"+Vp.call(String(e.nodeName)),g=e.attributes||[],y=0;y<g.length;y++)x+=" "+g[y].name+"="+Gy(Gw(g[y].value),"double",s);return x+=">",e.childNodes&&e.childNodes.length&&(x+="..."),x+="</"+Vp.call(String(e.nodeName))+">",x}if(vc(e)){if(e.length===0)return"[]";var m=Ho(e,d);return c&&!rE(m)?"["+xc(m,c)+"]":"[ "+nr.call(m,", ")+" ]"}if(jw(e)){var _=Ho(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!Ly.call(e,"cause")?"{ ["+String(e)+"] "+nr.call(Wp.call("[cause]: "+d(e.cause),_),", ")+" }":_.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+nr.call(_,", ")+" }"}if(typeof e=="object"&&o){if(Zp&&typeof e[Zp]=="function"&&yc)return yc(e,{depth:u-i});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Kw(e)){var E=[];return jp&&jp.call(e,function(A,D){E.push(d(D,e,!0)+" => "+d(A,e))}),Jp("Map",sl.call(e),E,c)}if(Qw(e)){var b=[];return Hp&&Hp.call(e,function(A){b.push(d(A,e))}),Jp("Set",ol.call(e),b,c)}if(qw(e))return Ph("WeakMap");if(Jw(e))return Ph("WeakSet");if(Zw(e))return Ph("WeakRef");if($w(e))return hs(d(Number(e)));if(Ww(e))return hs(d(mc.call(e)));if(Vw(e))return hs(Dw.call(e));if(Hw(e))return hs(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof bs<"u"&&e===bs)return"{ [object globalThis] }";if(!zw(e)&&!Qp(e)){var T=Ho(e,d),S=Yp?Yp(e)===Object.prototype:e instanceof Object||e.constructor===Object,P=e instanceof Object?"":"null prototype",R=!S&&Ns&&Object(e)===e&&Ns in e?af.call(ci(e),8,-1):P?"Object":"",K=S||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",F=K+(R||P?"["+nr.call(Wp.call([],R||[],P||[]),": ")+"] ":"");return T.length===0?F+"{}":c?F+"{"+xc(T,c)+"}":F+"{ "+nr.call(T,", ")+" }"}return String(e)};function Gy(r,e,t){var i=t.quoteStyle||e,n=Uy[i];return n+r+n}function Gw(r){return Xr.call(String(r),/"/g,"&quot;")}function Xi(r){return!Ns||!(typeof r=="object"&&(Ns in r||typeof r[Ns]<"u"))}function vc(r){return ci(r)==="[object Array]"&&Xi(r)}function zw(r){return ci(r)==="[object Date]"&&Xi(r)}function Qp(r){return ci(r)==="[object RegExp]"&&Xi(r)}function jw(r){return ci(r)==="[object Error]"&&Xi(r)}function Hw(r){return ci(r)==="[object String]"&&Xi(r)}function $w(r){return ci(r)==="[object Number]"&&Xi(r)}function Vw(r){return ci(r)==="[object Boolean]"&&Xi(r)}function zy(r){if(Vn)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!gc)return!1;try{return gc.call(r),!0}catch{}return!1}function Ww(r){if(!r||typeof r!="object"||!mc)return!1;try{return mc.call(r),!0}catch{}return!1}var Xw=Object.prototype.hasOwnProperty||function(r){return r in this};function vr(r,e){return Xw.call(r,e)}function ci(r){return Bw.call(r)}function Yw(r){if(r.name)return r.name;var e=Fw.call(Ow.call(r),/^function\s*([\w$]+)/);return e?e[1]:null}function jy(r,e){if(r.indexOf)return r.indexOf(e);for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}function Kw(r){if(!sl||!r||typeof r!="object")return!1;try{sl.call(r);try{ol.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function qw(r){if(!Os||!r||typeof r!="object")return!1;try{Os.call(r,Os);try{Fs.call(r,Fs)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function Zw(r){if(!$p||!r||typeof r!="object")return!1;try{return $p.call(r),!0}catch{}return!1}function Qw(r){if(!ol||!r||typeof r!="object")return!1;try{ol.call(r);try{sl.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function Jw(r){if(!Fs||!r||typeof r!="object")return!1;try{Fs.call(r,Fs);try{Os.call(r,Os)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function eE(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function Hy(r,e){if(r.length>e.maxStringLength){var t=r.length-e.maxStringLength,i="... "+t+" more character"+(t>1?"s":"");return Hy(af.call(r,0,e.maxStringLength),e)+i}var n=Uw[e.quoteStyle||"single"];n.lastIndex=0;var s=Xr.call(Xr.call(r,n,"\\$1"),/[\x00-\x1f]/g,tE);return Gy(s,"single",e)}function tE(r){var e=r.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+Nw.call(e.toString(16))}function hs(r){return"Object("+r+")"}function Ph(r){return r+" { ? }"}function Jp(r,e,t,i){var n=i?xc(t,i):nr.call(t,", ");return r+" ("+e+") {"+n+"}"}function rE(r){for(var e=0;e<r.length;e++)if(jy(r[e],`
`)>=0)return!1;return!0}function iE(r,e){var t;if(r.indent==="	")t="	";else if(typeof r.indent=="number"&&r.indent>0)t=nr.call(Array(r.indent+1)," ");else return null;return{base:t,prev:nr.call(Array(e+1),t)}}function xc(r,e){if(r.length===0)return"";var t=`
`+e.prev+e.base;return t+nr.call(r,","+t)+`
`+e.prev}function Ho(r,e){var t=vc(r),i=[];if(t){i.length=r.length;for(var n=0;n<r.length;n++)i[n]=vr(r,n)?e(r[n],r):""}var s=typeof Rh=="function"?Rh(r):[],o;if(Vn){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in r)vr(r,l)&&(t&&String(Number(l))===l&&l<r.length||Vn&&o["$"+l]instanceof Symbol||(Ny.call(/[^\w$]/,l)?i.push(e(l,r)+": "+e(r[l],r)):i.push(l+": "+e(r[l],r))));if(typeof Rh=="function")for(var h=0;h<s.length;h++)Ly.call(r,s[h])&&i.push("["+e(s[h])+"]: "+e(r[s[h]],r));return i}var nE=zl,sE=Zn,jl=function(r,e,t){for(var i=r,n;(n=i.next)!=null;i=n)if(n.key===e)return i.next=n.next,t||(n.next=r.next,r.next=n),n},oE=function(r,e){if(r){var t=jl(r,e);return t&&t.value}},aE=function(r,e,t){var i=jl(r,e);i?i.value=t:r.next={key:e,next:r.next,value:t}},lE=function(r,e){return r?!!jl(r,e):!1},hE=function(r,e){if(r)return jl(r,e,!0)},uE=function(){var e,t={assert:function(i){if(!t.has(i))throw new sE("Side channel does not contain "+nE(i))},delete:function(i){var n=e&&e.next,s=hE(e,i);return s&&n&&n===s&&(e=void 0),!!s},get:function(i){return oE(e,i)},has:function(i){return lE(e,i)},set:function(i,n){e||(e={next:void 0}),aE(e,i,n)}};return t},$y=Object,cE=Error,dE=EvalError,fE=RangeError,pE=ReferenceError,mE=SyntaxError,gE=URIError,yE=Math.abs,vE=Math.floor,xE=Math.max,_E=Math.min,wE=Math.pow,EE=Math.round,TE=Number.isNaN||function(e){return e!==e},SE=TE,bE=function(e){return SE(e)||e===0?e:e<0?-1:1},AE=Object.getOwnPropertyDescriptor,Ta=AE;if(Ta)try{Ta([],"length")}catch{Ta=null}var Vy=Ta,Sa=Object.defineProperty||!1;if(Sa)try{Sa({},"a",{value:1})}catch{Sa=!1}var CE=Sa,Mh,em;function IE(){return em||(em=1,Mh=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||a.enumerable!==!0)return!1}return!0}),Mh}var kh,tm;function RE(){if(tm)return kh;tm=1;var r=typeof Symbol<"u"&&Symbol,e=IE();return kh=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},kh}var Dh,rm;function Wy(){return rm||(rm=1,Dh=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Dh}var Bh,im;function Xy(){if(im)return Bh;im=1;var r=$y;return Bh=r.getPrototypeOf||null,Bh}var PE="Function.prototype.bind called on incompatible ",ME=Object.prototype.toString,kE=Math.max,DE="[object Function]",nm=function(e,t){for(var i=[],n=0;n<e.length;n+=1)i[n]=e[n];for(var s=0;s<t.length;s+=1)i[s+e.length]=t[s];return i},BE=function(e,t){for(var i=[],n=t||0,s=0;n<e.length;n+=1,s+=1)i[s]=e[n];return i},OE=function(r,e){for(var t="",i=0;i<r.length;i+=1)t+=r[i],i+1<r.length&&(t+=e);return t},FE=function(e){var t=this;if(typeof t!="function"||ME.apply(t)!==DE)throw new TypeError(PE+t);for(var i=BE(arguments,1),n,s=function(){if(this instanceof n){var u=t.apply(this,nm(i,arguments));return Object(u)===u?u:this}return t.apply(e,nm(i,arguments))},o=kE(0,t.length-i.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(n=Function("binder","return function ("+OE(a,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var h=function(){};h.prototype=t.prototype,n.prototype=new h,h.prototype=null}return n},NE=FE,Hl=Function.prototype.bind||NE,lf=Function.prototype.call,Oh,sm;function Yy(){return sm||(sm=1,Oh=Function.prototype.apply),Oh}var LE=typeof Reflect<"u"&&Reflect&&Reflect.apply,UE=Hl,GE=Yy(),zE=lf,jE=LE,HE=jE||UE.call(zE,GE),$E=Hl,VE=Zn,WE=lf,XE=HE,Ky=function(e){if(e.length<1||typeof e[0]!="function")throw new VE("a function is required");return XE($E,WE,e)},Fh,om;function YE(){if(om)return Fh;om=1;var r=Ky,e=Vy,t;try{t=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var i=!!t&&e&&e(Object.prototype,"__proto__"),n=Object,s=n.getPrototypeOf;return Fh=i&&typeof i.get=="function"?r([i.get]):typeof s=="function"?function(a){return s(a==null?a:n(a))}:!1,Fh}var Nh,am;function KE(){if(am)return Nh;am=1;var r=Wy(),e=Xy(),t=YE();return Nh=r?function(n){return r(n)}:e?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return e(n)}:t?function(n){return t(n)}:null,Nh}var Lh,lm;function qE(){if(lm)return Lh;lm=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Hl;return Lh=t.call(r,e),Lh}var ee,ZE=$y,QE=cE,JE=dE,eT=fE,tT=pE,Wn=mE,Mn=Zn,rT=gE,iT=yE,nT=vE,sT=xE,oT=_E,aT=wE,lT=EE,hT=bE,qy=Function,Uh=function(r){try{return qy('"use strict"; return ('+r+").constructor;")()}catch{}},oo=Vy,uT=CE,Gh=function(){throw new Mn},cT=oo?function(){try{return arguments.callee,Gh}catch{try{return oo(arguments,"callee").get}catch{return Gh}}}():Gh,Zi=RE()(),Ue=KE(),dT=Xy(),fT=Wy(),Zy=Yy(),yo=lf,tn={},pT=typeof Uint8Array>"u"||!Ue?ee:Ue(Uint8Array),Mi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?ee:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ee:ArrayBuffer,"%ArrayIteratorPrototype%":Zi&&Ue?Ue([][Symbol.iterator]()):ee,"%AsyncFromSyncIteratorPrototype%":ee,"%AsyncFunction%":tn,"%AsyncGenerator%":tn,"%AsyncGeneratorFunction%":tn,"%AsyncIteratorPrototype%":tn,"%Atomics%":typeof Atomics>"u"?ee:Atomics,"%BigInt%":typeof BigInt>"u"?ee:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ee:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ee:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ee:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":QE,"%eval%":eval,"%EvalError%":JE,"%Float16Array%":typeof Float16Array>"u"?ee:Float16Array,"%Float32Array%":typeof Float32Array>"u"?ee:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ee:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ee:FinalizationRegistry,"%Function%":qy,"%GeneratorFunction%":tn,"%Int8Array%":typeof Int8Array>"u"?ee:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ee:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ee:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Zi&&Ue?Ue(Ue([][Symbol.iterator]())):ee,"%JSON%":typeof JSON=="object"?JSON:ee,"%Map%":typeof Map>"u"?ee:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Zi||!Ue?ee:Ue(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":ZE,"%Object.getOwnPropertyDescriptor%":oo,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ee:Promise,"%Proxy%":typeof Proxy>"u"?ee:Proxy,"%RangeError%":eT,"%ReferenceError%":tT,"%Reflect%":typeof Reflect>"u"?ee:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ee:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Zi||!Ue?ee:Ue(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ee:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Zi&&Ue?Ue(""[Symbol.iterator]()):ee,"%Symbol%":Zi?Symbol:ee,"%SyntaxError%":Wn,"%ThrowTypeError%":cT,"%TypedArray%":pT,"%TypeError%":Mn,"%Uint8Array%":typeof Uint8Array>"u"?ee:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ee:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ee:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ee:Uint32Array,"%URIError%":rT,"%WeakMap%":typeof WeakMap>"u"?ee:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ee:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ee:WeakSet,"%Function.prototype.call%":yo,"%Function.prototype.apply%":Zy,"%Object.defineProperty%":uT,"%Object.getPrototypeOf%":dT,"%Math.abs%":iT,"%Math.floor%":nT,"%Math.max%":sT,"%Math.min%":oT,"%Math.pow%":aT,"%Math.round%":lT,"%Math.sign%":hT,"%Reflect.getPrototypeOf%":fT};if(Ue)try{null.error}catch(r){var mT=Ue(Ue(r));Mi["%Error.prototype%"]=mT}var gT=function r(e){var t;if(e==="%AsyncFunction%")t=Uh("async function () {}");else if(e==="%GeneratorFunction%")t=Uh("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=Uh("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=r("%AsyncGenerator%");n&&Ue&&(t=Ue(n.prototype))}return Mi[e]=t,t},hm={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},vo=Hl,al=qE(),yT=vo.call(yo,Array.prototype.concat),vT=vo.call(Zy,Array.prototype.splice),um=vo.call(yo,String.prototype.replace),ll=vo.call(yo,String.prototype.slice),xT=vo.call(yo,RegExp.prototype.exec),_T=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,wT=/\\(\\)?/g,ET=function(e){var t=ll(e,0,1),i=ll(e,-1);if(t==="%"&&i!=="%")throw new Wn("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new Wn("invalid intrinsic syntax, expected opening `%`");var n=[];return um(e,_T,function(s,o,a,l){n[n.length]=a?um(l,wT,"$1"):o||s}),n},TT=function(e,t){var i=e,n;if(al(hm,i)&&(n=hm[i],i="%"+n[0]+"%"),al(Mi,i)){var s=Mi[i];if(s===tn&&(s=gT(i)),typeof s>"u"&&!t)throw new Mn("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new Wn("intrinsic "+e+" does not exist!")},hf=function(e,t){if(typeof e!="string"||e.length===0)throw new Mn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Mn('"allowMissing" argument must be a boolean');if(xT(/^%?[^%]*%?$/,e)===null)throw new Wn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=ET(e),n=i.length>0?i[0]:"",s=TT("%"+n+"%",t),o=s.name,a=s.value,l=!1,h=s.alias;h&&(n=h[0],vT(i,yT([0,1],h)));for(var u=1,c=!0;u<i.length;u+=1){var d=i[u],f=ll(d,0,1),p=ll(d,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new Wn("property names with quotes must have matching quotes");if((d==="constructor"||!c)&&(l=!0),n+="."+d,o="%"+n+"%",al(Mi,o))a=Mi[o];else if(a!=null){if(!(d in a)){if(!t)throw new Mn("base intrinsic for "+e+" exists, but the property is not available.");return}if(oo&&u+1>=i.length){var v=oo(a,d);c=!!v,c&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[d]}else c=al(a,d),a=a[d];c&&!l&&(Mi[o]=a)}}return a},Qy=hf,Jy=Ky,ST=Jy([Qy("%String.prototype.indexOf%")]),ev=function(e,t){var i=Qy(e,!!t);return typeof i=="function"&&ST(e,".prototype.")>-1?Jy([i]):i},bT=hf,xo=ev,AT=zl,CT=Zn,cm=bT("%Map%",!0),IT=xo("Map.prototype.get",!0),RT=xo("Map.prototype.set",!0),PT=xo("Map.prototype.has",!0),MT=xo("Map.prototype.delete",!0),kT=xo("Map.prototype.size",!0),tv=!!cm&&function(){var e,t={assert:function(i){if(!t.has(i))throw new CT("Side channel does not contain "+AT(i))},delete:function(i){if(e){var n=MT(e,i);return kT(e)===0&&(e=void 0),n}return!1},get:function(i){if(e)return IT(e,i)},has:function(i){return e?PT(e,i):!1},set:function(i,n){e||(e=new cm),RT(e,i,n)}};return t},DT=hf,$l=ev,BT=zl,$o=tv,OT=Zn,Qi=DT("%WeakMap%",!0),FT=$l("WeakMap.prototype.get",!0),NT=$l("WeakMap.prototype.set",!0),LT=$l("WeakMap.prototype.has",!0),UT=$l("WeakMap.prototype.delete",!0),GT=Qi?function(){var e,t,i={assert:function(n){if(!i.has(n))throw new OT("Side channel does not contain "+BT(n))},delete:function(n){if(Qi&&n&&(typeof n=="object"||typeof n=="function")){if(e)return UT(e,n)}else if($o&&t)return t.delete(n);return!1},get:function(n){return Qi&&n&&(typeof n=="object"||typeof n=="function")&&e?FT(e,n):t&&t.get(n)},has:function(n){return Qi&&n&&(typeof n=="object"||typeof n=="function")&&e?LT(e,n):!!t&&t.has(n)},set:function(n,s){Qi&&n&&(typeof n=="object"||typeof n=="function")?(e||(e=new Qi),NT(e,n,s)):$o&&(t||(t=$o()),t.set(n,s))}};return i}:$o,zT=Zn,jT=zl,HT=uE,$T=tv,VT=GT,WT=VT||$T||HT,XT=function(){var e,t={assert:function(i){if(!t.has(i))throw new zT("Side channel does not contain "+jT(i))},delete:function(i){return!!e&&e.delete(i)},get:function(i){return e&&e.get(i)},has:function(i){return!!e&&e.has(i)},set:function(i,n){e||(e=WT()),e.set(i,n)}};return t},YT=String.prototype.replace,KT=/%20/g,zh={RFC1738:"RFC1738",RFC3986:"RFC3986"},uf={default:zh.RFC3986,formatters:{RFC1738:function(r){return YT.call(r,KT,"+")},RFC3986:function(r){return String(r)}},RFC1738:zh.RFC1738,RFC3986:zh.RFC3986},qT=uf,jh=Object.prototype.hasOwnProperty,Ti=Array.isArray,Kt=function(){for(var r=[],e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),ZT=function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(Ti(i)){for(var n=[],s=0;s<i.length;++s)typeof i[s]<"u"&&n.push(i[s]);t.obj[t.prop]=n}}},rv=function(e,t){for(var i=t&&t.plainObjects?{__proto__:null}:{},n=0;n<e.length;++n)typeof e[n]<"u"&&(i[n]=e[n]);return i},QT=function r(e,t,i){if(!t)return e;if(typeof t!="object"&&typeof t!="function"){if(Ti(e))e.push(t);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!jh.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var n=e;return Ti(e)&&!Ti(t)&&(n=rv(e,i)),Ti(e)&&Ti(t)?(t.forEach(function(s,o){if(jh.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=r(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return jh.call(s,o)?s[o]=r(s[o],a,i):s[o]=a,s},n)},JT=function(e,t){return Object.keys(t).reduce(function(i,n){return i[n]=t[n],i},e)},eS=function(r,e,t){var i=r.replace(/\+/g," ");if(t==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},Hh=1024,tS=function(e,t,i,n,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;l+=Hh){for(var h=o.length>=Hh?o.slice(l,l+Hh):o,u=[],c=0;c<h.length;++c){var d=h.charCodeAt(c);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===qT.RFC1738&&(d===40||d===41)){u[u.length]=h.charAt(c);continue}if(d<128){u[u.length]=Kt[d];continue}if(d<2048){u[u.length]=Kt[192|d>>6]+Kt[128|d&63];continue}if(d<55296||d>=57344){u[u.length]=Kt[224|d>>12]+Kt[128|d>>6&63]+Kt[128|d&63];continue}c+=1,d=65536+((d&1023)<<10|h.charCodeAt(c)&1023),u[u.length]=Kt[240|d>>18]+Kt[128|d>>12&63]+Kt[128|d>>6&63]+Kt[128|d&63]}a+=u.join("")}return a},rS=function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],n=0;n<t.length;++n)for(var s=t[n],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var h=a[l],u=o[h];typeof u=="object"&&u!==null&&i.indexOf(u)===-1&&(t.push({obj:o,prop:h}),i.push(u))}return ZT(t),e},iS=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},nS=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},sS=function(e,t){return[].concat(e,t)},oS=function(e,t){if(Ti(e)){for(var i=[],n=0;n<e.length;n+=1)i.push(t(e[n]));return i}return t(e)},iv={arrayToObject:rv,assign:JT,combine:sS,compact:rS,decode:eS,encode:tS,isBuffer:nS,isRegExp:iS,maybeMap:oS,merge:QT},nv=XT,ba=iv,Ls=uf,aS=Object.prototype.hasOwnProperty,sv={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},rr=Array.isArray,lS=Array.prototype.push,ov=function(r,e){lS.apply(r,rr(e)?e:[e])},hS=Date.prototype.toISOString,dm=Ls.default,Be={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ba.encode,encodeValuesOnly:!1,filter:void 0,format:dm,formatter:Ls.formatters[dm],indices:!1,serializeDate:function(e){return hS.call(e)},skipNulls:!1,strictNullHandling:!1},uS=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},$h={},cS=function r(e,t,i,n,s,o,a,l,h,u,c,d,f,p,v,x,g,y){for(var m=e,_=y,E=0,b=!1;(_=_.get($h))!==void 0&&!b;){var T=_.get(e);if(E+=1,typeof T<"u"){if(T===E)throw new RangeError("Cyclic object value");b=!0}typeof _.get($h)>"u"&&(E=0)}if(typeof u=="function"?m=u(t,m):m instanceof Date?m=f(m):i==="comma"&&rr(m)&&(m=ba.maybeMap(m,function(C){return C instanceof Date?f(C):C})),m===null){if(o)return h&&!x?h(t,Be.encoder,g,"key",p):t;m=""}if(uS(m)||ba.isBuffer(m)){if(h){var S=x?t:h(t,Be.encoder,g,"key",p);return[v(S)+"="+v(h(m,Be.encoder,g,"value",p))]}return[v(t)+"="+v(String(m))]}var P=[];if(typeof m>"u")return P;var R;if(i==="comma"&&rr(m))x&&h&&(m=ba.maybeMap(m,h)),R=[{value:m.length>0?m.join(",")||null:void 0}];else if(rr(u))R=u;else{var K=Object.keys(m);R=c?K.sort(c):K}var F=l?String(t).replace(/\./g,"%2E"):String(t),A=n&&rr(m)&&m.length===1?F+"[]":F;if(s&&rr(m)&&m.length===0)return A+"[]";for(var D=0;D<R.length;++D){var k=R[D],j=typeof k=="object"&&k&&typeof k.value<"u"?k.value:m[k];if(!(a&&j===null)){var N=d&&l?String(k).replace(/\./g,"%2E"):String(k),I=rr(m)?typeof i=="function"?i(A,N):A:A+(d?"."+N:"["+N+"]");y.set(e,E);var z=nv();z.set($h,y),ov(P,r(j,I,i,n,s,o,a,l,i==="comma"&&x&&rr(m)?null:h,u,c,d,f,p,v,x,g,z))}}return P},dS=function(e){if(!e)return Be;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||Be.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=Ls.default;if(typeof e.format<"u"){if(!aS.call(Ls.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var n=Ls.formatters[i],s=Be.filter;(typeof e.filter=="function"||rr(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in sv?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Be.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Be.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Be.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Be.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Be.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Be.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Be.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Be.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Be.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Be.encodeValuesOnly,filter:s,format:i,formatter:n,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Be.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Be.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Be.strictNullHandling}},fS=function(r,e){var t=r,i=dS(e),n,s;typeof i.filter=="function"?(s=i.filter,t=s("",t)):rr(i.filter)&&(s=i.filter,n=s);var o=[];if(typeof t!="object"||t===null)return"";var a=sv[i.arrayFormat],l=a==="comma"&&i.commaRoundTrip;n||(n=Object.keys(t)),i.sort&&n.sort(i.sort);for(var h=nv(),u=0;u<n.length;++u){var c=n[u],d=t[c];i.skipNulls&&d===null||ov(o,cS(d,c,a,l,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,h))}var f=o.join(i.delimiter),p=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},zi=iv,_c=Object.prototype.hasOwnProperty,fm=Array.isArray,Ae={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:zi.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},pS=function(r){return r.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},av=function(r,e,t){if(r&&typeof r=="string"&&e.comma&&r.indexOf(",")>-1)return r.split(",");if(e.throwOnLimitExceeded&&t>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return r},mS="utf8=%26%2310003%3B",gS="utf8=%E2%9C%93",yS=function(e,t){var i={__proto__:null},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;n=n.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=n.split(t.delimiter,t.throwOnLimitExceeded?s+1:s);if(t.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,l,h=t.charset;if(t.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===gS?h="utf-8":o[l]===mS&&(h="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var u=o[l],c=u.indexOf("]="),d=c===-1?u.indexOf("="):c+1,f,p;d===-1?(f=t.decoder(u,Ae.decoder,h,"key"),p=t.strictNullHandling?null:""):(f=t.decoder(u.slice(0,d),Ae.decoder,h,"key"),p=zi.maybeMap(av(u.slice(d+1),t,fm(i[f])?i[f].length:0),function(x){return t.decoder(x,Ae.decoder,h,"value")})),p&&t.interpretNumericEntities&&h==="iso-8859-1"&&(p=pS(String(p))),u.indexOf("[]=")>-1&&(p=fm(p)?[p]:p);var v=_c.call(i,f);v&&t.duplicates==="combine"?i[f]=zi.combine(i[f],p):(!v||t.duplicates==="last")&&(i[f]=p)}return i},vS=function(r,e,t,i){var n=0;if(r.length>0&&r[r.length-1]==="[]"){var s=r.slice(0,-1).join("");n=Array.isArray(e)&&e[s]?e[s].length:0}for(var o=i?e:av(e,t,n),a=r.length-1;a>=0;--a){var l,h=r[a];if(h==="[]"&&t.parseArrays)l=t.allowEmptyArrays&&(o===""||t.strictNullHandling&&o===null)?[]:zi.combine([],o);else{l=t.plainObjects?{__proto__:null}:{};var u=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,c=t.decodeDotInKeys?u.replace(/%2E/g,"."):u,d=parseInt(c,10);!t.parseArrays&&c===""?l={0:o}:!isNaN(d)&&h!==c&&String(d)===c&&d>=0&&t.parseArrays&&d<=t.arrayLimit?(l=[],l[d]=o):c!=="__proto__"&&(l[c]=o)}o=l}return o},xS=function(e,t,i,n){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&o.exec(s),h=l?s.slice(0,l.index):s,u=[];if(h){if(!i.plainObjects&&_c.call(Object.prototype,h)&&!i.allowPrototypes)return;u.push(h)}for(var c=0;i.depth>0&&(l=a.exec(s))!==null&&c<i.depth;){if(c+=1,!i.plainObjects&&_c.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;u.push(l[1])}if(l){if(i.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+i.depth+" and strictDepth is true");u.push("["+s.slice(l.index)+"]")}return vS(u,t,i,n)}},_S=function(e){if(!e)return Ae;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var t=typeof e.charset>"u"?Ae.charset:e.charset,i=typeof e.duplicates>"u"?Ae.duplicates:e.duplicates;if(i!=="combine"&&i!=="first"&&i!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var n=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Ae.allowDots:!!e.allowDots;return{allowDots:n,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ae.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Ae.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Ae.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Ae.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ae.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Ae.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Ae.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Ae.decoder,delimiter:typeof e.delimiter=="string"||zi.isRegExp(e.delimiter)?e.delimiter:Ae.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Ae.depth,duplicates:i,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Ae.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Ae.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Ae.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Ae.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ae.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},wS=function(r,e){var t=_S(e);if(r===""||r===null||typeof r>"u")return t.plainObjects?{__proto__:null}:{};for(var i=typeof r=="string"?yS(r,t):r,n=t.plainObjects?{__proto__:null}:{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=xS(a,i[a],t,typeof r=="string");n=zi.merge(n,l,t)}return t.allowSparse===!0?n:zi.compact(n)},ES=fS,TS=wS,SS=uf,bS={formats:SS,parse:TS,stringify:ES},AS=Aw;function Cr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var CS=/^([a-z0-9.+-]+:)/i,IS=/:[0-9]*$/,RS=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,PS=["<",">",'"',"`"," ","\r",`
`,"	"],MS=["{","}","|","\\","^","`"].concat(PS),wc=["'"].concat(MS),pm=["%","/","?",";","#"].concat(wc),mm=["/","?","#"],kS=255,gm=/^[+a-z0-9A-Z_-]{0,63}$/,DS=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,BS={javascript:!0,"javascript:":!0},Ec={javascript:!0,"javascript:":!0},kn={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Tc=bS;function OS(r,e,t){if(r&&typeof r=="object"&&r instanceof Cr)return r;var i=new Cr;return i.parse(r,e,t),i}Cr.prototype.parse=function(r,e,t){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),n=i!==-1&&i<r.indexOf("#")?"?":"#",s=r.split(n),o=/\\/g;s[0]=s[0].replace(o,"/"),r=s.join(n);var a=r;if(a=a.trim(),!t&&r.split("#").length===1){var l=RS.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=Tc.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=CS.exec(a);if(h){h=h[0];var u=h.toLowerCase();this.protocol=u,a=a.substr(h.length)}if(t||h||a.match(/^\/\/[^@/]+@[^@/]+/)){var c=a.substr(0,2)==="//";c&&!(h&&Ec[h])&&(a=a.substr(2),this.slashes=!0)}if(!Ec[h]&&(c||h&&!kn[h])){for(var d=-1,f=0;f<mm.length;f++){var p=a.indexOf(mm[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var v,x;d===-1?x=a.lastIndexOf("@"):x=a.lastIndexOf("@",d),x!==-1&&(v=a.slice(0,x),a=a.slice(x+1),this.auth=decodeURIComponent(v)),d=-1;for(var f=0;f<pm.length;f++){var p=a.indexOf(pm[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g)for(var y=this.hostname.split(/\./),f=0,m=y.length;f<m;f++){var _=y[f];if(_&&!_.match(gm)){for(var E="",b=0,T=_.length;b<T;b++)_.charCodeAt(b)>127?E+="x":E+=_[b];if(!E.match(gm)){var S=y.slice(0,f),P=y.slice(f+1),R=_.match(DS);R&&(S.push(R[1]),P.unshift(R[2])),P.length&&(a="/"+P.join(".")+a),this.hostname=S.join(".");break}}}this.hostname.length>kS?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=AS.toASCII(this.hostname));var K=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+K,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!BS[u])for(var f=0,m=wc.length;f<m;f++){var A=wc[f];if(a.indexOf(A)!==-1){var D=encodeURIComponent(A);D===A&&(D=escape(A)),a=a.split(A).join(D)}}var k=a.indexOf("#");k!==-1&&(this.hash=a.substr(k),a=a.slice(0,k));var j=a.indexOf("?");if(j!==-1?(this.search=a.substr(j),this.query=a.substr(j+1),e&&(this.query=Tc.parse(this.query)),a=a.slice(0,j)):e&&(this.search="",this.query={}),a&&(this.pathname=a),kn[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var K=this.pathname||"",N=this.search||"";this.path=K+N}return this.href=this.format(),this};Cr.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var e=this.protocol||"",t=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=r+this.host:this.hostname&&(n=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Tc.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||kn[e])&&n!==!1?(n="//"+(n||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+n+t+o+i};Cr.prototype.resolve=function(r){return this.resolveObject(OS(r,!1,!0)).format()};Cr.prototype.resolveObject=function(r){if(typeof r=="string"){var e=new Cr;e.parse(r,!1,!0),r=e}for(var t=new Cr,i=Object.keys(this),n=0;n<i.length;n++){var s=i[n];t[s]=this[s]}if(t.hash=r.hash,r.href==="")return t.href=t.format(),t;if(r.slashes&&!r.protocol){for(var o=Object.keys(r),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(t[l]=r[l])}return kn[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(r.protocol&&r.protocol!==t.protocol){if(!kn[r.protocol]){for(var h=Object.keys(r),u=0;u<h.length;u++){var c=h[u];t[c]=r[c]}return t.href=t.format(),t}if(t.protocol=r.protocol,!r.host&&!Ec[r.protocol]){for(var m=(r.pathname||"").split("/");m.length&&!(r.host=m.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),m[0]!==""&&m.unshift(""),m.length<2&&m.unshift(""),t.pathname=m.join("/")}else t.pathname=r.pathname;if(t.search=r.search,t.query=r.query,t.host=r.host||"",t.auth=r.auth,t.hostname=r.hostname||r.host,t.port=r.port,t.pathname||t.search){var d=t.pathname||"",f=t.search||"";t.path=d+f}return t.slashes=t.slashes||r.slashes,t.href=t.format(),t}var p=t.pathname&&t.pathname.charAt(0)==="/",v=r.host||r.pathname&&r.pathname.charAt(0)==="/",x=v||p||t.host&&r.pathname,g=x,y=t.pathname&&t.pathname.split("/")||[],m=r.pathname&&r.pathname.split("/")||[],_=t.protocol&&!kn[t.protocol];if(_&&(t.hostname="",t.port=null,t.host&&(y[0]===""?y[0]=t.host:y.unshift(t.host)),t.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(m[0]===""?m[0]=r.host:m.unshift(r.host)),r.host=null),x=x&&(m[0]===""||y[0]==="")),v)t.host=r.host||r.host===""?r.host:t.host,t.hostname=r.hostname||r.hostname===""?r.hostname:t.hostname,t.search=r.search,t.query=r.query,y=m;else if(m.length)y||(y=[]),y.pop(),y=y.concat(m),t.search=r.search,t.query=r.query;else if(r.search!=null){if(_){t.host=y.shift(),t.hostname=t.host;var E=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;E&&(t.auth=E.shift(),t.hostname=E.shift(),t.host=t.hostname)}return t.search=r.search,t.query=r.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!y.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var b=y.slice(-1)[0],T=(t.host||r.host||y.length>1)&&(b==="."||b==="..")||b==="",S=0,P=y.length;P>=0;P--)b=y[P],b==="."?y.splice(P,1):b===".."?(y.splice(P,1),S++):S&&(y.splice(P,1),S--);if(!x&&!g)for(;S--;S)y.unshift("..");x&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),T&&y.join("/").substr(-1)!=="/"&&y.push("");var R=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(_){t.hostname=R?"":y.length?y.shift():"",t.host=t.hostname;var E=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;E&&(t.auth=E.shift(),t.hostname=E.shift(),t.host=t.hostname)}return x=x||t.host&&y.length,x&&!R&&y.unshift(""),y.length>0?t.pathname=y.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=r.auth||t.auth,t.slashes=t.slashes||r.slashes,t.href=t.format(),t};Cr.prototype.parseHost=function(){var r=this.host,e=IS.exec(r);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),r=r.substr(0,r.length-e.length)),r&&(this.hostname=r)};const ym={};function te(r,e,t=3){if(ym[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`),console.warn(i))),ym[e]=!0}function kt(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function us(r){return r.split("?")[0].split("#")[0]}function FS(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function NS(r,e,t){return r.replace(new RegExp(FS(e),"g"),t)}function LS(r,e){let t="",i=0,n=-1,s=0,o=-1;for(let a=0;a<=r.length;++a){if(a<r.length)o=r.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),n=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=0,n=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",i=2)}else t.length>0?t+=`/${r.slice(n+1,a)}`:t=r.slice(n+1,a),i=a-n-1;n=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}const He={toPosix(r){return NS(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){kt(r),r=this.toPosix(r);const e=/^file:\/\/\//.exec(r);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(r);return t?t[0]:""},toAbsolute(r,e,t){if(kt(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=us(this.toPosix(e??G.ADAPTER.getBaseUrl())),n=us(this.toPosix(t??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?He.join(n,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(kt(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let e="";const t=r.startsWith("/");this.hasProtocol(r)&&(e=this.rootname(r),r=r.slice(e.length));const i=r.endsWith("/");return r=LS(r,!1),r.length>0&&i&&(r+="/"),t?`/${r}`:e+r},isAbsolute(r){return kt(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const i=r[t];if(kt(i),i.length>0)if(e===void 0)e=i;else{const n=r[t-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(r){if(kt(r),r.length===0)return".";r=this.toPosix(r);let e=r.charCodeAt(0);const t=e===47;let i=-1,n=!0;const s=this.getProtocol(r),o=r;r=r.slice(s.length);for(let a=r.length-1;a>=1;--a)if(e=r.charCodeAt(a),e===47){if(!n){i=a;break}}else n=!1;return i===-1?t?"/":this.isUrl(o)?s+r:s:t&&i===1?"//":s+r.slice(0,i)},rootname(r){kt(r),r=this.toPosix(r);let e="";if(r.startsWith("/")?e="/":e=this.getProtocol(r),this.isUrl(r)){const t=r.indexOf("/",e.length);t!==-1?e=r.slice(0,t):e=r,e.endsWith("/")||(e+="/")}return e},basename(r,e){kt(r),e&&kt(e),r=us(this.toPosix(r));let t=0,i=-1,n=!0,s;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=0;--s){const l=r.charCodeAt(s);if(l===47){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=0;--s)if(r.charCodeAt(s)===47){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){kt(r),r=us(this.toPosix(r));let e=-1,t=0,i=-1,n=!0,s=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===47){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":r.slice(e,i)},parse(r){kt(r);const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;r=us(this.toPosix(r));let t=r.charCodeAt(0);const i=this.isAbsolute(r);let n;e.root=this.rootname(r),i||this.hasProtocol(r)?n=1:n=0;let s=-1,o=0,a=-1,l=!0,h=r.length-1,u=0;for(;h>=n;--h){if(t=r.charCodeAt(h),t===47){if(!l){o=h+1;break}continue}a===-1&&(l=!1,a=h+1),t===46?s===-1?s=h:u!==1&&(u=1):s!==-1&&(u=-1)}return s===-1||a===-1||u===0||u===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&i?e.base=e.name=r.slice(1,a):e.base=e.name=r.slice(o,a)):(o===0&&i?(e.name=r.slice(1,s),e.base=r.slice(1,a)):(e.name=r.slice(o,s),e.base=r.slice(o,a)),e.ext=r.slice(s,a)),e.dir=this.dirname(r),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let Vh;async function US(){return Vh??(Vh=(async()=>{var s;const r=document.createElement("canvas").getContext("webgl");if(!r)return lt.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return lt.UNPACK;const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);const i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,n),r.deleteFramebuffer(i),r.deleteTexture(t),(s=r.getExtension("WEBGL_lose_context"))==null||s.loseContext(),n[0]<=n[3]?lt.PMA:lt.UNPACK})()),Vh}let Wh;function GS(){return typeof Wh>"u"&&(Wh=function(){var e;const r={stencil:!0,failIfMajorPerformanceCaveat:G.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!G.ADAPTER.getWebGLRenderingContext())return!1;const t=G.ADAPTER.createCanvas();let i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r);const n=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,n}catch{return!1}}()),Wh}var zS={grad:.9,turn:360,rad:360/(2*Math.PI)},gr=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},ze=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t+0},At=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r>e?r:e},lv=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},vm=function(r){return{r:At(r.r,0,255),g:At(r.g,0,255),b:At(r.b,0,255),a:At(r.a)}},Xh=function(r){return{r:ze(r.r),g:ze(r.g),b:ze(r.b),a:ze(r.a,3)}},jS=/^#([0-9a-f]{3,8})$/i,Vo=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},hv=function(r){var e=r.r,t=r.g,i=r.b,n=r.a,s=Math.max(e,t,i),o=s-Math.min(e,t,i),a=o?s===e?(t-i)/o:s===t?2+(i-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:n}},uv=function(r){var e=r.h,t=r.s,i=r.v,n=r.a;e=e/360*6,t/=100,i/=100;var s=Math.floor(e),o=i*(1-t),a=i*(1-(e-s)*t),l=i*(1-(1-e+s)*t),h=s%6;return{r:255*[i,a,o,o,l,i][h],g:255*[l,i,i,a,o,o][h],b:255*[o,o,l,i,i,a][h],a:n}},xm=function(r){return{h:lv(r.h),s:At(r.s,0,100),l:At(r.l,0,100),a:At(r.a)}},_m=function(r){return{h:ze(r.h),s:ze(r.s),l:ze(r.l),a:ze(r.a,3)}},wm=function(r){return uv((t=(e=r).s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}));var e,t,i},Us=function(r){return{h:(e=hv(r)).h,s:(n=(200-(t=e.s))*(i=e.v)/100)>0&&n<200?t*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a};var e,t,i,n},HS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$S=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,VS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,WS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Sc={string:[[function(r){var e=jS.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?ze(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?ze(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=VS.exec(r)||WS.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:vm({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=HS.exec(r)||$S.exec(r);if(!e)return null;var t,i,n=xm({h:(t=e[1],i=e[2],i===void 0&&(i="deg"),Number(t)*(zS[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return wm(n)},"hsl"]],object:[[function(r){var e=r.r,t=r.g,i=r.b,n=r.a,s=n===void 0?1:n;return gr(e)&&gr(t)&&gr(i)?vm({r:Number(e),g:Number(t),b:Number(i),a:Number(s)}):null},"rgb"],[function(r){var e=r.h,t=r.s,i=r.l,n=r.a,s=n===void 0?1:n;if(!gr(e)||!gr(t)||!gr(i))return null;var o=xm({h:Number(e),s:Number(t),l:Number(i),a:Number(s)});return wm(o)},"hsl"],[function(r){var e=r.h,t=r.s,i=r.v,n=r.a,s=n===void 0?1:n;if(!gr(e)||!gr(t)||!gr(i))return null;var o=function(a){return{h:lv(a.h),s:At(a.s,0,100),v:At(a.v,0,100),a:At(a.a)}}({h:Number(e),s:Number(t),v:Number(i),a:Number(s)});return uv(o)},"hsv"]]},Em=function(r,e){for(var t=0;t<e.length;t++){var i=e[t][0](r);if(i)return[i,e[t][1]]}return[null,void 0]},XS=function(r){return typeof r=="string"?Em(r.trim(),Sc.string):typeof r=="object"&&r!==null?Em(r,Sc.object):[null,void 0]},Yh=function(r,e){var t=Us(r);return{h:t.h,s:At(t.s+100*e,0,100),l:t.l,a:t.a}},Kh=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Tm=function(r,e){var t=Us(r);return{h:t.h,s:t.s,l:At(t.l+100*e,0,100),a:t.a}},bc=function(){function r(e){this.parsed=XS(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return ze(Kh(this.rgba),2)},r.prototype.isDark=function(){return Kh(this.rgba)<.5},r.prototype.isLight=function(){return Kh(this.rgba)>=.5},r.prototype.toHex=function(){return e=Xh(this.rgba),t=e.r,i=e.g,n=e.b,o=(s=e.a)<1?Vo(ze(255*s)):"","#"+Vo(t)+Vo(i)+Vo(n)+o;var e,t,i,n,s,o},r.prototype.toRgb=function(){return Xh(this.rgba)},r.prototype.toRgbString=function(){return e=Xh(this.rgba),t=e.r,i=e.g,n=e.b,(s=e.a)<1?"rgba("+t+", "+i+", "+n+", "+s+")":"rgb("+t+", "+i+", "+n+")";var e,t,i,n,s},r.prototype.toHsl=function(){return _m(Us(this.rgba))},r.prototype.toHslString=function(){return e=_m(Us(this.rgba)),t=e.h,i=e.s,n=e.l,(s=e.a)<1?"hsla("+t+", "+i+"%, "+n+"%, "+s+")":"hsl("+t+", "+i+"%, "+n+"%)";var e,t,i,n,s},r.prototype.toHsv=function(){return e=hv(this.rgba),{h:ze(e.h),s:ze(e.s),v:ze(e.v),a:ze(e.a,3)};var e},r.prototype.invert=function(){return qt({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),qt(Yh(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),qt(Yh(this.rgba,-e))},r.prototype.grayscale=function(){return qt(Yh(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),qt(Tm(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),qt(Tm(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?qt({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):ze(this.rgba.a,3);var t},r.prototype.hue=function(e){var t=Us(this.rgba);return typeof e=="number"?qt({h:e,s:t.s,l:t.l,a:t.a}):ze(t.h)},r.prototype.isEqual=function(e){return this.toHex()===qt(e).toHex()},r}(),qt=function(r){return r instanceof bc?r:new bc(r)},Sm=[],YS=function(r){r.forEach(function(e){Sm.indexOf(e)<0&&(e(bc,Sc),Sm.push(e))})};function KS(r,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in t)i[t[n]]=n;var s={};r.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,h=i[this.toHex()];if(h)return h;if(o!=null&&o.closest){var u=this.toRgb(),c=1/0,d="black";if(!s.length)for(var f in t)s[f]=new r(t[f]).toRgb();for(var p in t){var v=(a=u,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));v<c&&(c=v,d=p)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":t[a];return l?new r(l).toRgb():null},"name"])}YS([KS]);const rn=class Aa{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Aa)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((n,s)=>n===t[s]);if(e!==null&&t!==null){const n=Object.keys(e),s=Object.keys(t);return n.length!==s.length?!1:n.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,i,n]=this._components;return{r:e,g:t,b:i,a:n}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,n]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(i*255),e[2]=Math.round(n*255),e}toRgbArray(e){e=e??[];const[t,i,n]=this._components;return e[0]=t,e[1]=i,e[2]=n,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,i,n,s]=Aa.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=n,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,s=this._int&255;return t&&(i=i*e+.5|0,n=n*e+.5|0,s=s*e+.5|0),(e*255<<24)+(i<<16)+(n<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,i,n]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(i*e)/e,this._components[2]=Math.round(n*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,i,n,s]=this._components;return e[0]=t,e[1]=i,e[2]=n,e[3]=s,e}normalize(e){let t,i,n,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;t=(o>>16&255)/255,i=(o>>8&255)/255,n=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,n,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,n,s=255]=e,t/=255,i/=255,n/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=Aa.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=qt(e);o.isValid()&&({r:t,g:i,b:n,a:s}=o.rgba,t/=255,i/=255,n/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=i,this._components[2]=n,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(e*255<<16)+(t*255<<8)+(i*255|0)}_clamp(e,t=0,i=1){return typeof e=="number"?Math.min(Math.max(e,t),i):(e.forEach((n,s)=>{e[s]=Math.min(Math.max(n,t),i)}),e)}};rn.shared=new rn,rn.temp=new rn,rn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let de=rn;function qS(r){return te("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),de.shared.setValue(r).toHex()}function ZS(r){return te("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),de.shared.setValue(r).toNumber()}function QS(){const r=[],e=[];for(let i=0;i<32;i++)r[i]=i,e[i]=i;r[Z.NORMAL_NPM]=Z.NORMAL,r[Z.ADD_NPM]=Z.ADD,r[Z.SCREEN_NPM]=Z.SCREEN,e[Z.NORMAL]=Z.NORMAL_NPM,e[Z.ADD]=Z.ADD_NPM,e[Z.SCREEN]=Z.SCREEN_NPM;const t=[];return t.push(e),t.push(r),t}const cv=QS();function dv(r,e){return cv[e?1:0][r]}function JS(r,e=null){const t=r*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${t}`);for(let i=0,n=0;i<t;i+=6,n+=4)e[i+0]=n+0,e[i+1]=n+1,e[i+2]=n+2,e[i+3]=n+0,e[i+4]=n+2,e[i+5]=n+3;return e}function fv(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function hl(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function bm(r){return!(r&r-1)&&!!r}function Am(r){let e=(r>65535?1:0)<<4;r>>>=e;let t=(r>255?1:0)<<3;return r>>>=t,e|=t,t=(r>15?1:0)<<2,r>>>=t,e|=t,t=(r>3?1:0)<<1,r>>>=t,e|=t,e|r>>1}function Dn(r,e,t){const i=r.length;let n;if(e>=i||t===0)return;t=e+t>i?i-e:t;const s=i-t;for(n=e;n<s;++n)r[n]=r[n+t];r.length=s}function Yr(r){return r===0?0:r<0?-1:1}let eb=0;function ji(){return++eb}const Ac=class{constructor(r,e,t,i){this.left=r,this.top=e,this.right=t,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Ac.EMPTY=new Ac(0,0,0,0);let Cm=Ac;const Im={},Zt=Object.create(null),Fr=Object.create(null);class tb{constructor(e,t,i){this._canvas=G.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||G.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Rm(r,e,t){for(let i=0,n=4*t*e;i<e;++i,n+=4)if(r[n+3]!==0)return!1;return!0}function Pm(r,e,t,i,n){const s=4*e;for(let o=i,a=i*s+4*t;o<=n;++o,a+=s)if(r[a+3]!==0)return!1;return!0}function rb(r){const{width:e,height:t}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const n=i.getImageData(0,0,e,t).data;let s=0,o=0,a=e-1,l=t-1;for(;o<t&&Rm(n,e,o);)++o;if(o===t)return Cm.EMPTY;for(;Rm(n,e,l);)--l;for(;Pm(n,e,s,o,l);)++s;for(;Pm(n,e,a,o,l);)--a;return++a,++l,new Cm(s,o,a,l)}function ib(r){const e=rb(r),{width:t,height:i}=e;let n=null;if(!e.isEmpty()){const s=r.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");n=s.getImageData(e.left,e.top,t,i)}return{width:t,height:i,data:n}}function nb(r,e=globalThis.location){if(r.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(r,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}function kr(r,e=1){var i;const t=(i=G.RETINA_PREFIX)==null?void 0:i.exec(r);return t?parseFloat(t[1]):e}var L=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(L||{});const Cc=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},Mm=(r,e)=>Cc(r).priority??e,W={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(Cc).forEach(e=>{e.type.forEach(t=>{var i,n;return(n=(i=this._removeHandlers)[t])==null?void 0:n.call(i,e)})}),this},add(...r){return r.map(Cc).forEach(e=>{e.type.forEach(t=>{var s,o;const i=this._addHandlers,n=this._queue;i[t]?(s=i[t])==null||s.call(i,e):(n[t]=n[t]||[],(o=n[t])==null||o.push(e))})}),this},handle(r,e,t){var o;const i=this._addHandlers,n=this._removeHandlers;if(i[r]||n[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=e,n[r]=t;const s=this._queue;return s[r]&&((o=s[r])==null||o.forEach(a=>e(a)),delete s[r]),this},handleByMap(r,e){return this.handle(r,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByList(r,e,t=-1){return this.handle(r,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((n,s)=>Mm(s,t)-Mm(n,t)))},i=>{const n=e.indexOf(i.ref);n!==-1&&e.splice(n,1)})}};class Ic{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const sb=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ob(r){let e="";for(let t=0;t<r;++t)t>0&&(e+=`
else `),t<r-1&&(e+=`if(test == ${t}.0){}`);return e}function ab(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);for(;;){const i=sb.replace(/%forloop%/gi,ob(r));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))r=r/2|0;else break}return r}const qh=0,Zh=1,Qh=2,Jh=3,eu=4,tu=5;class pr{constructor(){this.data=0,this.blendMode=Z.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<qh)}set blend(e){!!(this.data&1<<qh)!==e&&(this.data^=1<<qh)}get offsets(){return!!(this.data&1<<Zh)}set offsets(e){!!(this.data&1<<Zh)!==e&&(this.data^=1<<Zh)}get culling(){return!!(this.data&1<<Qh)}set culling(e){!!(this.data&1<<Qh)!==e&&(this.data^=1<<Qh)}get depthTest(){return!!(this.data&1<<Jh)}set depthTest(e){!!(this.data&1<<Jh)!==e&&(this.data^=1<<Jh)}get depthMask(){return!!(this.data&1<<tu)}set depthMask(e){!!(this.data&1<<tu)!==e&&(this.data^=1<<tu)}get clockwiseFrontFace(){return!!(this.data&1<<eu)}set clockwiseFrontFace(e){!!(this.data&1<<eu)!==e&&(this.data^=1<<eu)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==Z.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new pr;return e.depthTest=!1,e.blend=!0,e}}pr.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Rc=[];function pv(r,e){if(!r)return null;let t="";if(typeof r=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(t=i[1].toLowerCase())}for(let i=Rc.length-1;i>=0;--i){const n=Rc[i];if(n.test&&n.test(r,t))return new n(r,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class jt{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,i,n,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:u}=this;this._aliasCount++;for(let c=0,d=u.length;c<d;c++)u[c][h](e,t,i,n,s,o,a,l);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(jt.prototype,{dispatch:{value:jt.prototype.emit},run:{value:jt.prototype.emit}});class ao{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new jt("setRealSize"),this.onUpdate=new jt("update"),this.onError=new jt("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class Vl extends ao{constructor(e,t){const{width:i,height:n}=t||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,i){const n=e.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,this.unpackAlignment),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===lt.UNPACK);const s=t.realWidth,o=t.realHeight;return i.width===s&&i.height===o?n.texSubImage2D(t.target,0,0,0,s,o,t.format,i.type,this.data):(i.width=s,i.height=o,n.texImage2D(t.target,0,i.internalFormat,s,o,0,t.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const lb={scaleMode:Er.NEAREST,alphaMode:lt.NPM},Pc=class nn extends go{constructor(e=null,t=null){super(),t=Object.assign({},nn.defaultOptions,t);const{alphaMode:i,mipmap:n,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:h,format:u,type:c,target:d,resolution:f,resourceOptions:p}=t;e&&!(e instanceof ao)&&(e=pv(e,p),e.internal=!0),this.resolution=f||G.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=s,this._wrapMode=h,this._scaleMode=o,this.format=u,this.type=c,this.target=d,this.alphaMode=i,this.uid=ji(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,i=!0),i&&this.dirtyStyleId++,this}setSize(e,t,i){return i=i||this.resolution,this.setRealSize(e*i,t*i,i)}setRealSize(e,t,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=bm(this.realWidth)&&bm(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Fr[this.cacheId],delete Zt[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),nn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,i=G.STRICT_TEXTURE_CACHE){const n=typeof e=="string";let s=null;if(n)s=e;else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${ji()}`}s=e._pixiId}let o=Fr[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new nn(e,t),o.cacheId=s,nn.addToCache(o,s)),o}static fromBuffer(e,t,i,n){e=e||new Float32Array(t*i*4);const s=new Vl(e,{width:t,height:i,...n==null?void 0:n.resourceOptions});let o,a;return e instanceof Float32Array?(o=O.RGBA,a=Y.FLOAT):e instanceof Int32Array?(o=O.RGBA_INTEGER,a=Y.INT):e instanceof Uint32Array?(o=O.RGBA_INTEGER,a=Y.UNSIGNED_INT):e instanceof Int16Array?(o=O.RGBA_INTEGER,a=Y.SHORT):e instanceof Uint16Array?(o=O.RGBA_INTEGER,a=Y.UNSIGNED_SHORT):e instanceof Int8Array?(o=O.RGBA,a=Y.BYTE):(o=O.RGBA,a=Y.UNSIGNED_BYTE),s.internal=!0,new nn(s,Object.assign({},lb,{type:a,format:o},n))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Fr[t]&&Fr[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Fr[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=Fr[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete Fr[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete Fr[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};Pc.defaultOptions={mipmap:dr.POW2,anisotropicLevel:0,scaleMode:Er.LINEAR,wrapMode:ni.CLAMP,alphaMode:lt.UNPACK,target:Pn.TEXTURE_2D,format:O.RGBA,type:Y.UNSIGNED_BYTE},Pc._globalBatch=0;let Q=Pc;class Mc{constructor(){this.texArray=null,this.blend=0,this.type=or.TRIANGLES,this.start=0,this.size=0,this.data=null}}let hb=0;class Ie{constructor(e,t=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=t,this.id=hb++,this.disposeRunner=new jt("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?hr.ELEMENT_ARRAY_BUFFER:hr.ARRAY_BUFFER}get index(){return this.type===hr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Ie(e)}}class ul{constructor(e,t=0,i=!1,n=Y.FLOAT,s,o,a,l=1){this.buffer=e,this.size=t,this.normalized=i,this.type=n,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,t,i,n,s){return new ul(e,t,i,n,s)}}const ub={Float32Array,Uint32Array,Int32Array,Uint8Array};function cb(r,e){let t=0,i=0;const n={};for(let l=0;l<r.length;l++)i+=e[l],t+=r[l].length;const s=new ArrayBuffer(t*4);let o=null,a=0;for(let l=0;l<r.length;l++){const h=e[l],u=r[l],c=fv(u);n[c]||(n[c]=new ub[c](s)),o=n[c];for(let d=0;d<u.length;d++){const f=(d/h|0)*i+a,p=d%h;o[f+p]=u[d]}a+=h}return new Float32Array(s)}const km={5126:4,5123:2,5121:1};let db=0;const fb={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class ai{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=db++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new jt("disposeGeometry"),this.refCount=0}addAttribute(e,t,i=0,n=!1,s,o,a,l=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Ie||(t instanceof Array&&(t=new Float32Array(t)),t=new Ie(t));const h=e.split("|");if(h.length>1){for(let c=0;c<h.length;c++)this.addAttribute(h[c],t,i,n,s);return this}let u=this.buffers.indexOf(t);return u===-1&&(this.buffers.push(t),u=this.buffers.length-1),this.attributes[e]=new ul(u,i,n,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Ie||(e instanceof Array&&(e=new Uint16Array(e)),e=new Ie(e)),e.type=hr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],t=[],i=new Ie;let n;for(n in this.attributes){const s=this.attributes[n],o=this.buffers[s.buffer];e.push(o.data),t.push(s.size*km[s.type]/4),s.buffer=0}for(i.data=cb(e,t),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new ai;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new Ie(this.buffers[t].data.slice(0));for(const t in this.attributes){const i=this.attributes[t];e.attributes[t]=new ul(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=hr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new ai,i=[],n=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)n[l]=n[l]||0,n[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new fb[fv(o.buffers[a].data)](n[a]),t.buffers[a]=new Ie(i[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=hr.ELEMENT_ARRAY_BUFFER;let a=0,l=0,h=0,u=0;for(let c=0;c<o.buffers.length;c++)if(o.buffers[c]!==o.indexBuffer){u=c;break}for(const c in o.attributes){const d=o.attributes[c];(d.buffer|0)===u&&(l+=d.size*km[d.type]/4)}for(let c=0;c<e.length;c++){const d=e[c].indexBuffer.data;for(let f=0;f<d.length;f++)t.indexBuffer.data[f+h]+=a;a+=e[c].buffers[u].data.length/l,h+=d.length}}return t}}class mv extends ai{constructor(e=!1){super(),this._buffer=new Ie(null,e,!1),this._indexBuffer=new Ie(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Y.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Y.FLOAT).addAttribute("aColor",this._buffer,4,!0,Y.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Y.FLOAT).addIndex(this._indexBuffer)}}const cl=Math.PI*2,pb=180/Math.PI,mb=Math.PI/180;var Xe=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(Xe||{});class ne{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new ne(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}ne.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Wo=[new ne,new ne,new ne,new ne];class J{constructor(e=0,t=0,i=0,n=0){this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(n),this.type=Xe.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new J(0,0,0,0)}clone(){return new J(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t){const S=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=S)return!1;const P=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>P}const i=this.left,n=this.right,s=this.top,o=this.bottom;if(n<=i||o<=s)return!1;const a=Wo[0].set(e.left,e.top),l=Wo[1].set(e.left,e.bottom),h=Wo[2].set(e.right,e.top),u=Wo[3].set(e.right,e.bottom);if(h.x<=a.x||l.y<=a.y)return!1;const c=Math.sign(t.a*t.d-t.b*t.c);if(c===0||(t.apply(a,a),t.apply(l,l),t.apply(h,h),t.apply(u,u),Math.max(a.x,l.x,h.x,u.x)<=i||Math.min(a.x,l.x,h.x,u.x)>=n||Math.max(a.y,l.y,h.y,u.y)<=s||Math.min(a.y,l.y,h.y,u.y)>=o))return!1;const d=c*(l.y-a.y),f=c*(a.x-l.x),p=d*i+f*s,v=d*n+f*s,x=d*i+f*o,g=d*n+f*o;if(Math.max(p,v,x,g)<=d*a.x+f*a.y||Math.min(p,v,x,g)>=d*u.x+f*u.y)return!1;const y=c*(a.y-h.y),m=c*(h.x-a.x),_=y*i+m*s,E=y*n+m*s,b=y*i+m*o,T=y*n+m*o;return!(Math.max(_,E,b,T)<=y*a.x+m*a.y||Math.min(_,E,b,T)>=y*u.x+m*u.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=n,this.height=Math.max(s-n,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=n-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=n,this.height=s-n,this}}J.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Wl{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.radius=i,this.type=Xe.CIRC}clone(){return new Wl(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-e,s=this.y-t;return n*=n,s*=s,n+s<=i}getBounds(){return new J(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Wl.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Xl{constructor(e=0,t=0,i=0,n=0){this.x=e,this.y=t,this.width=i,this.height=n,this.type=Xe.ELIP}clone(){return new Xl(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,n=(t-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new J(this.x-this.width,this.y-this.height,this.width,this.height)}}Xl.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class ki{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const i=[];for(let n=0,s=t.length;n<s;n++)i.push(t[n].x,t[n].y);t=i}this.points=t,this.type=Xe.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new ki(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let i=!1;const n=this.points.length/2;for(let s=0,o=n-1;s<n;o=s++){const a=this.points[s*2],l=this.points[s*2+1],h=this.points[o*2],u=this.points[o*2+1];l>t!=u>t&&e<(h-a)*((t-l)/(u-l))+a&&(i=!i)}return i}}ki.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((r,e)=>`${r}, ${e}`,"")}]`};class Yl{constructor(e=0,t=0,i=0,n=0,s=20){this.x=e,this.y=t,this.width=i,this.height=n,this.radius=s,this.type=Xe.RREC}clone(){return new Yl(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let n=e-(this.x+i),s=t-(this.y+i);const o=i*i;if(n*n+s*s<=o||(n=e-(this.x+this.width-i),n*n+s*s<=o)||(s=t-(this.y+this.height-i),n*n+s*s<=o)||(n=e-(this.x+i),n*n+s*s<=o))return!0}return!1}}Yl.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class pe{constructor(e=1,t=0,i=0,n=1,s=0,o=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,n,s,o){return this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new ne;const i=e.x,n=e.y;return t.x=this.a*i+this.c*n+this.tx,t.y=this.b*i+this.d*n+this.ty,t}applyInverse(e,t){t=t||new ne;const i=1/(this.a*this.d+this.c*-this.b),n=e.x,s=e.y;return t.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,t.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),n=this.a,s=this.c,o=this.tx;return this.a=n*t-this.b*i,this.b=n*i+this.b*t,this.c=s*t-this.d*i,this.d=s*i+this.d*t,this.tx=o*t-this.ty*i,this.ty=o*i+this.ty*t,this}append(e){const t=this.a,i=this.b,n=this.c,s=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*n,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this}setTransform(e,t,i,n,s,o,a,l,h){return this.a=Math.cos(a+h)*s,this.b=Math.sin(a+h)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+n*this.c),this.ty=t-(i*this.b+n*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,n=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-n,s),l=Math.atan2(i,t),h=Math.abs(a+l);return h<1e-5||Math.abs(cl-h)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(n*n+s*s),e.position.x=this.tx+(o.x*t+o.y*n),e.position.y=this.ty+(o.x*i+o.y*s),e}invert(){const e=this.a,t=this.b,i=this.c,n=this.d,s=this.tx,o=e*n-t*i;return this.a=n/o,this.b=-t/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-n*s)/o,this.ty=-(e*this.ty-t*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new pe;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new pe}static get TEMP_MATRIX(){return new pe}}pe.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const yi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],vi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],xi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],_i=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],kc=[],gv=[],Xo=Math.sign;function gb(){for(let r=0;r<16;r++){const e=[];kc.push(e);for(let t=0;t<16;t++){const i=Xo(yi[r]*yi[t]+xi[r]*vi[t]),n=Xo(vi[r]*yi[t]+_i[r]*vi[t]),s=Xo(yi[r]*xi[t]+xi[r]*_i[t]),o=Xo(vi[r]*xi[t]+_i[r]*_i[t]);for(let a=0;a<16;a++)if(yi[a]===i&&vi[a]===n&&xi[a]===s&&_i[a]===o){e.push(a);break}}}for(let r=0;r<16;r++){const e=new pe;e.set(yi[r],vi[r],xi[r],_i[r],0,0),gv.push(e)}}gb();const xe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>yi[r],uY:r=>vi[r],vX:r=>xi[r],vY:r=>_i[r],inv:r=>r&8?r&15:-r&7,add:(r,e)=>kc[r][e],sub:(r,e)=>kc[r][xe.inv(e)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,e)=>Math.abs(r)*2<=Math.abs(e)?e>=0?xe.S:xe.N:Math.abs(e)*2<=Math.abs(r)?r>0?xe.E:xe.W:e>0?r>0?xe.SE:xe.SW:r>0?xe.NE:xe.NW,matrixAppendRotationInv:(r,e,t=0,i=0)=>{const n=gv[xe.inv(e)];n.tx=t,n.ty=i,r.append(n)}};class Sr{constructor(e,t,i=0,n=0){this._x=i,this._y=n,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new Sr(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Sr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Dc=class{constructor(){this.worldTransform=new pe,this.localTransform=new pe,this.position=new Sr(this.onChange,this,0,0),this.scale=new Sr(this.onChange,this,1,1),this.pivot=new Sr(this.onChange,this,0,0),this.skew=new Sr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const t=r.worldTransform,i=this.worldTransform;i.a=e.a*t.a+e.b*t.c,i.b=e.a*t.b+e.b*t.d,i.c=e.c*t.a+e.d*t.c,i.d=e.c*t.b+e.d*t.d,i.tx=e.tx*t.a+e.ty*t.c+t.tx,i.ty=e.tx*t.b+e.ty*t.d+t.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};Dc.IDENTITY=new Dc;let cf=Dc;cf.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var yb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,vb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Dm(r,e,t){const i=r.createShader(e);return r.shaderSource(i,t),r.compileShader(i),i}function ru(r){const e=new Array(r);for(let t=0;t<e.length;t++)e[t]=!1;return e}function yv(r,e){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return ru(2*e);case"bvec3":return ru(3*e);case"bvec4":return ru(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Bn=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,e)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(e==null||e.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,e)=>r.type==="mat3"&&r.size===1&&!r.isArray&&e.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,e)=>r.type==="vec2"&&r.size===1&&!r.isArray&&e.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,e)=>r.type==="vec4"&&r.size===1&&!r.isArray&&e.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,e)=>r.type==="vec4"&&r.size===1&&!r.isArray&&e.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,e)=>r.type==="vec3"&&r.size===1&&!r.isArray&&e.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],xb={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},_b={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function wb(r,e){var i;const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const n in r.uniforms){const s=e[n];if(!s){((i=r.uniforms[n])==null?void 0:i.group)===!0&&(r.uniforms[n].ubo?t.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${n}, '${n}');
                    `):t.push(`
                        renderer.shader.syncUniformGroup(uv.${n}, syncData);
                    `));continue}const o=r.uniforms[n];let a=!1;for(let l=0;l<Bn.length;l++)if(Bn[l].test(s,o)){t.push(Bn[l].code(n,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?xb:_b)[s.type].replace("location",`ud["${n}"].location`);t.push(`
            cu = ud["${n}"];
            cv = cu.value;
            v = uv["${n}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}const vv={};let Ji=vv;function Eb(){if(Ji===vv||Ji!=null&&Ji.isContextLost()){const r=G.ADAPTER.createCanvas();let e;G.PREFER_ENV>=Wi.WEBGL2&&(e=r.getContext("webgl2",{})),e||(e=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Ji=e}return Ji}let Yo;function Tb(){if(!Yo){Yo=bt.MEDIUM;const r=Eb();if(r&&r.getShaderPrecisionFormat){const e=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);e&&(Yo=e.precision?bt.HIGH:bt.MEDIUM)}}return Yo}function Bm(r,e){const t=r.getShaderSource(e).split(`
`).map((h,u)=>`${u}: ${h}`),i=r.getShaderInfoLog(e),n=i.split(`
`),s={},o=n.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!s[h]?(s[h]=!0,!0):!1),a=[""];o.forEach(h=>{t[h-1]=`%c${t[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=t.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Sb(r,e,t,i){r.getProgramParameter(e,r.LINK_STATUS)||(r.getShaderParameter(t,r.COMPILE_STATUS)||Bm(r,t),r.getShaderParameter(i,r.COMPILE_STATUS)||Bm(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(e)))}const bb={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function xv(r){return bb[r]}let Ko=null;const Om={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function _v(r,e){if(!Ko){const t=Object.keys(Om);Ko={};for(let i=0;i<t.length;++i){const n=t[i];Ko[r[n]]=Om[n]}}return Ko[e]}function Fm(r,e,t){if(r.substring(0,9)!=="precision"){let i=e;return e===bt.HIGH&&t!==bt.HIGH&&(i=bt.MEDIUM),`precision ${i} float;
${r}`}else if(t!==bt.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let cs;function Ab(){if(typeof cs=="boolean")return cs;try{cs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{cs=!1}return cs}let Cb=0;const qo={},Bc=class sn{constructor(e,t,i="pixi-shader",n={}){this.extra={},this.id=Cb++,this.vertexSrc=e||sn.defaultVertexSrc,this.fragmentSrc=t||sn.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),qo[i]?(qo[i]++,i+=`-${qo[i]}`):qo[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=Fm(this.vertexSrc,sn.defaultVertexPrecision,bt.HIGH),this.fragmentSrc=Fm(this.fragmentSrc,sn.defaultFragmentPrecision,Tb())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return vb}static get defaultFragmentSrc(){return yb}static from(e,t,i){const n=e+t;let s=Im[n];return s||(Im[n]=s=new sn(e,t,i)),s}};Bc.defaultVertexPrecision=bt.HIGH,Bc.defaultFragmentPrecision=Tr.apple.device?bt.HIGH:bt.MEDIUM;let br=Bc,Ib=0;class Ht{constructor(e,t,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Ib++,this.static=!!t,this.ubo=!!i,e instanceof Ie?(this.buffer=e,this.buffer.type=hr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Ie(new Float32Array(1)),this.buffer.type=hr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,i){if(!this.ubo)this.uniforms[e]=new Ht(t,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,t,i){return new Ht(e,t,i)}static uboFrom(e,t){return new Ht(e,t??!0,!0)}}class ur{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof Ht?this.uniformGroup=t:this.uniformGroup=new Ht(t):this.uniformGroup=new Ht({}),this.disposeRunner=new jt("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const i in t.uniforms){const n=t.uniforms[i];if(n.group===!0&&this.checkUniformExists(e,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,i){const n=br.from(e,t);return new ur(n,i)}}class Rb{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const i=new Int32Array(e);for(let s=0;s<e;s++)i[s]=s;this.defaultGroupCache[e]=Ht.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${e}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new br(this.vertexSrc,n)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new pe,default:this.defaultGroupCache[e]};return new ur(this.programCache[e],t)}generateSampleSrc(e){let t="";t+=`
`,t+=`
`;for(let i=0;i<e;i++)i>0&&(t+=`
else `),i<e-1&&(t+=`if(vTextureId < ${i}.5)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,t+=`
}`;return t+=`
`,t+=`
`,t}}class Oc{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function Pb(){return!Tr.apple.device}function Mb(r){let e=!0;const t=G.ADAPTER.getNavigator();if(Tr.tablet||Tr.phone){if(Tr.apple.device){const i=t.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(e=!1)}if(Tr.android.device){const i=t.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(e=!1)}}return e?r:4}class Kl{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var kb=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Db=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const vs=class Bt extends Kl{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=mv,this.vertexSize=6,this.state=pr.for2d(),this.size=Bt.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Mb(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Pb(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return te("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Db}static get defaultFragmentTemplate(){return kb}setShaderGenerator({vertex:e=Bt.defaultVertexSrc,fragment:t=Bt.defaultFragmentTemplate}={}){this.shaderGenerator=new Rb(e,t)}contextChange(){const e=this.renderer.gl;G.PREFER_ENV===Wi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Bt.defaultMaxTextures),this.maxTextures=ab(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=Bt,i=this.size/4,n=Math.floor(i/this.maxTextures)+1;for(;e.length<i;)e.push(new Mc);for(;t.length<n;)t.push(new Oc);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,i=Bt._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++Q._globalBatch,l=0,h=i[0],u=0;n.copyBoundTextures(s,t);for(let c=0;c<this._bufferSize;++c){const d=e[c];e[c]=null,d._batchEnabled!==a&&(h.count>=t&&(n.boundArray(h,s,a,t),this.buildDrawCalls(h,u,c),u=c,h=i[++l],++a),d._batchEnabled=a,d.touched=o,h.elements[h.count++]=d)}h.count>0&&(n.boundArray(h,s,a,t),this.buildDrawCalls(h,u,this._bufferSize),++l,++a);for(let c=0;c<s.length;c++)s[c]=null;Q._globalBatch=a}buildDrawCalls(e,t,i){const{_bufferedElements:n,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=Bt._drawCallPool;let h=this._dcIndex,u=this._aIndex,c=this._iIndex,d=l[h];d.start=this._iIndex,d.texArray=e;for(let f=t;f<i;++f){const p=n[f],v=p._texture.baseTexture,x=cv[v.alphaMode?1:0][p.blendMode];n[f]=null,t<f&&d.blend!==x&&(d.size=c-d.start,t=f,d=l[++h],d.texArray=e,d.start=c),this.packInterleavedGeometry(p,s,o,u,c),u+=p.vertexData.length/2*a,c+=p.indices.length,d.blend=x}t<i&&(d.size=c-d.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(e){const t=this.renderer.texture;for(let i=0;i<e.count;i++)t.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:i}=this;Bt.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:i}=this.renderer,n=Bt._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:h,start:u,blend:c}=n[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=c,i.set(this.state),t.drawElements(l,h,t.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Bt.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=hl(Math.ceil(e/8)),i=Am(t),n=t*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._aBuffers[n];return s||(this._aBuffers[n]=s=new Ic(n*this.vertexSize*4)),s}getIndexBuffer(e){const t=hl(Math.ceil(e/12)),i=Am(t),n=t*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(n)),s}packInterleavedGeometry(e,t,i,n,s){const{uint32View:o,float32View:a}=t,l=n/this.vertexSize,h=e.uvs,u=e.indices,c=e.vertexData,d=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=de.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let v=0;v<c.length;v+=2)a[n++]=c[v],a[n++]=c[v+1],a[n++]=h[v],a[n++]=h[v+1],o[n++]=p,a[n++]=d;for(let v=0;v<u.length;v++)i[s++]=l+u[v]}};vs.defaultBatchSize=4096,vs.extension={name:"batch",type:L.RendererPlugin},vs._drawCallPool=[],vs._textureArrayPool=[];let wi=vs;W.add(wi);var Bb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Ob=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Fc=class xs extends ur{constructor(e,t,i){const n=br.from(e||xs.defaultVertexSrc,t||xs.defaultFragmentSrc);super(n,i),this.padding=0,this.resolution=xs.defaultResolution,this.multisample=xs.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new pr}apply(e,t,i,n,s){e.applyFilter(this,t,i,n)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Ob}static get defaultFragmentSrc(){return Bb}};Fc.defaultResolution=1,Fc.defaultMultisample=Me.NONE;let rt=Fc;class dl{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new de(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:t,background:i,backgroundAlpha:n}=e,s=i??t;s!==void 0&&(this.color=s),this.alpha=n}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}dl.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},dl.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"background"};W.add(dl);class wv{constructor(e){this.renderer=e,this.emptyRenderer=new Kl(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:i}=this.renderer.texture;for(let n=t-1;n>=0;--n)e[n]=i[n]||null,e[n]&&(e[n]._batchLocation=n)}boundArray(e,t,i,n){const{elements:s,ids:o,count:a}=e;let l=0;for(let h=0;h<a;h++){const u=s[h],c=u._batchLocation;if(c>=0&&c<n&&t[c]===u){o[h]=c;continue}for(;l<n;){const d=t[l];if(d&&d._batchEnabled===i&&d._batchLocation===l){l++;continue}o[h]=l,u._batchLocation=l,t[l]=u;break}}}destroy(){this.renderer=null}}wv.extension={type:L.RendererSystem,name:"batch"};W.add(wv);let Nm=0;class fl{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Nm++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Nm++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;t.addEventListener!==void 0&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let i;if(G.PREFER_ENV>=Wi.WEBGL2&&(i=e.getContext("webgl2",t)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}fl.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},fl.extension={type:L.RendererSystem,name:"context"};W.add(fl);class Nc{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new jt("disposeFramebuffer"),this.multisample=Me.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new Q(null,{scaleMode:Er.NEAREST,resolution:1,mipmap:dr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new Q(null,{scaleMode:Er.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:dr.OFF,format:O.DEPTH_COMPONENT,type:Y.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const n=this.colorTextures[i],s=n.resolution;n.setSize(e/s,t/s)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,t/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Ev extends Q{constructor(e={}){if(typeof e=="number"){const t=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];e={width:t,height:i,scaleMode:n,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=Me.NONE),super(null,e),this.mipmap=dr.OFF,this.valid=!0,this._clear=new de([0,0,0,0]),this.framebuffer=new Nc(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Dr extends ao{constructor(e){const t=e,i=t.naturalWidth||t.videoWidth||t.displayWidth||t.width,n=t.naturalHeight||t.videoHeight||t.displayHeight||t.height;super(i,n),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,i){i===void 0&&!t.startsWith("data:")?e.crossOrigin=nb(t):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")}upload(e,t,i,n){const s=e.gl,o=t.realWidth,a=t.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===lt.UNPACK),!this.noSubImage&&t.target===s.TEXTURE_2D&&i.width===o&&i.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,t.format,i.type,n):(i.width=o,i.height=a,s.texImage2D(t.target,0,i.internalFormat,t.format,i.type,n)),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(t,i),super.update()}dispose(){this.source=null}}class Tv extends Dr{constructor(e,t){if(t=t||{},typeof e=="string"){const i=new Image;Dr.crossOrigin(i,e,t.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??G.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.bitmap=null,this._load=null,t.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((t,i)=>{const n=this.source;this.url=n.src;const s=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.update(),this._load=null,this.createBitmap?t(this.process()):t(this))};n.complete&&n.src?s():(n.onload=s,n.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,i=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>t(n,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===lt.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,t,i){if(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,i,this.bitmap),!this.preserveBitmap){let n=!0;const s=t._glTextures;for(const o in s){const a=s[o];if(a!==i&&a.dirtyId!==t.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class df{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,i){const n=t.width,s=t.height;if(i){const o=e.width/2/n,a=e.height/2/s,l=e.x/n+o,h=e.y/s+a;i=xe.add(i,xe.NW),this.x0=l+o*xe.uX(i),this.y0=h+a*xe.uY(i),i=xe.add(i,2),this.x1=l+o*xe.uX(i),this.y1=h+a*xe.uY(i),i=xe.add(i,2),this.x2=l+o*xe.uX(i),this.y2=h+a*xe.uY(i),i=xe.add(i,2),this.x3=l+o*xe.uX(i),this.y3=h+a*xe.uY(i)}else this.x0=e.x/n,this.y0=e.y/s,this.x1=(e.x+e.width)/n,this.y1=e.y/s,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/s,this.x3=e.x/n,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}df.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Lm=new df;function Zo(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class $ extends go{constructor(e,t,i,n,s,o,a){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new J(0,0,1,1)),e instanceof $&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=n,this.valid=!1,this.destroyed=!1,this._uvs=Lm,this.uvMatrix=null,this.orig=i||t,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new ne(o.x,o.y):new ne(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:t}=this.baseTexture;t!=null&&t.url&&Zt[t.url]&&$.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,$.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var n;const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),i=new $(this.baseTexture,!this.noFrame&&e,t,(n=this.trim)==null?void 0:n.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===Lm&&(this._uvs=new df),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},i=G.STRICT_TEXTURE_CACHE){const n=typeof e=="string";let s=null;if(n)s=e;else if(e instanceof Q){if(!e.cacheId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${ji()}`,Q.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${ji()}`}s=e._pixiId}let o=Zt[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof Q)?(t.resolution||(t.resolution=kr(e)),o=new $(new Q(e,t)),o.baseTexture.cacheId=s,Q.addToCache(o.baseTexture,s),$.addToCache(o,s)):!o&&e instanceof Q&&(o=new $(e),$.addToCache(o,s)),o}static fromURL(e,t){const i=Object.assign({autoLoad:!1},t==null?void 0:t.resourceOptions),n=$.from(e,Object.assign({resourceOptions:i},t),!1),s=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):s.load().then(()=>Promise.resolve(n))}static fromBuffer(e,t,i,n){return new $(Q.fromBuffer(e,t,i,n))}static fromLoader(e,t,i,n){const s=new Q(e,Object.assign({scaleMode:Q.defaultOptions.scaleMode,resolution:kr(t)},n)),{resource:o}=s;o instanceof Tv&&(o.url=t);const a=new $(s);return i||(i=t),Q.addToCache(a.baseTexture,i),$.addToCache(a,i),i!==t&&(Q.addToCache(a.baseTexture,t),$.addToCache(a,t)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Zt[t]&&Zt[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),Zt[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=Zt[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete Zt[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)Zt[e.textureCacheIds[t]]===e&&delete Zt[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:i,width:n,height:s}=e,o=t+n>this.baseTexture.width,a=i+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",h=`X: ${t} + ${n} = ${t+n} > ${this.baseTexture.width}`,u=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${l} ${u}`)}this.valid=n&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return $._EMPTY||($._EMPTY=new $(new Q),Zo($._EMPTY),Zo($._EMPTY.baseTexture)),$._EMPTY}static get WHITE(){if(!$._WHITE){const e=G.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),$._WHITE=new $(Q.from(e)),Zo($._WHITE),Zo($._WHITE.baseTexture)}return $._WHITE}}class Yi extends ${constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,i=!0){const n=this.baseTexture.resolution,s=Math.round(e*n)/n,o=Math.round(t*n)/n;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new Yi(new Ev(e))}}class Sv{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,i=Me.NONE){const n=new Ev(Object.assign({width:e,height:t,resolution:1,multisample:i},this.textureOptions));return new Yi(n)}getOptimalTexture(e,t,i=1,n=Me.NONE){let s;e=Math.max(Math.ceil(e*i-1e-6),1),t=Math.max(Math.ceil(t*i-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=hl(e),t=hl(t),s=((e&65535)<<16|t&65535)>>>0,n>1&&(s+=n*4294967296)):s=n>1?-n:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,t,n)),o.filterPoolKey=s,o.setResolution(i),o}getFilterTexture(e,t,i){const n=this.getOptimalTexture(e.width,e.height,t||e.resolution,i||Me.NONE);return n.filterFrame=e.filterFrame,n}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const t in this.texturePool){const i=this.texturePool[t];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const i=this.texturePool[t];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}Sv.SCREEN_KEY=-1;class Fb extends ai{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class bv extends ai{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ie(this.vertices),this.uvBuffer=new Ie(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+t.width/e.width,this.uvs[3]=n,this.uvs[4]=i+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=i,this.uvs[7]=n+t.height/e.height,i=t.x,n=t.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+t.width,this.vertices[3]=n,this.vertices[4]=i+t.width,this.vertices[5]=n+t.height,this.vertices[6]=i,this.vertices[7]=n+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Nb{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Me.NONE,this.sourceFrame=new J,this.destinationFrame=new J,this.bindingSourceFrame=new J,this.bindingDestinationFrame=new J,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Qo=[new ne,new ne,new ne,new ne],iu=new pe;class Av{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new Sv,this.statePool=[],this.quad=new Fb,this.quadUv=new bv,this.tempRect=new J,this.activeState={},this.globalUniforms=new Ht({outputFrame:new J,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const i=this.renderer,n=this.defaultFilterStack,s=this.statePool.pop()||new Nb,o=i.renderTexture;let a,l;if(o.current){const x=o.current;a=x.resolution,l=x.multisample}else a=i.resolution,l=i.multisample;let h=t[0].resolution||a,u=t[0].multisample??l,c=t[0].padding,d=t[0].autoFit,f=t[0].legacy??!0;for(let x=1;x<t.length;x++){const g=t[x];h=Math.min(h,g.resolution||a),u=Math.min(u,g.multisample??l),c=this.useMaxPadding?Math.max(c,g.padding):c+g.padding,d=d&&g.autoFit,f=f||(g.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(s),s.resolution=h,s.multisample=u,s.legacy=f,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(c);const p=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(iu.copyFrom(i.projection.transform).invert(),p),d?(s.sourceFrame.fit(p),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(p)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,h,u),s.filters=t,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=s.sourceFrame.width,v.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,v),i.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),i=t.filters;this.activeState=t;const n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;const s=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*t.resolution),o[1]=Math.round(s[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*s[2]-.5*o[2],a[3]=t.sourceFrame.height*s[3]-.5*o[3],t.legacy){const h=n.filterArea;h[0]=t.destinationFrame.width,h[1]=t.destinationFrame.height,h[2]=t.sourceFrame.x,h[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,t.renderTexture,l.renderTexture,ir.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let h=t.renderTexture,u=this.getOptimalFilterTexture(h.width,h.height,t.resolution);u.filterFrame=h.filterFrame;let c=0;for(c=0;c<i.length-1;++c){c===1&&t.multisample>1&&(u=this.getOptimalFilterTexture(h.width,h.height,t.resolution),u.filterFrame=h.filterFrame),i[c].apply(this,h,u,ir.CLEAR,t);const d=h;h=u,u=d}i[c].apply(this,h,l.renderTexture,ir.BLEND,t),c>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(u)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=ir.CLEAR){const{renderTexture:i,state:n}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,i.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=n.stateId&1||this.forceClear;(t===ir.CLEAR||t===ir.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,i,n){const s=this.renderer;s.state.set(e.state),this.bindAndClear(i,n),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(or.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(or.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:s}=t._texture,o=e.set(n.width,0,0,n.height,i.x,i.y),a=t.worldTransform.copyTo(pe.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(t.anchor.x,t.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,i=1,n=Me.NONE){return this.texturePool.getOptimalTexture(e,t,i,n)}getFilterTexture(e,t,i){if(typeof e=="number"){const s=e;e=t,t=s}e=e||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,i||Me.NONE);return n.filterFrame=e.filterFrame,n}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const i=Qo[0],n=Qo[1],s=Qo[2],o=Qo[3];i.set(t.left,t.top),n.set(t.left,t.bottom),s.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(i,i),e.apply(n,n),e.apply(s,s),e.apply(o,o);const a=Math.min(i.x,n.x,s.x,o.x),l=Math.min(i.y,n.y,s.y,o.y),h=Math.max(i.x,n.x,s.x,o.x),u=Math.max(i.y,n.y,s.y,o.y);t.x=a,t.y=l,t.width=h-a,t.height=u-l}roundFrame(e,t,i,n,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){const{a:o,b:a,c:l,d:h}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(h)>1e-4))return}s=s?iu.copyFrom(s):iu.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(s,e),e.ceil(t),this.transformAABB(s.invert(),e)}}}Av.extension={type:L.RendererSystem,name:"filter"};W.add(Av);class Lb{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Me.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Ub=new J;class Cv{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Nc(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new J,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let t=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;G.PREFER_ENV===Wi.WEBGL_LEGACY&&(t=null,i=null),t?e.drawBuffers=n=>t.drawBuffersWEBGL(n):(this.hasMRT=!1,e.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,i=0){const{gl:n}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const o=t.width>>i,a=t.height>>i,l=o/t.width;this.setViewport(t.x*l,t.y*l,o,a)}else{const o=e.width>>i,a=e.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,i,n){const s=this.viewport;e=Math.round(e),t=Math.round(t),i=Math.round(i),n=Math.round(n),(s.width!==i||s.height!==n||s.x!==e||s.y!==t)&&(s.x=e,s.y=t,s.width=i,s.height=n,this.gl.viewport(e,t,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,i,n,s=cc.COLOR|cc.DEPTH){const{gl:o}=this;o.clearColor(e,t,i,n),o.clear(s)}initFramebuffer(e){const{gl:t}=this,i=new Lb(t.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){const{gl:t}=this,i=e.glFramebuffers[this.CONTEXT_UID];if(i.stencil){t.bindRenderbuffer(t.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=t.DEPTH_STENCIL:e.depth&&e.stencil?o=t.DEPTH24_STENCIL8:e.depth?o=t.DEPTH_COMPONENT24:o=t.STENCIL_INDEX8,i.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,o,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,o,e.width,e.height)}const n=e.colorTextures;let s=n.length;t.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=n[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,i.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:i}=this,n=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;i.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(e)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const h=s[l],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),l===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,h.target,u._glTextures[this.CONTEXT_UID].texture,t),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,t)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){n.stencil=n.stencil||i.createRenderbuffer();let l,h;this.renderer.context.webGLVersion===1?(l=i.DEPTH_STENCIL_ATTACHMENT,h=i.DEPTH_STENCIL):e.depth&&e.stencil?(l=i.DEPTH_STENCIL_ATTACHMENT,h=i.DEPTH24_STENCIL8):e.depth?(l=i.DEPTH_ATTACHMENT,h=i.DEPTH_COMPONENT24):(l=i.STENCIL_ATTACHMENT,h=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,h,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,h,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,l,i.RENDERBUFFER,n.stencil)}else n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let i=Me.NONE;if(e<=1||t===null)return i;for(let n=0;n<t.length;n++)if(t[n]<=e){i=t[n];break}return i===1&&(i=Me.NONE),i}blit(e,t,i){const{current:n,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!n)return;const l=n.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const u=n.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new Nc(n.width,n.height),l.blitFramebuffer.addColorTexture(0,u)),e=l.blitFramebuffer,e.colorTextures[0]!==u&&(e.colorTextures[0]=u,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++)}t||(t=Ub,t.width=n.width,t.height=n.height),i||(i=t);const h=t.width===i.width&&t.height===i.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){const i=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,t)}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;const i=e.width,n=e.height,s=this.gl,o=t.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),t.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,t.multisample,l,i,n):s.renderbufferStorage(s.RENDERBUFFER,l,i,n),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new J}destroy(){this.renderer=null}}Cv.extension={type:L.RendererSystem,name:"framebuffer"};W.add(Cv);const nu={5126:4,5123:2,5121:1};class Iv{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;G.PREFER_ENV===Wi.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=()=>i.createVertexArrayOES(),e.bindVertexArray=n=>i.bindVertexArrayOES(n),e.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(t.webGLVersion!==2){const i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=(n,s)=>i.vertexAttribDivisorANGLE(n,s),e.drawElementsInstanced=(n,s,o,a,l)=>i.drawElementsInstancedANGLE(n,s,o,a,l),e.drawArraysInstanced=(n,s,o,a)=>i.drawArraysInstancedANGLE(n,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:i}=this;let n=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},s=!0);const o=n[t.program.id]||this.initGeometryVao(e,t,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){const n=e.buffers[i];t.update(n)}}checkCompatibility(e,t){const i=e.attributes,n=t.attributeData;for(const s in n)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const i=e.attributes,n=t.attributeData,s=["g",e.id];for(const o in i)n[o]&&s.push(o,n[o].location);return s.join("-")}initGeometryVao(e,t,i=!0){const n=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[s]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);const l=this.getSignature(e,a),h=e.glVertexArrayObjects[this.CONTEXT_UID];let u=h[l];if(u)return h[a.id]=u,u;const c=e.buffers,d=e.attributes,f={},p={};for(const v in c)f[v]=0,p[v]=0;for(const v in d)!d[v].size&&a.attributeData[v]?d[v].size=a.attributeData[v].size:d[v].size||console.warn(`PIXI Geometry attribute '${v}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[v].buffer]+=d[v].size*nu[d[v].type];for(const v in d){const x=d[v],g=x.size;x.stride===void 0&&(f[x.buffer]===g*nu[x.type]?x.stride=0:x.stride=f[x.buffer]),x.start===void 0&&(x.start=p[x.buffer],p[x.buffer]+=g*nu[x.type])}u=n.createVertexArray(),n.bindVertexArray(u);for(let v=0;v<c.length;v++){const x=c[v];o.bind(x),i&&x._glBuffers[s].refCount++}return this.activateVao(e,a),h[a.id]=u,h[l]=u,n.bindVertexArray(null),o.unbind(hr.ARRAY_BUFFER),u}disposeGeometry(e,t){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const i=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!i){if(o)for(let l=0;l<s.length;l++){const h=s[l]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!t&&o.dispose(s[l],t))}if(!t){for(const l in i)if(l[0]==="g"){const h=i[l];this._activeVao===h&&this.unbind(),n.deleteVertexArray(h)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e)}activateVao(e,t){const i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const h in a){const u=a[h],c=o[u.buffer],d=c._glBuffers[n];if(t.attributeData[h]){l!==d&&(s.bind(c),l=d);const f=t.attributeData[h].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)i.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,i,n){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,t||o.indexBuffer.data.length,l,(i||0)*a,n||1):s.drawElements(e,t||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,t||o.getSize(),n||1):s.drawArrays(e,i,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Iv.extension={type:L.RendererSystem,name:"geometry"};W.add(Iv);const Um=new pe;class Rv{constructor(e,t){this._texture=e,this.mapCoord=new pe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){t===void 0&&(t=e);const i=this.mapCoord;for(let n=0;n<e.length;n+=2){const s=e[n],o=e[n+1];t[n]=s*i.a+o*i.c+i.tx,t[n+1]=s*i.b+o*i.d+i.ty}return t}update(e){const t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const i=t._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const n=t.orig,s=t.trim;s&&(Um.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Um));const o=t.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,h=this.clampOffset;return a[0]=(t._frame.x+l+h)/o.width,a[1]=(t._frame.y+l+h)/o.height,a[2]=(t._frame.x+t._frame.width-l+h)/o.width,a[3]=(t._frame.y+t._frame.height-l+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&t.rotate===0,!0}}var Gb=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,zb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class jb extends rt{constructor(e,t,i){let n=null;typeof e!="string"&&t===void 0&&i===void 0&&(n=e,e=void 0,t=void 0,i=void 0),super(e||zb,t||Gb,i),this.maskSprite=n,this.maskMatrix=new pe}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,i,n){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Rv(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,i,n))}}class Hb{constructor(e=null){this.type=Oe.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=rt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Oe.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Pv{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let i=t;if(!i.isMaskData){const s=this.maskDataPool.pop()||new Hb;s.pooled=!0,s.maskObject=t,i=s}const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==Oe.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Oe.SCISSOR:this.renderer.scissor.push(i);break;case Oe.STENCIL:this.renderer.stencil.push(i);break;case Oe.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Oe.COLOR:this.pushColorMask(i);break}i.type===Oe.SPRITE&&this.maskStack.push(i)}pop(e){const t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case Oe.SCISSOR:this.renderer.scissor.pop(t);break;case Oe.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Oe.SPRITE:this.popSpriteMask(t);break;case Oe.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Oe.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=Oe.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Oe.SCISSOR:e.type=Oe.STENCIL:e.type=Oe.COLOR}pushSpriteMask(e){const{maskObject:t}=e,i=e._target;let n=e._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new jb])),n[0].resolution=e.resolution,n[0].multisample=e.multisample,n[0].maskSprite=t;const s=i.filterArea;i.filterArea=t.getBounds(!0),this.renderer.filter.push(i,n),i.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,i=e._colorMask=t&e.colorMask;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(e){const t=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}Pv.extension={type:L.RendererSystem,name:"mask"};W.add(Pv);class Mv{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,i=this.getStackLength();this.maskStack=e;const n=this.getStackLength();n!==i&&(n===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Gm=new pe,zm=[],kv=class Ca extends Mv{constructor(e){super(e),this.glConst=G.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:i}=e,{renderer:n}=this,s=n.renderTexture,o=i.getBounds(!0,zm.pop()??new J);this.roundFrameToPixels(o,s.current?s.current.resolution:n.resolution,s.sourceFrame,s.destinationFrame,n.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:i,c:n,d:s}=e;return(Math.abs(i)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||Ca.isMatrixRotated(t.worldTransform)||Ca.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const i=e._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(e,t,i,n,s){Ca.isMatrixRotated(s)||(s=s?Gm.copyFrom(s):Gm.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.renderer.filter.transformAABB(s,e),e.fit(n),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&zm.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};kv.extension={type:L.RendererSystem,name:"scissor"};let $b=kv;W.add($b);class Dv extends Mv{constructor(e){super(e),this.glConst=G.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:i}=this.renderer,n=e._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(e._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const t=this.renderer.gl;if(this.getStackLength()===0)t.disable(t.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(i._colorMask=n,t.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}Dv.extension={type:L.RendererSystem,name:"stencil"};W.add(Dv);class Bv{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return te("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}Bv.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"_plugin"};W.add(Bv);class Ov{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new pe,this.transform=null}update(e,t,i,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,t,i,n){const s=this.projectionMatrix,o=n?-1:1;s.identity(),s.a=1/t.width*2,s.d=o*(1/t.height*2),s.tx=-1-t.x*s.a,s.ty=-o-t.y*s.d}setTransform(e){}destroy(){this.renderer=null}}Ov.extension={type:L.RendererSystem,name:"projection"};W.add(Ov);const Vb=new cf,jm=new J;class Fv{constructor(e){this.renderer=e,this._tempMatrix=new pe}generateTexture(e,t){const{region:i,...n}=t||{},s=(i==null?void 0:i.copyTo(jm))||e.getLocalBounds(jm,!0),o=n.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),n.width=s.width,n.height=s.height,n.resolution=o,n.multisample??(n.multisample=this.renderer.multisample);const a=Yi.create(n);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=Vb,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}Fv.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"textureGenerator"};W.add(Fv);const fi=new J,ds=new J;class Nv{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new J,this.destinationFrame=new J,this.viewportFrame=new J}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,i){const n=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,t||(fi.width=e.frame.width,fi.height=e.frame.height,t=fi),i||(ds.x=e.frame.x,ds.y=e.frame.y,ds.width=t.width,ds.height=t.height,i=ds),o=s.framebuffer):(a=n.resolution,t||(fi.width=n._view.screen.width,fi.height=n._view.screen.height,t=fi),i||(i=fi,i.width=t.width,i.height=t.height));const l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=n.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,t,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(i)}clear(e,t){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=de.shared.setValue(e||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:h,width:u,height:c}=this.viewportFrame;l=Math.round(l),h=Math.round(h),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,u,c)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,t),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Nv.extension={type:L.RendererSystem,name:"renderTexture"};W.add(Nv);class Wb{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Xb(r,e){const t={},i=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){const s=e.getActiveAttrib(r,n);if(s.name.startsWith("gl_"))continue;const o=_v(e,s.type),a={type:o,name:s.name,size:xv(o),location:e.getAttribLocation(r,s.name)};t[s.name]=a}return t}function Yb(r,e){const t={},i=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){const s=e.getActiveUniform(r,n),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=_v(e,s.type);t[o]={name:o,index:n,type:l,size:s.size,isArray:a,value:yv(l,s.size)}}return t}function Kb(r,e){var a;const t=Dm(r,r.VERTEX_SHADER,e.vertexSrc),i=Dm(r,r.FRAGMENT_SHADER,e.fragmentSrc),n=r.createProgram();r.attachShader(n,t),r.attachShader(n,i);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(n,s.names,s.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(n),r.getProgramParameter(n,r.LINK_STATUS)||Sb(r,n,t,i),e.attributeData=Xb(n,r),e.uniformData=Yb(n,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((h,u)=>h>u?1:-1);for(let h=0;h<l.length;h++)e.attributeData[l[h]].location=h,r.bindAttribLocation(n,h,l[h]);r.linkProgram(n)}r.deleteShader(t),r.deleteShader(i);const o={};for(const l in e.uniformData){const h=e.uniformData[l];o[l]={location:r.getUniformLocation(n,l),value:yv(h.type,h.size)}}return new Wb(n,o)}function qb(r,e,t,i,n){t.buffer.update(n)}const Zb={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Lv={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Qb(r){const e=r.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let t=0,i=0,n=0;for(let s=0;s<e.length;s++){const o=e[s];if(t=Lv[o.data.type],o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.dataLen=t,i%t!==0&&i<16){const a=i%t%16;i+=a,n+=a}i+t>16?(n=Math.ceil(n/16)*16,o.offset=n,n+=t,i=t):(o.offset=n,i+=t,n+=t)}return n=Math.ceil(n/16)*16,{uboElements:e,size:n}}function Jb(r,e){const t=[];for(const i in r)e[i]&&t.push(e[i]);return t.sort((i,n)=>i.index-n.index),t}function eA(r,e){if(!r.autoManage)return{size:0,syncFunc:qb};const t=Jb(r.uniforms,e),{uboElements:i,size:n}=Qb(t),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],l=r.uniforms[a.data.name],h=a.data.name;let u=!1;for(let c=0;c<Bn.length;c++){const d=Bn[c];if(d.codeUbo&&d.test(a.data,l)){s.push(`offset = ${a.offset/4};`,Bn[c].codeUbo(a.data.name,l)),u=!0;break}}if(!u)if(a.data.size>1){const c=xv(a.data.type),d=Math.max(Lv[a.data.type]/16,1),f=c/d,p=(4-f%4)%4;s.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const c=Zb[a.data.type];s.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};
                ${c};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let tA=0;const Jo={textureCount:0,uboCount:0};class Uv{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=tA++}systemCheck(){if(!Ab())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const i=e.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),t||(Jo.textureCount=0,Jo.uboCount=0,this.syncUniformGroup(e.uniformGroup,Jo)),n}setUniforms(e){const t=this.shader.program,i=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,t){const i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,t))}syncUniforms(e,t,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=wb(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;const n=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t);e.buffer.update(),n(i.uniformData,e.uniforms,this.renderer,Jo,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])}createSyncBufferGroup(e,t,i){const{gl:n}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(t.program,i);t.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(t.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=eA(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,i){const n=e.uniforms,s=[`${i}-`];for(const o in n)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,i=e.program,n=Kb(t,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Uv.extension={type:L.RendererSystem,name:"shader"};W.add(Uv);class pl{constructor(e){this.renderer=e}run(e){const{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.4.3 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}pl.defaultOptions={hello:!1},pl.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"startup"};W.add(pl);function rA(r,e=[]){return e[Z.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.ADD]=[r.ONE,r.ONE],e[Z.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.NONE]=[0,0],e[Z.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],e[Z.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[Z.SRC_IN]=[r.DST_ALPHA,r.ZERO],e[Z.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],e[Z.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[Z.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],e[Z.DST_IN]=[r.ZERO,r.SRC_ALPHA],e[Z.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],e[Z.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],e[Z.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[Z.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],e}const iA=0,nA=1,sA=2,oA=3,aA=4,lA=5,Gv=class Lc{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Z.NONE,this._blendEq=!1,this.map=[],this.map[iA]=this.setBlend,this.map[nA]=this.setOffset,this.map[sA]=this.setCullFace,this.map[oA]=this.setDepthTest,this.map[aA]=this.setFrontFace,this.map[lA]=this.setDepthMask,this.checks=[],this.defaultState=new pr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=rA(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,i=0;for(;t;)t&1&&this.map[i].call(this,!!(e.data&1<<i)),t=t>>1,i++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Lc.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Lc.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],i=this.gl;t.length===2?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const i=this.checks.indexOf(e);t&&i===-1?this.checks.push(e):!t&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};Gv.extension={type:L.RendererSystem,name:"state"};let hA=Gv;W.add(hA);class uA extends go{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter(n=>e.systems[n]),i=[...t,...Object.keys(e.systems).filter(n=>!t.includes(n))];for(const n of i)this.addSystem(e.systems[n],n)}addRunners(...e){e.forEach(t=>{this.runners[t]=new jt(t)})}addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(e,t){const i=Object.keys(this._systemsHash);e.items.forEach(n=>{const s=i.find(o=>this._systemsHash[o]===n);n[e.name](t[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const _s=class Ia{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Ia.defaultMaxIdle,this.checkCountMax=Ia.defaultCheckCountMax,this.mode=Ia.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==rf.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let i=!1;for(let n=0;n<t.length;n++){const s=t[n];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),t[n]=null,i=!0)}if(i){let n=0;for(let s=0;s<t.length;s++)t[s]!==null&&(t[n++]=t[s]);t.length=n}}unload(e){const t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(let n=e.children.length-1;n>=0;n--)this.unload(e.children[n])}destroy(){this.renderer=null}};_s.defaultMode=rf.AUTO,_s.defaultMaxIdle=60*60,_s.defaultCheckCountMax=60*10,_s.extension={type:L.RendererSystem,name:"textureGC"};let Ei=_s;W.add(Ei);class su{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Y.UNSIGNED_BYTE,this.internalFormat=O.RGBA,this.samplerType=0}}function cA(r){let e;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?e={[r.RGB]:U.FLOAT,[r.RGBA]:U.FLOAT,[r.ALPHA]:U.FLOAT,[r.LUMINANCE]:U.FLOAT,[r.LUMINANCE_ALPHA]:U.FLOAT,[r.R8]:U.FLOAT,[r.R8_SNORM]:U.FLOAT,[r.RG8]:U.FLOAT,[r.RG8_SNORM]:U.FLOAT,[r.RGB8]:U.FLOAT,[r.RGB8_SNORM]:U.FLOAT,[r.RGB565]:U.FLOAT,[r.RGBA4]:U.FLOAT,[r.RGB5_A1]:U.FLOAT,[r.RGBA8]:U.FLOAT,[r.RGBA8_SNORM]:U.FLOAT,[r.RGB10_A2]:U.FLOAT,[r.RGB10_A2UI]:U.FLOAT,[r.SRGB8]:U.FLOAT,[r.SRGB8_ALPHA8]:U.FLOAT,[r.R16F]:U.FLOAT,[r.RG16F]:U.FLOAT,[r.RGB16F]:U.FLOAT,[r.RGBA16F]:U.FLOAT,[r.R32F]:U.FLOAT,[r.RG32F]:U.FLOAT,[r.RGB32F]:U.FLOAT,[r.RGBA32F]:U.FLOAT,[r.R11F_G11F_B10F]:U.FLOAT,[r.RGB9_E5]:U.FLOAT,[r.R8I]:U.INT,[r.R8UI]:U.UINT,[r.R16I]:U.INT,[r.R16UI]:U.UINT,[r.R32I]:U.INT,[r.R32UI]:U.UINT,[r.RG8I]:U.INT,[r.RG8UI]:U.UINT,[r.RG16I]:U.INT,[r.RG16UI]:U.UINT,[r.RG32I]:U.INT,[r.RG32UI]:U.UINT,[r.RGB8I]:U.INT,[r.RGB8UI]:U.UINT,[r.RGB16I]:U.INT,[r.RGB16UI]:U.UINT,[r.RGB32I]:U.INT,[r.RGB32UI]:U.UINT,[r.RGBA8I]:U.INT,[r.RGBA8UI]:U.UINT,[r.RGBA16I]:U.INT,[r.RGBA16UI]:U.UINT,[r.RGBA32I]:U.INT,[r.RGBA32UI]:U.UINT,[r.DEPTH_COMPONENT16]:U.FLOAT,[r.DEPTH_COMPONENT24]:U.FLOAT,[r.DEPTH_COMPONENT32F]:U.FLOAT,[r.DEPTH_STENCIL]:U.FLOAT,[r.DEPTH24_STENCIL8]:U.FLOAT,[r.DEPTH32F_STENCIL8]:U.FLOAT}:e={[r.RGB]:U.FLOAT,[r.RGBA]:U.FLOAT,[r.ALPHA]:U.FLOAT,[r.LUMINANCE]:U.FLOAT,[r.LUMINANCE_ALPHA]:U.FLOAT,[r.DEPTH_STENCIL]:U.FLOAT},e}function dA(r){let e;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?e={[Y.UNSIGNED_BYTE]:{[O.RGBA]:r.RGBA8,[O.RGB]:r.RGB8,[O.RG]:r.RG8,[O.RED]:r.R8,[O.RGBA_INTEGER]:r.RGBA8UI,[O.RGB_INTEGER]:r.RGB8UI,[O.RG_INTEGER]:r.RG8UI,[O.RED_INTEGER]:r.R8UI,[O.ALPHA]:r.ALPHA,[O.LUMINANCE]:r.LUMINANCE,[O.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[Y.BYTE]:{[O.RGBA]:r.RGBA8_SNORM,[O.RGB]:r.RGB8_SNORM,[O.RG]:r.RG8_SNORM,[O.RED]:r.R8_SNORM,[O.RGBA_INTEGER]:r.RGBA8I,[O.RGB_INTEGER]:r.RGB8I,[O.RG_INTEGER]:r.RG8I,[O.RED_INTEGER]:r.R8I},[Y.UNSIGNED_SHORT]:{[O.RGBA_INTEGER]:r.RGBA16UI,[O.RGB_INTEGER]:r.RGB16UI,[O.RG_INTEGER]:r.RG16UI,[O.RED_INTEGER]:r.R16UI,[O.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[Y.SHORT]:{[O.RGBA_INTEGER]:r.RGBA16I,[O.RGB_INTEGER]:r.RGB16I,[O.RG_INTEGER]:r.RG16I,[O.RED_INTEGER]:r.R16I},[Y.UNSIGNED_INT]:{[O.RGBA_INTEGER]:r.RGBA32UI,[O.RGB_INTEGER]:r.RGB32UI,[O.RG_INTEGER]:r.RG32UI,[O.RED_INTEGER]:r.R32UI,[O.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[Y.INT]:{[O.RGBA_INTEGER]:r.RGBA32I,[O.RGB_INTEGER]:r.RGB32I,[O.RG_INTEGER]:r.RG32I,[O.RED_INTEGER]:r.R32I},[Y.FLOAT]:{[O.RGBA]:r.RGBA32F,[O.RGB]:r.RGB32F,[O.RG]:r.RG32F,[O.RED]:r.R32F,[O.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[Y.HALF_FLOAT]:{[O.RGBA]:r.RGBA16F,[O.RGB]:r.RGB16F,[O.RG]:r.RG16F,[O.RED]:r.R16F},[Y.UNSIGNED_SHORT_5_6_5]:{[O.RGB]:r.RGB565},[Y.UNSIGNED_SHORT_4_4_4_4]:{[O.RGBA]:r.RGBA4},[Y.UNSIGNED_SHORT_5_5_5_1]:{[O.RGBA]:r.RGB5_A1},[Y.UNSIGNED_INT_2_10_10_10_REV]:{[O.RGBA]:r.RGB10_A2,[O.RGBA_INTEGER]:r.RGB10_A2UI},[Y.UNSIGNED_INT_10F_11F_11F_REV]:{[O.RGB]:r.R11F_G11F_B10F},[Y.UNSIGNED_INT_5_9_9_9_REV]:{[O.RGB]:r.RGB9_E5},[Y.UNSIGNED_INT_24_8]:{[O.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[Y.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[O.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:e={[Y.UNSIGNED_BYTE]:{[O.RGBA]:r.RGBA,[O.RGB]:r.RGB,[O.ALPHA]:r.ALPHA,[O.LUMINANCE]:r.LUMINANCE,[O.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[Y.UNSIGNED_SHORT_5_6_5]:{[O.RGB]:r.RGB},[Y.UNSIGNED_SHORT_4_4_4_4]:{[O.RGBA]:r.RGBA},[Y.UNSIGNED_SHORT_5_5_5_1]:{[O.RGBA]:r.RGBA}},e}class zv{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Q,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=dA(e),this.samplerTypes=cA(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let n=0;n<t;n++)this.boundTextures[n]=null;this.emptyTextures={};const i=new su(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new su(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(e,t=0){const{gl:i}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)):n.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===e&&(this.currentLocation!==n&&(t.activeTexture(t.TEXTURE0+n),this.currentLocation=n),t.bindTexture(e.target,this.emptyTextures[e.target].texture),i[n]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let s=e-1;s>=0;--s){const o=t[s];o&&o._glTextures[n].samplerType!==U.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const t=new su(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){var i;t.internalFormat=((i=this.internalFormats[e.type])==null?void 0:i[e.format])??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??U.FLOAT,this.webGLVersion===2&&e.type===Y.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){var n;const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const i=this.renderer;if(this.initTextureType(e,t),(n=e.resource)==null?void 0:n.upload(i,e,t))t.samplerType!==U.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=i.gl;(t.width!==s||t.height!==o||t.dirtyId<0)&&(t.width=s,t.height=o,a.texImage2D(e.target,0,t.internalFormat,s,o,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:i}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const n=this.managedTextures.indexOf(e);n!==-1&&Dn(this.managedTextures,n,1)}}updateTextureStyle(e){var i;const t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===dr.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=ni.CLAMP:t.wrapMode=e.wrapMode,(i=e.resource)!=null&&i.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const i=this.gl;if(t.mipmap&&e.mipmap!==dr.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===Er.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===Er.LINEAR){const s=Math.min(e.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===Er.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===Er.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}zv.extension={type:L.RendererSystem,name:"texture"};W.add(zv);class jv{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,n=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:i,renderer:n}=this;t&&n.shader.bind(t),i.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:i,CONTEXT_UID:n}=this,s=t.createTransformFeedback();e._glTransformFeedbacks[n]=s,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(i.buffer.update(a),a._glBuffers[n].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[n].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,t){const i=e._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!t&&s.dispose(a,t))}i&&(t||n.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}jv.extension={type:L.RendererSystem,name:"transformFeedback"};W.add(jv);class ml{constructor(e){this.renderer=e}init(e){this.screen=new J(0,0,e.width,e.height),this.element=e.view||G.ADAPTER.createCanvas(),this.resolution=e.resolution||G.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var t;e&&((t=this.element.parentNode)==null||t.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ml.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ml.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"_view"};W.add(ml);G.PREFER_ENV=Wi.WEBGL2;G.STRICT_TEXTURE_CACHE=!1;G.RENDER_OPTIONS={...fl.defaultOptions,...dl.defaultOptions,...ml.defaultOptions,...pl.defaultOptions};Object.defineProperties(G,{WRAP_MODE:{get(){return Q.defaultOptions.wrapMode},set(r){te("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Q.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return Q.defaultOptions.scaleMode},set(r){te("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Q.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return Q.defaultOptions.mipmap},set(r){te("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Q.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return Q.defaultOptions.anisotropicLevel},set(r){te("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Q.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return te("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),rt.defaultResolution},set(r){rt.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return te("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),rt.defaultMultisample},set(r){rt.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return wi.defaultMaxTextures},set(r){te("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),wi.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return wi.defaultBatchSize},set(r){te("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),wi.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return wi.canUploadSameBuffer},set(r){te("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),wi.canUploadSameBuffer=r}},GC_MODE:{get(){return Ei.defaultMode},set(r){te("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Ei.defaultMode=r}},GC_MAX_IDLE:{get(){return Ei.defaultMaxIdle},set(r){te("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Ei.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return Ei.defaultCheckCountMax},set(r){te("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Ei.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return br.defaultVertexPrecision},set(r){te("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),br.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return br.defaultFragmentPrecision},set(r){te("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),br.defaultFragmentPrecision=r}}});var Hi=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Hi||{});class ou{constructor(e,t=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=i,this.once=n}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const Hv=class ft{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ou(null,null,1/0),this.deltaMS=1/ft.targetFPMS,this.elapsedMS=1/ft.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=Hi.NORMAL){return this._addListener(new ou(e,t,i))}addOnce(e,t,i=Hi.NORMAL){return this._addListener(new ou(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ft.targetFPMS;const i=this._head;let n=i.next;for(;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,ft.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ft._shared){const e=ft._shared=new ft;e.autoStart=!0,e._protected=!0}return ft._shared}static get system(){if(!ft._system){const e=ft._system=new ft;e.autoStart=!0,e._protected=!0}return ft._system}};Hv.targetFPMS=.06;let gt=Hv;Object.defineProperties(G,{TARGET_FPMS:{get(){return gt.targetFPMS},set(r){te("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),gt.targetFPMS=r}}});class $v{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Hi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?gt.shared:new gt,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}$v.extension=L.Application;W.add($v);const Vv=[];W.handleByList(L.Renderer,Vv);function fA(r){for(const e of Vv)if(e.test(r))return new e(r);throw new Error("Unable to auto-detect a suitable renderer.")}var pA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,mA=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const gA=pA,Wv=mA;class Xv{constructor(e){this.renderer=e}contextChange(e){let t;if(this.renderer.context.webGLVersion===1){const i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{const i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}t>=Me.HIGH?this.multisample=Me.HIGH:t>=Me.MEDIUM?this.multisample=Me.MEDIUM:t>=Me.LOW?this.multisample=Me.LOW:this.multisample=Me.NONE}destroy(){}}Xv.extension={type:L.RendererSystem,name:"_multisample"};W.add(Xv);class yA{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Yv{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);t.bindBuffer(e.type,n.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[t]!==e){const s=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[t]=e,i.bindBufferBase(i.UNIFORM_BUFFER,t,s.buffer)}}bindBufferRange(e,t,i){const{gl:n,CONTEXT_UID:s}=this;i=i||0;const o=e._glBuffers[s]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,o.buffer,i*256,256)}update(e){const{gl:t,CONTEXT_UID:i}=this,n=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==n.updateID)if(n.updateID=e._updateID,t.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const s=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,s)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const i=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),i&&(t||n.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let i=0;i<t.length;i++)this.dispose(this.managedBuffers[t[i]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:i}=this;return e._glBuffers[t]=new yA(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}Yv.extension={type:L.RendererSystem,name:"buffer"};W.add(Yv);class Kv{constructor(e){this.renderer=e}render(e,t){const i=this.renderer;let n,s,o,a;if(t&&(n=t.renderTexture,s=t.clear,o=t.transform,a=t.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(n||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),n&&(t.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Kv.extension={type:L.RendererSystem,name:"objectRenderer"};W.add(Kv);const Ra=class Uc extends uA{constructor(e){super(),this.type=ky.WEBGL,e=Object.assign({},G.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Ht({projectionMatrix:new pe},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Uc.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(te("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=Uc.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:GS()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return te("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return te("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return te("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){te("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){te("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return te("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};Ra.extension={type:L.Renderer,priority:1},Ra.__plugins={},Ra.__systems={};let ff=Ra;W.handleByMap(L.RendererPlugin,ff.__plugins);W.handleByMap(L.RendererSystem,ff.__systems);W.add(ff);class qv extends ao{constructor(e,t){const{width:i,height:n}=t||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new Q;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof ao?this.addResourceAt(e[i],i):this.addResourceAt(pv(e[i],t),i))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(t=>t.resource).filter(t=>t).map(t=>t.load());return this._load=Promise.all(e).then(()=>{const{realWidth:t,realHeight:i}=this.items[0];return this.resize(t,i),this.update(),Promise.resolve(this)}),this._load}}class vA extends qv{constructor(e,t){const{width:i,height:n}=t||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:i,height:n}),s&&this.initFromArray(s,t)}addBaseTextureAt(e,t){if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Pn.TEXTURE_2D_ARRAY}upload(e,t,i){const{length:n,itemDirtyIds:s,items:o}=this,{gl:a}=e;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,t.format,i.type,null);for(let l=0;l<n;l++){const h=o[l];s[l]<h.dirtyId&&(s[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,t.format,i.type,h.resource.source))}return!0}}class xA extends Dr{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return t&&e instanceof t?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const Zv=class ws extends qv{constructor(e,t){const{width:i,height:n,autoLoad:s,linkBaseTexture:o}=t||{};if(e&&e.length!==ws.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:i,height:n});for(let a=0;a<ws.SIDES;a++)this.items[a].target=Pn.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,t),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Pn.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Pn.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,i){const n=this.itemDirtyIds;for(let s=0;s<ws.SIDES;s++){const o=this.items[s];(n[s]<o.dirtyId||i.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,i),n[s]=o.dirtyId):n[s]<-1&&(e.gl.texImage2D(o.target,0,i.internalFormat,t.realWidth,t.realHeight,0,t.format,i.type,null),n[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===ws.SIDES}};Zv.SIDES=6;let _A=Zv;class En extends Dr{constructor(e,t){t=t||{};let i,n,s;typeof e=="string"?(i=En.EMPTY,n=e,s=!0):(i=e,n=null,s=!1),super(i),this.url=n,this.crossOrigin=t.crossOrigin??!0,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??s,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,t)=>{if(this.url===null){e(this);return}try{const i=await G.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await i.blob();if(this.destroyed)return;const s=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===lt.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(i){if(this.destroyed)return;t(i),this.onError.emit(i)}}),this._load)}upload(e,t,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),super.upload(e,t,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return En._EMPTY=En._EMPTY??G.ADAPTER.createCanvas(0,0),En._EMPTY}}const Gc=class Pa extends Dr{constructor(e,t){t=t||{},super(G.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Pa.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Dr.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,i=e.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,s=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/i*t,s=this._overrideHeight||this._overrideWidth/t*i),n=Math.round(n),s=Math.round(s);const o=this.source;o.width=n,o.height=s,o._pixiId=`canvas_${ji()}`,o.getContext("2d").drawImage(e,0,0,t,i,0,0,n,s),this._resolve(),this._resolve=null}}static getSize(e){const t=Pa.SVG_SIZE.exec(e),i={};return t&&(i[t[1]]=Math.round(parseFloat(t[3])),i[t[5]]=Math.round(parseFloat(t[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Pa.SVG_XML.test(e)}};Gc.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Gc.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let zc=Gc;class wA extends Dr{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const jc=class Hc extends Dr{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const i=document.createElement("video");t.autoLoad!==!1&&i.setAttribute("preload","auto"),t.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),t.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),t.loop===!0&&i.setAttribute("loop",""),t.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const n=e[0].src||e[0];Dr.crossOrigin(i,n,t.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const h=a.split("?").shift().toLowerCase(),u=h.slice(h.lastIndexOf(".")+1);l=l||Hc.MIME_TYPES[u]||`video/${u}`}o.src=a,l&&(o.type=l),i.appendChild(o)}e=i}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const t=gt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((t,i)=>{this.valid?t(this):(this._resolve=t,this._reject=i,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(gt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(gt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(gt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Hc.TYPES.includes(t)}};jc.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],jc.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Qv=jc;Rc.push(En,Tv,xA,Qv,wA,zc,Vl,_A,vA);class gl{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?J.EMPTY:(e=e||new J(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:i,b:n,c:s,d:o,tx:a,ty:l}=e,h=i*t.x+s*t.y+a,u=n*t.x+o*t.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(e){let t=this.minX,i=this.minY,n=this.maxX,s=this.maxY,o=e[0],a=e[1];t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[2],a=e[3],t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[4],a=e[5],t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=e[6],a=e[7],t=o<t?o:t,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,this.minX=t,this.minY=i,this.maxX=n,this.maxY=s}addFrame(e,t,i,n,s){this.addFrameMatrix(e.worldTransform,t,i,n,s)}addFrameMatrix(e,t,i,n,s){const o=e.a,a=e.b,l=e.c,h=e.d,u=e.tx,c=e.ty;let d=this.minX,f=this.minY,p=this.maxX,v=this.maxY,x=o*t+l*i+u,g=a*t+h*i+c;d=x<d?x:d,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,x=o*n+l*i+u,g=a*n+h*i+c,d=x<d?x:d,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,x=o*t+l*s+u,g=a*t+h*s+c,d=x<d?x:d,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,x=o*n+l*s+u,g=a*n+h*s+c,d=x<d?x:d,f=g<f?g:f,p=x>p?x:p,v=g>v?g:v,this.minX=d,this.minY=f,this.maxX=p,this.maxY=v}addVertexData(e,t,i){let n=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=t;l<i;l+=2){const h=e[l],u=e[l+1];n=h<n?h:n,s=u<s?u:s,o=h>o?h:o,a=u>a?u:a}this.minX=n,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,t,i,n){this.addVerticesMatrix(e.worldTransform,t,i,n)}addVerticesMatrix(e,t,i,n,s=0,o=s){const a=e.a,l=e.b,h=e.c,u=e.d,c=e.tx,d=e.ty;let f=this.minX,p=this.minY,v=this.maxX,x=this.maxY;for(let g=i;g<n;g+=2){const y=t[g],m=t[g+1],_=a*y+h*m+c,E=u*m+l*y+d;f=Math.min(f,_-s),v=Math.max(v,_+s),p=Math.min(p,E-o),x=Math.max(x,E+o)}this.minX=f,this.minY=p,this.maxX=v,this.maxY=x}addBounds(e){const t=this.minX,i=this.minY,n=this.maxX,s=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,t){const i=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,s=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(i<=s&&n<=o){const a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=n<l?n:l,this.maxX=s>h?s:h,this.maxY=o>u?o:u}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const i=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,s=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(i<=s&&n<=o){const a=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=n<l?n:l,this.maxX=s>h?s:h,this.maxY=o>u?o:u}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,i,n,s,o){e-=s,t-=o,i+=s,n+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>n?this.maxY:n}}class Se extends go{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new cf,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new gl,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let i=0;i<t.length;++i){const n=t[i];Object.defineProperty(Se.prototype,n,Object.getOwnPropertyDescriptor(e,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new J),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new J),e=this._localBoundsRect),this._localBounds||(this._localBounds=new gl);const t=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const n=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=i,this.transform=t,this._bounds=n,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,t,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,i,n){return t&&(e=t.toGlobal(e,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,t=0,i=1,n=1,s=0,o=0,a=0,l=0,h=0){return this.position.x=e,this.position.y=t,this.scale.x=i||1,this.scale.y=n||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=h,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new EA),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*pb}set angle(e){this.transform.rotation=e*mb}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,t._maskRefCount===0&&(t.renderable=!0,t.isMask=!1))}if(this._mask=e,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount===0&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class EA extends Se{constructor(){super(...arguments),this.sortDirty=null}}Se.prototype.displayObjectUpdateTransform=Se.prototype.updateTransform;const TA=new pe;function SA(r,e){return r.zIndex===e.zIndex?r._lastSortedIndex-e._lastSortedIndex:r.zIndex-e.zIndex}const Jv=class $c extends Se{constructor(){super(),this.children=[],this.sortableChildren=$c.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const i=this.getChildIndex(e),n=this.getChildIndex(t);this.children[i]=t,this.children[n]=e,this.onChildrenChange(i<n?i:n)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(e);Dn(this.children,i,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],i=this.children.indexOf(t);if(i===-1)return null;t.parent=null,t.transform._parentID=-1,Dn(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Dn(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const i=e,n=t,s=n-i;let o;if(s>0&&s<=n){o=this.children.splice(i,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,i=this.children.length;t<i;++t){const n=this.children[t];n._lastSortedIndex=t,!e&&n.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(SA),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const i=this.children[e];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(t._bounds,i._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const i=super.getLocalBounds(e);if(!t)for(let n=0,s=this.children.length;n<s;++n){const o=this.children[n];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let i,n;this.cullArea?(i=this.cullArea,n=this.worldTransform):this._render!==$c.prototype._render&&(i=this.getBounds(!0));const s=e.projection.transform;if(s&&(n?(n=TA.copyFrom(n),n.prepend(s)):n=s),i&&t.intersects(i,n))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],h=l.cullable;l.cullable=h||!this.cullArea,l.render(e),l.cullable=h}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let i=0,n=this.children.length;i<n;++i)this.children[i].render(e)}}renderAdvanced(e){var s,o,a;const t=this.filters,i=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const n=t&&((s=this._enabledFilters)==null?void 0:s.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Oe.NONE));if(n&&e.batch.flush(),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,h=this.children.length;l<h;++l)this.children[l].render(e)}n&&e.batch.flush(),i&&e.mask.pop(this),t&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,i=this.removeChildren(0,this.children.length);if(t)for(let n=0;n<i.length;++n)i[n].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};Jv.defaultSortableChildren=!1;let Pt=Jv;Pt.prototype.containerUpdateTransform=Pt.prototype.updateTransform;Object.defineProperties(G,{SORTABLE_CHILDREN:{get(){return Pt.defaultSortableChildren},set(r){te("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Pt.defaultSortableChildren=r}}});const fs=new ne,bA=new Uint16Array([0,1,2,0,2,3]);class Qn extends Pt{constructor(e){super(),this._anchor=new Sr(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new de(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=Z.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||$.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=bA,this.pluginName="batch",this.isSprite=!0,this._roundPixels=G.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Yr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Yr(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,i=t.a,n=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,h=this.vertexData,u=e.trim,c=e.orig,d=this._anchor;let f=0,p=0,v=0,x=0;if(u?(p=u.x-d._x*c.width,f=p+u.width,x=u.y-d._y*c.height,v=x+u.height):(p=-d._x*c.width,f=p+c.width,x=-d._y*c.height,v=x+c.height),h[0]=i*p+s*x+a,h[1]=o*x+n*p+l,h[2]=i*f+s*x+a,h[3]=o*x+n*f+l,h[4]=i*f+s*v+a,h[5]=o*v+n*f+l,h[6]=i*p+s*v+a,h[7]=o*v+n*p+l,this._roundPixels){const g=G.RESOLUTION;for(let y=0;y<h.length;++y)h[y]=Math.round(h[y]*g)/g}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,i=e.orig,n=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,h=s.d,u=s.tx,c=s.ty,d=-n._x*i.width,f=d+i.width,p=-n._y*i.height,v=p+i.height;if(t[0]=o*d+l*p+u,t[1]=h*p+a*d+c,t[2]=o*f+l*p+u,t[3]=h*p+a*f+c,t[4]=o*f+l*v+u,t[5]=h*v+a*f+c,t[6]=o*d+l*v+u,t[7]=h*v+a*d+c,this._roundPixels){const x=G.RESOLUTION;for(let g=0;g<t.length;++g)t[g]=Math.round(t[g]*x)/x}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new gl),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new J),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,fs);const t=this._texture.orig.width,i=this._texture.orig.height,n=-t*this.anchor.x;let s=0;return fs.x>=n&&fs.x<n+t&&(s=-i*this.anchor.y,fs.y>=s&&fs.y<s+i)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const t=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){const i=e instanceof $?e:$.from(e,t);return new Qn(i)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=Yr(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=Yr(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||$.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const ex=new pe;Se.prototype._cacheAsBitmap=!1;Se.prototype._cacheData=null;Se.prototype._cacheAsBitmapResolution=null;Se.prototype._cacheAsBitmapMultisample=null;class AA{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Se.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(r){if(this._cacheAsBitmap===r)return;this._cacheAsBitmap=r;let e;r?(this._cacheData||(this._cacheData=new AA),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Se.prototype._renderCached=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(r),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(r))};Se.prototype._initCachedDisplayObject=function(r){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.alpha;this.alpha=1,r.batch.flush();const t=this.getLocalBounds(new J,!0);if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;t.pad(p)}const i=this.cacheAsBitmapResolution||r.resolution;t.ceil(i),t.width=Math.max(t.width,1/i),t.height=Math.max(t.height,1/i);const n=r.renderTexture.current,s=r.renderTexture.sourceFrame.clone(),o=r.renderTexture.destinationFrame.clone(),a=r.projection.transform,l=Yi.create({width:t.width,height:t.height,resolution:i,multisample:this.cacheAsBitmapMultisample??r.multisample}),h=`cacheAsBitmap_${ji()}`;this._cacheData.textureCacheId=h,Q.addToCache(l.baseTexture,h),$.addToCache(l,h);const u=this.transform.localTransform.copyTo(ex).invert().translate(-t.x,-t.y);this.render=this._cacheData.originalRender,r.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),r.framebuffer.blit(),r.projection.transform=a,r.renderTexture.bind(n,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const c=new Qn(l);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(t.x/t.width),c.anchor.y=-(t.y/t.height),c.alpha=e,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)};Se.prototype._renderCachedCanvas=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(r),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(r))};Se.prototype._initCachedDisplayObjectCanvas=function(r){var u;if((u=this._cacheData)!=null&&u.sprite)return;const e=this.getLocalBounds(new J,!0),t=this.alpha;this.alpha=1;const i=r.canvasContext.activeContext,n=r._projTransform,s=this.cacheAsBitmapResolution||r.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Yi.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${ji()}`;this._cacheData.textureCacheId=a,Q.addToCache(o.baseTexture,a),$.addToCache(o,a);const l=ex;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,r.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),r.canvasContext.activeContext=i,r._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const h=new Qn(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(e.x/e.width),h.anchor.y=-(e.y/e.height),h.alpha=t,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=r._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};Se.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Se.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Se.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Q.removeFromCache(this._cacheData.textureCacheId),$.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Se.prototype._cacheAsBitmapDestroy=function(r){this.cacheAsBitmap=!1,this.destroy(r)};Se.prototype.name=null;Pt.prototype.getChildByName=function(r,e){for(let t=0,i=this.children.length;t<i;t++)if(this.children[t].name===r)return this.children[t];if(e)for(let t=0,i=this.children.length;t<i;t++){const n=this.children[t];if(!n.getChildByName)continue;const s=n.getChildByName(r,!0);if(s)return s}return null};Se.prototype.getGlobalPosition=function(r=new ne,e=!1){return this.parent?this.parent.toGlobal(this.position,r,e):(r.x=this.position.x,r.y=this.position.y),r};var CA=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class IA extends rt{constructor(e=1){super(gA,CA,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const RA={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},PA=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function MA(r){const e=RA[r],t=e.length;let i=PA,n="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<r;a++){let l=s.replace("%index%",a.toString());o=a,a>=t&&(o=r-a-1),l=l.replace("%value%",e[o].toString()),n+=l,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",r.toString()),i}const kA=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function DA(r,e){const t=Math.ceil(r/2);let i=kA,n="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<r;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(t-1)}.0`),n+=a,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",r.toString()),i}class Vc extends rt{constructor(e,t=8,i=4,n=rt.defaultResolution,s=5){const o=DA(s,e),a=MA(s);super(o,a),this.horizontal=e,this.resolution=n,this._quality=0,this.quality=i,this.blur=t}apply(e,t,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/t.width):this.uniforms.strength=1/i.height*(i.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,t,i,n);else{const s=e.getFilterTexture(),o=e.renderer;let a=t,l=s;this.state.blend=!1,e.applyFilter(this,a,l,ir.CLEAR);for(let h=1;h<this.passes-1;h++){e.bindAndClear(a,ir.BLIT),this.uniforms.uSampler=l;const u=l;l=a,a=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,i,n),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class BA extends rt{constructor(e=8,t=4,i=rt.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Vc(!0,e,t,i,n),this.blurYFilter=new Vc(!1,e,t,i,n),this.resolution=i,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,i,n){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,t,a,ir.CLEAR),this.blurYFilter.apply(e,a,i,n),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,t,i,n):this.blurXFilter.apply(e,t,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var OA=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Wc extends rt{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Wv,OA,e),this.alpha=1}_loadMatrix(e,t=!1){let i=e;t&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(e,t,i){return e[0]=t[0]*i[0]+t[1]*i[5]+t[2]*i[10]+t[3]*i[15],e[1]=t[0]*i[1]+t[1]*i[6]+t[2]*i[11]+t[3]*i[16],e[2]=t[0]*i[2]+t[1]*i[7]+t[2]*i[12]+t[3]*i[17],e[3]=t[0]*i[3]+t[1]*i[8]+t[2]*i[13]+t[3]*i[18],e[4]=t[0]*i[4]+t[1]*i[9]+t[2]*i[14]+t[3]*i[19]+t[4],e[5]=t[5]*i[0]+t[6]*i[5]+t[7]*i[10]+t[8]*i[15],e[6]=t[5]*i[1]+t[6]*i[6]+t[7]*i[11]+t[8]*i[16],e[7]=t[5]*i[2]+t[6]*i[7]+t[7]*i[12]+t[8]*i[17],e[8]=t[5]*i[3]+t[6]*i[8]+t[7]*i[13]+t[8]*i[18],e[9]=t[5]*i[4]+t[6]*i[9]+t[7]*i[14]+t[8]*i[19]+t[9],e[10]=t[10]*i[0]+t[11]*i[5]+t[12]*i[10]+t[13]*i[15],e[11]=t[10]*i[1]+t[11]*i[6]+t[12]*i[11]+t[13]*i[16],e[12]=t[10]*i[2]+t[11]*i[7]+t[12]*i[12]+t[13]*i[17],e[13]=t[10]*i[3]+t[11]*i[8]+t[12]*i[13]+t[13]*i[18],e[14]=t[10]*i[4]+t[11]*i[9]+t[12]*i[14]+t[13]*i[19]+t[14],e[15]=t[15]*i[0]+t[16]*i[5]+t[17]*i[10]+t[18]*i[15],e[16]=t[15]*i[1]+t[16]*i[6]+t[17]*i[11]+t[18]*i[16],e[17]=t[15]*i[2]+t[16]*i[7]+t[17]*i[12]+t[18]*i[17],e[18]=t[15]*i[3]+t[16]*i[8]+t[17]*i[13]+t[18]*i[18],e[19]=t[15]*i[4]+t[16]*i[9]+t[17]*i[14]+t[18]*i[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}tint(e,t){const[i,n,s]=de.shared.setValue(e).toArray(),o=[i,0,0,0,0,0,n,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,t)}greyscale(e,t){const i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}blackAndWhite(e){const t=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(t,e)}hue(e,t){e=(e||0)/180*Math.PI;const i=Math.cos(e),n=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=i+(1-i)*o,h=o*(1-i)-a*n,u=o*(1-i)+a*n,c=o*(1-i)+a*n,d=i+o*(1-i),f=o*(1-i)-a*n,p=o*(1-i)-a*n,v=o*(1-i)+a*n,x=i+o*(1-i),g=[l,h,u,0,0,c,d,f,0,0,p,v,x,0,0,0,0,0,1,0];this._loadMatrix(g,t)}contrast(e,t){const i=(e||0)+1,n=-.5*(i-1),s=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(s,t)}saturate(e=0,t){const i=e*2/3+1,n=(i-1)*-.5,s=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(s,t)}desaturate(){this.saturate(-1)}negative(e){const t=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(t,e)}sepia(e){const t=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(t,e)}technicolor(e){const t=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(t,e)}polaroid(e){const t=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(t,e)}toBGR(e){const t=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(t,e)}kodachrome(e){const t=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(t,e)}browni(e){const t=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(t,e)}vintage(e){const t=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(t,e)}colorTone(e,t,i,n,s){e=e||.2,t=t||.15,i=i||16770432,n=n||3375104;const o=de.shared,[a,l,h]=o.setValue(i).toArray(),[u,c,d]=o.setValue(n).toArray(),f=[.3,.59,.11,0,0,a,l,h,e,0,u,c,d,t,0,a-u,l-c,h-d,0,0];this._loadMatrix(f,s)}night(e,t){e=e||.1;const i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,t)}predator(e,t){const i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,t)}lsd(e){const t=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(t,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}Wc.prototype.grayscale=Wc.prototype.greyscale;var FA=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,NA=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class LA extends rt{constructor(e,t){const i=new pe;e.renderable=!1,super(NA,FA,{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,t==null&&(t=20),this.scale=new ne(t,t)}apply(e,t,i,n){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,t,i,n)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var UA=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,GA=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class zA extends rt{constructor(){super(GA,UA)}}var jA=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class HA extends rt{constructor(e=.5,t=Math.random()){super(Wv,jA,{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const Hm={AlphaFilter:IA,BlurFilter:BA,BlurFilterPass:Vc,ColorMatrixFilter:Wc,DisplacementFilter:LA,FXAAFilter:zA,NoiseFilter:HA};Object.entries(Hm).forEach(([r,e])=>{Object.defineProperty(Hm,r,{get(){return te("7.1.0",`filters.${r} has moved to ${r}`),e}})});class $A{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(gt.system.add(this.tickerUpdate,this,Hi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(gt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const $r=new $A;class _o{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=_o.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ne,this.page=new ne,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,i,n,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class yl extends _o{constructor(){super(...arguments),this.client=new ne,this.movement=new ne,this.offset=new ne,this.global=new ne,this.screen=new ne}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,i,n,s,o,a,l,h,u,c,d,f,p,v){throw new Error("Method not implemented.")}}class Ot extends yl{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class On extends yl{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}On.DOM_DELTA_PIXEL=0,On.DOM_DELTA_LINE=1,On.DOM_DELTA_PAGE=2;const VA=2048,WA=new ne,au=new ne;class XA{constructor(e){this.dispatch=new go,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((i,n)=>i.priority-n.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let i=0,n=t.length;i<n;i++)t[i].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){$r.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",n=this[i](this.rootTarget,this.rootTarget.eventMode,WA.set(e,t),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(e,t){if(!e.target)return;const i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let n=0,s=i.length-1;n<s;n++)if(e.currentTarget=i[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(e.currentTarget=i[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,i=this._allInteractiveElements){if(i.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const n=Array.isArray(t)?t:[t];for(let s=i.length-1;s>=0;s--)n.forEach(o=>{e.currentTarget=i[s],this.notifyTarget(e,o)})}propagationPath(e){const t=[e];for(let i=0;i<VA&&e!==this.rootTarget;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,i,n,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&($r.pauseUpdate=!1),e.interactiveChildren&&e.children){const u=e.children;for(let c=u.length-1;c>=0;c--){const d=u[c],f=this.hitTestMoveRecursive(d,this._isInteractive(t)?t:d.eventMode,i,n,s,o||s(e,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(e),f.push(e)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(t),h=e.isInteractive();return l&&h&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,i)&&n(e,i)?h?[e]:[]:null}hitTestRecursive(e,t,i,n,s){if(this._interactivePrune(e)||s(e,i))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&($r.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let h=l.length-1;h>=0;h--){const u=l[h],c=this.hitTestRecursive(u,this._isInteractive(t)?t:u.eventMode,i,n,s);if(c){if(c.length>0&&!c[c.length-1].parent)continue;const d=e.isInteractive();return(c.length>0||d)&&c.push(e),c}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&n(e,i)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,t){var i;if(e.hitArea&&(e.worldTransform.applyInverse(t,au),!e.hitArea.contains(au.x,au.y)))return!0;if(e._mask){const n=e._mask.isMaskData?e._mask.maskObject:e._mask;if(n&&!((i=n.containsPoint)!=null&&i.call(n,t)))return!0}return!1}hitTestFn(e,t){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(t):!1}notifyTarget(e,t){var s,o;t=t??e.type;const i=`on${t}`;(o=(s=e.currentTarget)[i])==null||o.call(s,e);const n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof Ot)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),t.pointerType==="touch")this.dispatchEvent(t,"touchstart");else if(t.pointerType==="mouse"||t.pointerType==="pen"){const n=t.button===2;this.dispatchEvent(t,n?"rightdown":"mousedown")}const i=this.trackingData(e.pointerId);i.pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){var l,h;if(!(e instanceof Ot)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.overTargets);if(((l=n.overTargets)==null?void 0:l.length)>0&&s!==t.target){const u=e.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(e,u,s);if(this.dispatchEvent(c,"pointerout"),i&&this.dispatchEvent(c,"mouseout"),!t.composedPath().includes(s)){const d=this.createPointerEvent(e,"pointerleave",s);for(d.eventPhase=d.AT_TARGET;d.target&&!t.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(c)}if(s!==t.target){const u=e.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(t,u);this.dispatchEvent(c,"pointerover"),i&&this.dispatchEvent(c,"mouseover");let d=s==null?void 0:s.parent;for(;d&&d!==this.rootTarget.parent&&d!==t.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const f=this.clonePointerEvent(t,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==s&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),i&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(c)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),t.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(h=t.target)==null?void 0:h.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){var o;if(!(e instanceof Ot)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.createPointerEvent(e),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;t.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof Ot)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId);if(t.overTargets){const i=e.pointerType==="mouse"||e.pointerType==="pen",n=this.findMountedTarget(t.overTargets),s=this.createPointerEvent(e,"pointerout",n);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Ot)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.pressTargetsByButton[e.button]);let o=s;if(s&&!i.composedPath().includes(s)){let a=s;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete n.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,n.clicksByButton[e.button]||(n.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:t});const l=n.clicksByButton[e.button];if(l.target===a.target&&t-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=t,a.detail=l.clickCount,a.pointerType==="mouse"){const h=a.button===2;this.dispatchEvent(a,h?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof Ot)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.findMountedTarget(t.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(i){let s=i;for(;s;)n.currentTarget=s,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(n)}mapWheel(e){if(!(e instanceof On)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let i=1;i<e.length&&e[i].parent===t;i++)t=e[i];return t}createPointerEvent(e,t,i){const n=this.allocateEvent(Ot);return this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof t=="string"&&(n.type=t),n}createWheelEvent(e){const t=this.allocateEvent(On);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const i=this.allocateEvent(Ot);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=t??i.type,i}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof Ot&&t instanceof Ot&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof yl&&t instanceof yl&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const i=e.currentTarget._events[t];if(i&&e.currentTarget.isInteractive())if("fn"in i)i.once&&e.currentTarget.removeListener(t,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let n=0,s=i.length;n<s&&!e.propagationImmediatelyStopped;n++)i[n].once&&e.currentTarget.removeListener(t,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,e)}}const YA=1,KA={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Xc=class Yc{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new XA(null),$r.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ot(null),this.rootWheelEvent=new On(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Yc.defaultEventFeatures},{set:(t,i,n)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=n),t[i]=n,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:i}=this.renderer;this.setTargetElement(t),this.resolution=i,Yc._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":t&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":t&&Object.assign(this.domElement.style,i);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let i=0,n=t.length;i<n;i++){const s=t[i],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,$r.pointerMoved();const t=this.normalizeToPointerData(e);for(let i=0,n=t.length;i<n;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const i=t!==this.domElement?"outside":"",n=this.normalizeToPointerData(e);for(let s=0,o=n.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,n[s]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);for(let i=0,n=t.length;i<n;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,$r.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;$r.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;$r.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,i){const n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(t-n.left)*(this.domElement.width/n.width)*s,e.y=(i-n.top)*(this.domElement.height/n.height)*s}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,n=e.changedTouches.length;i<n;i++){const s=e.changedTouches[i];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,t.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const i=e;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=YA),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,t.push(i)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=KA[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};Xc.extension={name:"events",type:[L.RendererSystem,L.CanvasRendererSystem]},Xc.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Kc=Xc;W.add(Kc);function $m(r){return r==="dynamic"||r==="static"}const qA={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??$m(Kc.defaultEventMode)},set interactive(r){te("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=r,this.eventMode=r?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Kc.defaultEventMode},set eventMode(r){this._internalInteractive=$m(r),this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,n=typeof t=="object"?t.signal:void 0,s=typeof t=="object"?t.once===!0:!1,o=typeof e=="function"?void 0:e;r=i?`${r}capture`:r;const a=typeof e=="function"?e:e.handleEvent,l=this;n&&n.addEventListener("abort",()=>{l.off(r,a,o)}),s?l.once(r,a,o):l.on(r,a,o)},removeEventListener(r,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,n=typeof e=="function"?void 0:e;r=i?`${r}capture`:r,e=typeof e=="function"?e:e.handleEvent,this.off(r,e,n)},dispatchEvent(r){if(!(r instanceof _o))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};Se.mixin(qA);const ZA={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Se.mixin(ZA);const QA=9,ea=100,JA=0,eC=0,Vm=2,Wm=1,tC=-1e3,rC=-1e3,iC=2;class tx{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Tr.tablet||Tr.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width=`${ea}px`,t.style.height=`${ea}px`,t.style.position="absolute",t.style.top=`${JA}px`,t.style.left=`${eC}px`,t.style.zIndex=Vm.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${Wm}px`,e.style.height=`${Wm}px`,e.style.position="absolute",e.style.top=`${tC}px`,e.style.left=`${rC}px`,e.style.zIndex=iC.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}update(){const e=performance.now();if(Tr.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:i,width:n,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,h=n/o*l,u=s/a*l;let c=this.div;c.style.left=`${t}px`,c.style.top=`${i}px`,c.style.width=`${o}px`,c.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,Dn(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{c=f._accessibleDiv;let p=f.hitArea;const v=f.worldTransform;f.hitArea?(c.style.left=`${(v.tx+p.x*v.a)*h}px`,c.style.top=`${(v.ty+p.y*v.d)*u}px`,c.style.width=`${p.width*v.a*h}px`,c.style.height=`${p.height*v.d*u}px`):(p=f.getBounds(),this.capHitArea(p),c.style.left=`${p.x*h}px`,c.style.top=`${p.y*u}px`,c.style.width=`${p.width*h}px`,c.style.height=`${p.height*u}px`,c.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(c.title=f.accessibleTitle),c.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&c.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==c.title||f.tabIndex!==c.tabIndex)&&(c.title=f.accessibleTitle,c.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:i}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>i&&(e.height=i-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=`${ea}px`,t.style.height=`${ea}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=Vm.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:i}=e.target,n=this.renderer.events.rootBoundary,s=Object.assign(new _o(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,t.forEach(o=>n.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===QA&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}tx.extension={name:"accessibility",type:[L.RendererPlugin,L.CanvasRendererPlugin]};W.add(tx);const rx=class qc{constructor(e){this.stage=new Pt,e=Object.assign({forceCanvas:!1},e),this.renderer=fA(e),qc._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,t){const i=qc._plugins.slice(0);i.reverse(),i.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};rx._plugins=[];let pf=rx;W.handleByList(L.Application,pf._plugins);class ix{static init(e){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let t,i;if(this._resizeTo===globalThis.window)t=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:s}=this._resizeTo;t=n,i=s}this.renderer.resize(t,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ix.extension=L.Application;W.add(ix);const Xm={loader:L.LoadParser,resolver:L.ResolveParser,cache:L.CacheParser,detection:L.DetectionParser};W.handle(L.Asset,r=>{const e=r.ref;Object.entries(Xm).filter(([t])=>!!e[t]).forEach(([t,i])=>W.add(Object.assign(e[t],{extension:e[t].extension??i})))},r=>{const e=r.ref;Object.keys(Xm).filter(t=>!!e[t]).forEach(t=>W.remove(e[t]))});class nC{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Jn(r,e){if(Array.isArray(e)){for(const t of e)if(r.startsWith(`data:${t}`))return!0;return!1}return r.startsWith(`data:${e}`)}function di(r,e){const t=r.split("?")[0],i=He.extname(t).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const Ut=(r,e,t=!1)=>(Array.isArray(r)||(r=[r]),e?r.map(i=>typeof i=="string"||t?e(i):i):r),Zc=(r,e)=>{const t=e.split("?")[1];return t&&(r+=`?${t}`),r};function nx(r,e,t,i,n){const s=e[t];for(let o=0;o<s.length;o++){const a=s[o];t<e.length-1?nx(r.replace(i[t],a),e,t+1,i,n):n.push(r.replace(i[t],a))}}function sC(r){const e=/\{(.*?)\}/g,t=r.match(e),i=[];if(t){const n=[];t.forEach(s=>{const o=s.substring(1,s.length-1).split(",");n.push(o)}),nx(r,n,0,t,i)}else i.push(r);return i}const vl=r=>!Array.isArray(r);class oC{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=Ut(e);let n;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(t)){n=l.getCacheableAssets(i,t);break}}n||(n={},i.forEach(a=>{n[a]=t}));const s=Object.keys(n),o={cacheKeys:s,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{const l=n?n[a]:t;this._cache.has(a)&&this._cache.get(a)!==l&&console.warn("[Cache] already has key:",a),this._cache.set(a,n[a])}),t instanceof $){const a=t;i.forEach(l=>{a.baseTexture!==$.EMPTY.baseTexture&&Q.addToCache(a.baseTexture,l),$.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(i=>{this._cache.delete(i)}),t.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Si=new oC;class aC{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let n=null,s=null;if(t.loadParser&&(s=this._parserHash[t.loadParser],s||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.load&&((o=h.test)!=null&&o.call(h,e,t,this))){s=h;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await s.load(e,t,this),i.parser=s;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];h.parse&&h.parse&&await((a=h.testParse)==null?void 0:a.call(h,n,t,this))&&(n=await h.parse(n,t,this)||n,i.parser=h)}return n})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const n={},s=vl(e),o=Ut(e,h=>({alias:[h],src:h})),a=o.length,l=o.map(async h=>{const u=He.toAbsolute(h.src);if(!n[h.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,h)),n[h.src]=await this.promiseCache[u].promise,t&&t(++i/a)}catch(c){throw delete this.promiseCache[u],delete n[h.src],new Error(`[Loader.load] Failed to load ${u}.
${c}`)}});return await Promise.all(l),s?n[o[0].src]:n}async unload(e){const t=Ut(e,i=>({alias:[i],src:i})).map(async i=>{var o,a;const n=He.toAbsolute(i.src),s=this.promiseCache[n];if(s){const l=await s.promise;delete this.promiseCache[n],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,i,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t}),{})}}var Vt=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Vt||{});const lC=".json",hC="application/json",uC={extension:{type:L.LoadParser,priority:Vt.Low},name:"loadJson",test(r){return Jn(r,hC)||di(r,lC)},async load(r){return await(await G.ADAPTER.fetch(r)).json()}};W.add(uC);const cC=".txt",dC="text/plain",fC={name:"loadTxt",extension:{type:L.LoadParser,priority:Vt.Low},test(r){return Jn(r,dC)||di(r,cC)},async load(r){return await(await G.ADAPTER.fetch(r)).text()}};W.add(fC);const pC=["normal","bold","100","200","300","400","500","600","700","800","900"],mC=[".ttf",".otf",".woff",".woff2"],gC=["font/ttf","font/otf","font/woff","font/woff2"],yC=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function vC(r){const e=He.extname(r),t=He.basename(r,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let i=t.length>0;for(const s of t)if(!s.match(yC)){i=!1;break}let n=t.join(" ");return i||(n=`"${n.replace(/[\\"]/g,"\\$&")}"`),n}const xC=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function _C(r){return xC.test(r)?r:encodeURI(r)}const wC={extension:{type:L.LoadParser,priority:Vt.Low},name:"loadWebFont",test(r){return Jn(r,gC)||di(r,mC)},async load(r,e){var i,n,s;const t=G.ADAPTER.getFontFaceSet();if(t){const o=[],a=((i=e.data)==null?void 0:i.family)??vC(r),l=((s=(n=e.data)==null?void 0:n.weights)==null?void 0:s.filter(u=>pC.includes(u)))??["normal"],h=e.data??{};for(let u=0;u<l.length;u++){const c=l[u],d=new FontFace(a,`url(${_C(r)})`,{...h,weight:c});await d.load(),t.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(e=>G.ADAPTER.getFontFaceSet().delete(e))}};W.add(wC);const EC=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Fn=null,Qc=class{constructor(){Fn||(Fn=URL.createObjectURL(new Blob([EC],{type:"application/javascript"}))),this.worker=new Worker(Fn)}};Qc.revokeObjectURL=function(){Fn&&(URL.revokeObjectURL(Fn),Fn=null)};const TC=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let Nn=null;class sx{constructor(){Nn||(Nn=URL.createObjectURL(new Blob([TC],{type:"application/javascript"}))),this.worker=new Worker(Nn)}}sx.revokeObjectURL=function(){Nn&&(URL.revokeObjectURL(Nn),Nn=null)};let Ym=0,lu;class SC{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new Qc;t.addEventListener("message",i=>{t.terminate(),Qc.revokeObjectURL(),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){lu===void 0&&(lu=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<lu&&(this._createdWorkers++,e=new sx().worker,e.addEventListener("message",t=>{this.complete(t.data),this.returnWorker(t.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise((n,s)=>{this.queue.push({id:e,arguments:t,resolve:n,reject:s})});return this.next(),i}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),i=t.id;this.resolveHash[Ym]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:Ym++,id:i})}}const Km=new SC;function wo(r,e,t){r.resource.internal=!0;const i=new $(r),n=()=>{delete e.promiseCache[t],Si.has(t)&&Si.remove(t)};return i.baseTexture.once("destroyed",()=>{t in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),n())}),i.once("destroyed",()=>{r.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),i}const bC=[".jpeg",".jpg",".png",".webp",".avif"],AC=["image/jpeg","image/png","image/webp","image/avif"];async function CC(r){const e=await G.ADAPTER.fetch(r);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${e.status} ${e.statusText}`);const t=await e.blob();return await createImageBitmap(t)}const ql={name:"loadTextures",extension:{type:L.LoadParser,priority:Vt.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return Jn(r,AC)||di(r,bC)},async load(r,e,t){var a;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let n;i?this.config.preferWorkers&&await Km.isImageBitmapSupported()?n=await Km.loadImageBitmap(r):n=await CC(r):n=await new Promise((l,h)=>{const u=new Image;u.crossOrigin=this.config.crossOrigin,u.src=r,u.complete?l(u):(u.onload=()=>l(u),u.onerror=c=>h(c))});const s={...e.data};s.resolution??(s.resolution=kr(r)),i&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new Q(n,s);return o.resource.src=r,wo(o,t,r)},unload(r){r.destroy(!0)}};W.add(ql);const IC=".svg",RC="image/svg+xml",PC={extension:{type:L.LoadParser,priority:Vt.High},name:"loadSVG",test(r){return Jn(r,RC)||di(r,IC)},async testParse(r){return zc.test(r)},async parse(r,e,t){var s;const i=new zc(r,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await i.load();const n=new Q(i,{resolution:kr(r),...e==null?void 0:e.data});return n.resource.src=e.src,wo(n,t,e.src)},async load(r,e){return(await G.ADAPTER.fetch(r)).text()},unload:ql.unload};W.add(PC);const MC=[".mp4",".m4v",".webm",".ogv"],kC=["video/mp4","video/webm","video/ogg"],DC={name:"loadVideo",extension:{type:L.LoadParser,priority:Vt.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(r){return Jn(r,kC)||di(r,MC)},async load(r,e,t){var o;let i;const n=await(await G.ADAPTER.fetch(r)).blob(),s=URL.createObjectURL(n);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions,autoLoad:!0},l=new Qv(s,a);await l.load();const h=new Q(l,{alphaMode:await US(),resolution:kr(r),...e==null?void 0:e.data});h.resource.src=r,i=wo(h,t,r),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return i},unload(r){r.destroy(!0)}};W.add(DC);class BC{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}}getAlias(e){const{alias:t,name:i,src:n,srcs:s}=e;return Ut(t||i||n||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const i=[];Array.isArray(t)?t.forEach(n=>{const s=n.src??n.srcs,o=n.alias??n.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);i.push(l),a=[o,l]}else{const l=o.map(h=>this._createBundleAssetId(e,h));i.push(...l),a=[...o,...l]}this.add({...n,alias:a,src:s})}):Object.keys(t).forEach(n=>{const s=[n,this._createBundleAssetId(e,n)];if(typeof t[n]=="string")this.add({alias:s,src:t[n]});else if(Array.isArray(t[n]))this.add({alias:s,src:t[n]});else{const o=t[n],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}i.push(...s)}),this._bundles[e]=i}add(e,t,i,n,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(te("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:t,data:i,format:n,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},Ut(o).forEach(l=>{const{src:h,srcs:u}=l;let{data:c,format:d,loadParser:f}=l;const p=Ut(h||u).map(g=>typeof g=="string"?sC(g):Array.isArray(g)?g:[g]),v=this.getAlias(l);Array.isArray(v)?v.forEach(a):a(v);const x=[];p.forEach(g=>{g.forEach(y=>{let m={};if(typeof y!="object"){m.src=y;for(let _=0;_<this._parsers.length;_++){const E=this._parsers[_];if(E.test(y)){m=E.parse(y);break}}}else c=y.data??c,d=y.format??d,f=y.loadParser??f,m={...m,...y};if(!v)throw new Error(`[Resolver] alias is undefined for this asset: ${m.src}`);m=this.buildResolvedAsset(m,{aliases:v,data:c,format:d,loadParser:f}),x.push(m)})}),v.forEach(g=>{this._assetMap[g]=x})})}resolveBundle(e){const t=vl(e);e=Ut(e);const i={};return e.forEach(n=>{const s=this._bundles[n];if(s){const o=this.resolve(s),a={};for(const l in o){const h=o[l];a[this._extractAssetIdFromBundle(n,l)]=h}i[n]=a}}),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const i={};for(const n in t)i[n]=t[n].src;return i}return t.src}resolve(e){const t=vl(e);e=Ut(e);const i={};return e.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let s=this._assetMap[n];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(h=>{const u=s.filter(c=>c[l]?c[l]===h:!1);u.length&&(s=u)})}),this._resolverHash[n]=s[0]??o}else this._resolverHash[n]=this.buildResolvedAsset({alias:[n],src:n},{});i[n]=this._resolverHash[n]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const i=e[0],n=this._preferredOrder.find(s=>s.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}buildResolvedAsset(e,t){const{aliases:i,data:n,loadParser:s,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=He.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??e.format??He.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class OC{constructor(){this._detections=[],this._initialized=!1,this.resolver=new BC,this.loader=new aC,this.cache=Si,this._backgroundLoader=new nC(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const t=((s=e.texturePreference)==null?void 0:s.resolution)??1,i=typeof t=="number"?[t]:t,n=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,i,n,s){this.resolver.add(e,t,i,n,s)}async load(e,t){this._initialized||await this.init();const i=vl(e),n=Ut(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(n),o=await this._mapLoadToResolve(s,t);return i?o[n[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const n=this.resolver.resolveBundle(e),s={},o=Object.keys(n);let a=0,l=0;const h=()=>{t==null||t(++a/l)},u=o.map(c=>{const d=n[c];return l+=Object.keys(d).length,this._mapLoadToResolve(d,h).then(f=>{s[c]=f})});return await Promise.all(u),i?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Si.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=Si.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=Object.values(e),n=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(i,t);this._backgroundLoader.active=!0;const o={};return i.forEach((a,l)=>{const h=s[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[n[l]]=h,Si.set(u,h)}),o}async unload(e){this._initialized||await this.init();const t=Ut(e).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=Ut(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(n=>this._unloadFromResolved(t[n]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(i=>{Si.remove(i.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((i,n)=>t.indexOf(i)===n),t}get detections(){return this._detections}get preferWorkers(){return ql.config.preferWorkers}set preferWorkers(e){te("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(i=>i in e).forEach(i=>{t.config[i]=e[i]})})}}const ta=new OC;W.handleByList(L.LoadParser,ta.loader.parsers).handleByList(L.ResolveParser,ta.resolver.parsers).handleByList(L.CacheParser,ta.cache.parsers).handleByList(L.DetectionParser,ta.detections);const FC={extension:L.CacheParser,test:r=>Array.isArray(r)&&r.every(e=>e instanceof $),getCacheableAssets:(r,e)=>{const t={};return r.forEach(i=>{e.forEach((n,s)=>{t[i+(s===0?"":s+1)]=n})}),t}};W.add(FC);async function ox(r){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(r)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const NC={extension:{type:L.DetectionParser,priority:1},test:async()=>ox("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(e=>e!=="avif")};W.add(NC);const LC={extension:{type:L.DetectionParser,priority:0},test:async()=>ox("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(e=>e!=="webp")};W.add(LC);const qm=["png","jpg","jpeg"],UC={extension:{type:L.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...qm],remove:async r=>r.filter(e=>!qm.includes(e))};W.add(UC);const GC="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function mf(r){return GC?!1:document.createElement("video").canPlayType(r)!==""}const zC={extension:{type:L.DetectionParser,priority:0},test:async()=>mf("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(e=>e!=="webm")};W.add(zC);const jC={extension:{type:L.DetectionParser,priority:0},test:async()=>mf("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(e=>e!=="mp4"&&e!=="m4v")};W.add(jC);const HC={extension:{type:L.DetectionParser,priority:0},test:async()=>mf("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(e=>e!=="ogv")};W.add(HC);const $C={extension:L.ResolveParser,test:ql.test,parse:r=>{var e;return{resolution:parseFloat(((e=G.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:He.extname(r).slice(1),src:r}}};W.add($C);var Ve=(r=>(r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r[r.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",r[r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",r[r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",r[r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",r))(Ve||{});const xl={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Qt,on;function Zm(){on={bptc:Qt.getExtension("EXT_texture_compression_bptc"),astc:Qt.getExtension("WEBGL_compressed_texture_astc"),etc:Qt.getExtension("WEBGL_compressed_texture_etc"),s3tc:Qt.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Qt.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Qt.getExtension("WEBGL_compressed_texture_pvrtc")||Qt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Qt.getExtension("WEBGL_compressed_texture_etc1"),atc:Qt.getExtension("WEBGL_compressed_texture_atc")}}const VC={extension:{type:L.DetectionParser,priority:2},test:async()=>{const r=G.ADAPTER.createCanvas().getContext("webgl");return r?(Qt=r,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async r=>{on||Zm();const e=[];for(const t in on)on[t]&&e.push(t);return[...e,...r]},remove:async r=>(on||Zm(),r.filter(e=>!(e in on)))};W.add(VC);class WC extends Vl{constructor(e,t={width:1,height:1,autoLoad:!0}){let i,n;typeof e=="string"?(i=e,n=new Uint8Array):(i=null,n=e),super(n,t),this.origin=i,this.buffer=n?new Ic(n):null,this._load=null,this.loaded=!1,this.origin!==null&&t.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new Ic(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Di extends WC{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=Di._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||Di._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,i){const n=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;n.pixelStorei(n.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:h,levelBuffer:u}=this._levelBuffers[s];n.compressedTexImage2D(n.TEXTURE_2D,a,this.format,l,h,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Di._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,t,i,n,s,o,a){const l=new Array(i);let h=e.byteOffset,u=o,c=a,d=u+n-1&~(n-1),f=c+s-1&~(s-1),p=d*f*xl[t];for(let v=0;v<i;v++)l[v]={levelID:v,levelWidth:i>1?u:d,levelHeight:i>1?c:f,levelBuffer:new Uint8Array(e.buffer,h,p)},h+=p,u=u>>1||1,c=c>>1||1,d=u+n-1&~(n-1),f=c+s-1&~(s-1),p=d*f*xl[t];return l}}const hu=4,ra=124,XC=32,Qm=20,YC=542327876,ia={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},KC={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},na={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},qC=1,ZC=2,QC=4,JC=64,eI=512,tI=131072,rI=827611204,iI=861165636,nI=894720068,sI=808540228,oI=4,aI={[rI]:Ve.COMPRESSED_RGBA_S3TC_DXT1_EXT,[iI]:Ve.COMPRESSED_RGBA_S3TC_DXT3_EXT,[nI]:Ve.COMPRESSED_RGBA_S3TC_DXT5_EXT},lI={70:Ve.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ve.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ve.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ve.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ve.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ve.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ve.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ve.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ve.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Ve.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Ve.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Ve.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Ve.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function hI(r){const e=new Uint32Array(r);if(e[0]!==YC)throw new Error("Invalid DDS file magic word");const t=new Uint32Array(r,0,ra/Uint32Array.BYTES_PER_ELEMENT),i=t[ia.HEIGHT],n=t[ia.WIDTH],s=t[ia.MIPMAP_COUNT],o=new Uint32Array(r,ia.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,XC/Uint32Array.BYTES_PER_ELEMENT),a=o[qC];if(a&QC){const l=o[KC.FOURCC];if(l!==sI){const y=aI[l],m=hu+ra,_=new Uint8Array(r,m);return[new Di(_,{format:y,width:n,height:i,levels:s})]}const h=hu+ra,u=new Uint32Array(e.buffer,h,Qm/Uint32Array.BYTES_PER_ELEMENT),c=u[na.DXGI_FORMAT],d=u[na.RESOURCE_DIMENSION],f=u[na.MISC_FLAG],p=u[na.ARRAY_SIZE],v=lI[c];if(v===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${c}`);if(f===oI)throw new Error("DDSParser does not support cubemap textures");if(d===6)throw new Error("DDSParser does not supported 3D texture data");const x=new Array,g=hu+ra+Qm;if(p===1)x.push(new Uint8Array(r,g));else{const y=xl[v];let m=0,_=n,E=i;for(let T=0;T<s;T++){const S=Math.max(1,_+3&-4),P=Math.max(1,E+3&-4),R=S*P*y;m+=R,_=_>>>1,E=E>>>1}let b=g;for(let T=0;T<p;T++)x.push(new Uint8Array(r,b,m)),b+=m}return x.map(y=>new Di(y,{format:v,width:n,height:i,levels:s}))}throw a&JC?new Error("DDSParser does not support uncompressed texture data."):a&eI?new Error("DDSParser does not supported YUV uncompressed texture data."):a&tI?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&ZC?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Jm=[171,75,84,88,32,49,49,187,13,10,26,10],uI=67305985,Dt={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Jc=64,eg={[Y.UNSIGNED_BYTE]:1,[Y.UNSIGNED_SHORT]:2,[Y.INT]:4,[Y.UNSIGNED_INT]:4,[Y.FLOAT]:4,[Y.HALF_FLOAT]:8},cI={[O.RGBA]:4,[O.RGB]:3,[O.RG]:2,[O.RED]:1,[O.LUMINANCE]:1,[O.LUMINANCE_ALPHA]:2,[O.ALPHA]:1},dI={[Y.UNSIGNED_SHORT_4_4_4_4]:2,[Y.UNSIGNED_SHORT_5_5_5_1]:2,[Y.UNSIGNED_SHORT_5_6_5]:2};function fI(r,e,t=!1){const i=new DataView(e);if(!pI(r,i))return null;const n=i.getUint32(Dt.ENDIANNESS,!0)===uI,s=i.getUint32(Dt.GL_TYPE,n),o=i.getUint32(Dt.GL_FORMAT,n),a=i.getUint32(Dt.GL_INTERNAL_FORMAT,n),l=i.getUint32(Dt.PIXEL_WIDTH,n),h=i.getUint32(Dt.PIXEL_HEIGHT,n)||1,u=i.getUint32(Dt.PIXEL_DEPTH,n)||1,c=i.getUint32(Dt.NUMBER_OF_ARRAY_ELEMENTS,n)||1,d=i.getUint32(Dt.NUMBER_OF_FACES,n),f=i.getUint32(Dt.NUMBER_OF_MIPMAP_LEVELS,n),p=i.getUint32(Dt.BYTES_OF_KEY_VALUE_DATA,n);if(h===0||u!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(c!==1)throw new Error("WebGL does not support array textures");const v=4,x=4,g=l+3&-4,y=h+3&-4,m=new Array(c);let _=l*h;s===0&&(_=g*y);let E;if(s!==0?eg[s]?E=eg[s]*cI[o]:E=dI[s]:E=xl[a],E===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const b=t?gI(i,p,n):null;let T=_*E,S=l,P=h,R=g,K=y,F=Jc+p;for(let A=0;A<f;A++){const D=i.getUint32(F,n);let k=F+4;for(let j=0;j<c;j++){let N=m[j];N||(N=m[j]=new Array(f)),N[A]={levelID:A,levelWidth:f>1||s!==0?S:R,levelHeight:f>1||s!==0?P:K,levelBuffer:new Uint8Array(e,k,T)},k+=T}F+=D+4,F=F%4!==0?F+4-F%4:F,S=S>>1||1,P=P>>1||1,R=S+v-1&~(v-1),K=P+x-1&~(x-1),T=R*K*E}return s!==0?{uncompressed:m.map(A=>{let D=A[0].levelBuffer,k=!1;return s===Y.FLOAT?D=new Float32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4):s===Y.UNSIGNED_INT?(k=!0,D=new Uint32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)):s===Y.INT&&(k=!0,D=new Int32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)),{resource:new Vl(D,{width:A[0].levelWidth,height:A[0].levelHeight}),type:s,format:k?mI(o):o}}),kvData:b}:{compressed:m.map(A=>new Di(null,{format:a,width:l,height:h,levels:f,levelBuffers:A})),kvData:b}}function pI(r,e){for(let t=0;t<Jm.length;t++)if(e.getUint8(t)!==Jm[t])return console.error(`${r} is not a valid *.ktx file!`),!1;return!0}function mI(r){switch(r){case O.RGBA:return O.RGBA_INTEGER;case O.RGB:return O.RGB_INTEGER;case O.RG:return O.RG_INTEGER;case O.RED:return O.RED_INTEGER;default:return r}}function gI(r,e,t){const i=new Map;let n=0;for(;n<e;){const s=r.getUint32(Jc+n,t),o=Jc+n+4,a=3-(s+3)%4;if(s===0||s>e-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&r.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(r.buffer,o,l)),u=new DataView(r.buffer,o+l+1,s-l-1);i.set(h,u),n+=4+s+a}return i}const yI={extension:{type:L.LoadParser,priority:Vt.High},name:"loadDDS",test(r){return di(r,".dds")},async load(r,e,t){const i=await(await G.ADAPTER.fetch(r)).arrayBuffer(),n=hI(i).map(s=>{const o=new Q(s,{mipmap:dr.OFF,alphaMode:lt.NO_PREMULTIPLIED_ALPHA,resolution:kr(r),...e.data});return wo(o,t,r)});return n.length===1?n[0]:n},unload(r){Array.isArray(r)?r.forEach(e=>e.destroy(!0)):r.destroy(!0)}};W.add(yI);const vI={extension:{type:L.LoadParser,priority:Vt.High},name:"loadKTX",test(r){return di(r,".ktx")},async load(r,e,t){const i=await(await G.ADAPTER.fetch(r)).arrayBuffer(),{compressed:n,uncompressed:s,kvData:o}=fI(r,i),a=n??s,l={mipmap:dr.OFF,alphaMode:lt.NO_PREMULTIPLIED_ALPHA,resolution:kr(r),...e.data},h=a.map(u=>{a===s&&Object.assign(l,{type:u.type,format:u.format});const c=u.resource??u,d=new Q(c,l);return d.ktxKeyValueData=o,wo(d,t,r)});return h.length===1?h[0]:h},unload(r){Array.isArray(r)?r.forEach(e=>e.destroy(!0)):r.destroy(!0)}};W.add(vI);const xI=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],_I={extension:L.ResolveParser,test:r=>{const e=He.extname(r).slice(1);return["basis","ktx","dds"].includes(e)},parse:r=>{var i,n;const e=r.split("."),t=e.pop();if(["ktx","dds"].includes(t)){const s=e.pop();if(xI.includes(s))return{resolution:parseFloat(((i=G.RETINA_PREFIX.exec(r))==null?void 0:i[1])??"1"),format:s,src:r}}return{resolution:parseFloat(((n=G.RETINA_PREFIX.exec(r))==null?void 0:n[1])??"1"),format:t,src:r}}};W.add(_I);const sa=new J,wI=4,ax=class Es{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,i,n){const s=new Image;return s.src=await this.base64(e,t,i,n),s}async base64(e,t,i,n){const s=this.canvas(e,n);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const h=new FileReader;h.onload=()=>o(h.result),h.onerror=a,h.readAsDataURL(l)},t,i)});if(s.toDataURL!==void 0)return s.toDataURL(t,i);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:t,quality:i});return new Promise((a,l)=>{const h=new FileReader;h.onload=()=>a(h.result),h.onerror=l,h.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);o&&Es._flipY(i,n,s),a&&Es._unpremultiplyAlpha(i);const l=new tb(n,s,1),h=new ImageData(new Uint8ClampedArray(i.buffer),n,s);return l.context.putImageData(h,0,0),l.canvas}pixels(e,t){const{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);return o&&Es._flipY(i,n,s),a&&Es._unpremultiplyAlpha(i),i}_rawPixels(e,t){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let n,s=!1,o=!1,a,l=!1;e&&(e instanceof Yi?a=e:(a=i.generateTexture(e,{region:t,resolution:i.resolution,multisample:i.multisample}),l=!0,t&&(sa.width=t.width,sa.height=t.height,t=sa)));const h=i.gl;if(a){if(n=a.baseTexture.resolution,t=t??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===O.RGBA,!l){i.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[i.CONTEXT_UID];f.blitFramebuffer&&i.framebuffer.bind(f.blitFramebuffer)}}else n=i.resolution,t||(t=sa,t.width=i.width/n,t.height=i.height/n),s=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const u=Math.max(Math.round(t.width*n),1),c=Math.max(Math.round(t.height*n),1),d=new Uint8Array(wI*u*c);return h.readPixels(Math.round(t.x*n),Math.round(t.y*n),u,c,h.RGBA,h.UNSIGNED_BYTE,d),l&&(a==null||a.destroy(!0)),{pixels:d,width:u,height:c,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,t,i){const n=t<<2,s=i>>1,o=new Uint8Array(n);for(let a=0;a<s;a++){const l=a*n,h=(i-a-1)*n;o.set(e.subarray(l,l+n)),e.copyWithin(l,h,h+n),e.set(o,h)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let i=0;i<t;i+=4){const n=e[i+3];if(n!==0){const s=255.001/n;e[i]=e[i]*s+.5,e[i+1]=e[i+1]*s+.5,e[i+2]=e[i+2]*s+.5}}}};ax.extension={name:"extract",type:L.RendererSystem};let EI=ax;W.add(EI);const _l={build(r){const e=r.points;let t,i,n,s,o,a;if(r.type===Xe.CIRC){const p=r.shape;t=p.x,i=p.y,o=a=p.radius,n=s=0}else if(r.type===Xe.ELIP){const p=r.shape;t=p.x,i=p.y,o=p.width,a=p.height,n=s=0}else{const p=r.shape,v=p.width/2,x=p.height/2;t=p.x+v,i=p.y+x,o=a=Math.max(0,Math.min(p.radius,Math.min(v,x))),n=v-o,s=x-a}if(!(o>=0&&a>=0&&n>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),h=l*8+(n?4:0)+(s?4:0);if(e.length=h,h===0)return;if(l===0){e.length=8,e[0]=e[6]=t+n,e[1]=e[3]=i+s,e[2]=e[4]=t-n,e[5]=e[7]=i-s;return}let u=0,c=l*4+(n?2:0)+2,d=c,f=h;{const p=n+o,v=s,x=t+p,g=t-p,y=i+v;if(e[u++]=x,e[u++]=y,e[--c]=y,e[--c]=g,s){const m=i-v;e[d++]=g,e[d++]=m,e[--f]=m,e[--f]=x}}for(let p=1;p<l;p++){const v=Math.PI/2*(p/l),x=n+Math.cos(v)*o,g=s+Math.sin(v)*a,y=t+x,m=t-x,_=i+g,E=i-g;e[u++]=y,e[u++]=_,e[--c]=_,e[--c]=m,e[d++]=m,e[d++]=E,e[--f]=E,e[--f]=y}{const p=n,v=s+a,x=t+p,g=t-p,y=i+v,m=i-v;e[u++]=x,e[u++]=y,e[--f]=m,e[--f]=x,n&&(e[u++]=g,e[u++]=y,e[--f]=m,e[--f]=g)}},triangulate(r,e){const t=r.points,i=e.points,n=e.indices;if(t.length===0)return;let s=i.length/2;const o=s;let a,l;if(r.type!==Xe.RREC){const u=r.shape;a=u.x,l=u.y}else{const u=r.shape;a=u.x+u.width/2,l=u.y+u.height/2}const h=r.matrix;i.push(r.matrix?h.a*a+h.c*l+h.tx:a,r.matrix?h.b*a+h.d*l+h.ty:l),s++,i.push(t[0],t[1]);for(let u=2;u<t.length;u+=2)i.push(t[u],t[u+1]),n.push(s++,o,s);n.push(o+1,o,s)}};function tg(r,e=!1){const t=r.length;if(t<6)return;let i=0;for(let n=0,s=r[t-2],o=r[t-1];n<t;n+=2){const a=r[n],l=r[n+1];i+=(a-s)*(l+o),s=a,o=l}if(!e&&i>0||e&&i<=0){const n=t/2;for(let s=n+n%2;s<t;s+=2){const o=t-s-2,a=t-s-1,l=s,h=s+1;[r[o],r[l]]=[r[l],r[o]],[r[a],r[h]]=[r[h],r[a]]}}}const lx={build(r){r.points=r.shape.points.slice()},triangulate(r,e){let t=r.points;const i=r.holes,n=e.points,s=e.indices;if(t.length>=6){tg(t,!1);const o=[];for(let h=0;h<i.length;h++){const u=i[h];tg(u.points,!0),o.push(t.length/2),t=t.concat(u.points)}const a=bw(t,o,2);if(!a)return;const l=n.length/2;for(let h=0;h<a.length;h+=3)s.push(a[h]+l),s.push(a[h+1]+l),s.push(a[h+2]+l);for(let h=0;h<t.length;h++)n.push(t[h])}}},TI={build(r){const e=r.shape,t=e.x,i=e.y,n=e.width,s=e.height,o=r.points;o.length=0,n>=0&&s>=0&&o.push(t,i,t+n,i,t+n,i+s,t,i+s)},triangulate(r,e){const t=r.points,i=e.points;if(t.length===0)return;const n=i.length/2;i.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},SI={build(r){_l.build(r)},triangulate(r,e){_l.triangulate(r,e)}};var wt=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(wt||{}),Kr=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(Kr||{});const Xn={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,e=20){if(!this.adaptive||!r||isNaN(r))return e;let t=Math.ceil(r/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}};class rg{static curveTo(e,t,i,n,s,o){const a=o[o.length-2],l=o[o.length-1]-t,h=a-e,u=n-t,c=i-e,d=Math.abs(l*c-h*u);if(d<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;const f=l*l+h*h,p=u*u+c*c,v=l*u+h*c,x=s*Math.sqrt(f)/d,g=s*Math.sqrt(p)/d,y=x*v/f,m=g*v/p,_=x*c+g*h,E=x*u+g*l,b=h*(g+y),T=l*(g+y),S=c*(x+m),P=u*(x+m),R=Math.atan2(T-E,b-_),K=Math.atan2(P-E,S-_);return{cx:_+e,cy:E+t,radius:s,startAngle:R,endAngle:K,anticlockwise:h*u>c*l}}static arc(e,t,i,n,s,o,a,l,h){const u=a-o,c=Xn._segmentsCount(Math.abs(u)*s,Math.ceil(Math.abs(u)/cl)*40),d=u/(c*2),f=d*2,p=Math.cos(d),v=Math.sin(d),x=c-1,g=x%1/x;for(let y=0;y<=x;++y){const m=y+g*y,_=d+o+f*m,E=Math.cos(_),b=-Math.sin(_);h.push((p*E+v*b)*s+i,(p*-b+v*E)*s+n)}}}class bI{constructor(){this.reset()}begin(e,t,i){this.reset(),this.style=e,this.start=t,this.attribStart=i}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class gf{static curveLength(e,t,i,n,s,o,a,l){let h=0,u=0,c=0,d=0,f=0,p=0,v=0,x=0,g=0,y=0,m=0,_=e,E=t;for(let b=1;b<=10;++b)u=b/10,c=u*u,d=c*u,f=1-u,p=f*f,v=p*f,x=v*e+3*p*u*i+3*f*c*s+d*a,g=v*t+3*p*u*n+3*f*c*o+d*l,y=_-x,m=E-g,_=x,E=g,h+=Math.sqrt(y*y+m*m);return h}static curveTo(e,t,i,n,s,o,a){const l=a[a.length-2],h=a[a.length-1];a.length-=2;const u=Xn._segmentsCount(gf.curveLength(l,h,e,t,i,n,s,o));let c=0,d=0,f=0,p=0,v=0;a.push(l,h);for(let x=1,g=0;x<=u;++x)g=x/u,c=1-g,d=c*c,f=d*c,p=g*g,v=p*g,a.push(f*l+3*d*g*e+3*c*p*i+v*s,f*h+3*d*g*t+3*c*p*n+v*o)}}function ig(r,e,t,i,n,s,o,a){const l=r-t*n,h=e-i*n,u=r+t*s,c=e+i*s;let d,f;o?(d=i,f=-t):(d=-i,f=t);const p=l+d,v=h+f,x=u+d,g=c+f;return a.push(p,v,x,g),2}function pi(r,e,t,i,n,s,o,a){const l=t-r,h=i-e;let u=Math.atan2(l,h),c=Math.atan2(n-r,s-e);a&&u<c?u+=Math.PI*2:!a&&u>c&&(c+=Math.PI*2);let d=u;const f=c-u,p=Math.abs(f),v=Math.sqrt(l*l+h*h),x=(15*p*Math.sqrt(v)/Math.PI>>0)+1,g=f/x;if(d+=g,a){o.push(r,e,t,i);for(let y=1,m=d;y<x;y++,m+=g)o.push(r,e,r+Math.sin(m)*v,e+Math.cos(m)*v);o.push(r,e,n,s)}else{o.push(t,i,r,e);for(let y=1,m=d;y<x;y++,m+=g)o.push(r+Math.sin(m)*v,e+Math.cos(m)*v,r,e);o.push(n,s,r,e)}return x*2}function AI(r,e){const t=r.shape;let i=r.points||t.points.slice();const n=e.closePointEps;if(i.length===0)return;const s=r.lineStyle,o=new ne(i[0],i[1]),a=new ne(i[i.length-2],i[i.length-1]),l=t.type!==Xe.POLY||t.closeStroke,h=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(l){i=i.slice(),h&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const N=(o.x+a.x)*.5,I=(a.y+o.y)*.5;i.unshift(N,I),i.push(N,I)}const u=e.points,c=i.length/2;let d=i.length;const f=u.length/2,p=s.width/2,v=p*p,x=s.miterLimit*s.miterLimit;let g=i[0],y=i[1],m=i[2],_=i[3],E=0,b=0,T=-(y-_),S=g-m,P=0,R=0,K=Math.sqrt(T*T+S*S);T/=K,S/=K,T*=p,S*=p;const F=s.alignment,A=(1-F)*2,D=F*2;l||(s.cap===Kr.ROUND?d+=pi(g-T*(A-D)*.5,y-S*(A-D)*.5,g-T*A,y-S*A,g+T*D,y+S*D,u,!0)+2:s.cap===Kr.SQUARE&&(d+=ig(g,y,T,S,A,D,!0,u))),u.push(g-T*A,y-S*A,g+T*D,y+S*D);for(let N=1;N<c-1;++N){g=i[(N-1)*2],y=i[(N-1)*2+1],m=i[N*2],_=i[N*2+1],E=i[(N+1)*2],b=i[(N+1)*2+1],T=-(y-_),S=g-m,K=Math.sqrt(T*T+S*S),T/=K,S/=K,T*=p,S*=p,P=-(_-b),R=m-E,K=Math.sqrt(P*P+R*R),P/=K,R/=K,P*=p,R*=p;const I=m-g,z=y-_,C=m-E,M=b-_,q=I*C+z*M,se=z*C-M*I,ie=se<0;if(Math.abs(se)<.001*Math.abs(q)){u.push(m-T*A,_-S*A,m+T*D,_+S*D),q>=0&&(s.join===wt.ROUND?d+=pi(m,_,m-T*A,_-S*A,m-P*A,_-R*A,u,!1)+4:d+=2,u.push(m-P*D,_-R*D,m+P*A,_+R*A));continue}const be=(-T+g)*(-S+_)-(-T+m)*(-S+y),le=(-P+E)*(-R+_)-(-P+m)*(-R+b),ve=(I*le-C*be)/se,qe=(M*be-z*le)/se,dt=(ve-m)*(ve-m)+(qe-_)*(qe-_),$e=m+(ve-m)*A,me=_+(qe-_)*A,Pe=m-(ve-m)*D,De=_-(qe-_)*D,Wt=Math.min(I*I+z*z,C*C+M*M),Xt=ie?A:D,es=Wt+Xt*Xt*v,Cx=dt<=es;let Eo=s.join;if(Eo===wt.MITER&&dt/v>x&&(Eo=wt.BEVEL),Cx)switch(Eo){case wt.MITER:{u.push($e,me,Pe,De);break}case wt.BEVEL:{ie?u.push($e,me,m+T*D,_+S*D,$e,me,m+P*D,_+R*D):u.push(m-T*A,_-S*A,Pe,De,m-P*A,_-R*A,Pe,De),d+=2;break}case wt.ROUND:{ie?(u.push($e,me,m+T*D,_+S*D),d+=pi(m,_,m+T*D,_+S*D,m+P*D,_+R*D,u,!0)+4,u.push($e,me,m+P*D,_+R*D)):(u.push(m-T*A,_-S*A,Pe,De),d+=pi(m,_,m-T*A,_-S*A,m-P*A,_-R*A,u,!1)+4,u.push(m-P*A,_-R*A,Pe,De));break}}else{switch(u.push(m-T*A,_-S*A,m+T*D,_+S*D),Eo){case wt.MITER:{ie?u.push(Pe,De,Pe,De):u.push($e,me,$e,me),d+=2;break}case wt.ROUND:{ie?d+=pi(m,_,m+T*D,_+S*D,m+P*D,_+R*D,u,!0)+2:d+=pi(m,_,m-T*A,_-S*A,m-P*A,_-R*A,u,!1)+2;break}}u.push(m-P*A,_-R*A,m+P*D,_+R*D),d+=2}}g=i[(c-2)*2],y=i[(c-2)*2+1],m=i[(c-1)*2],_=i[(c-1)*2+1],T=-(y-_),S=g-m,K=Math.sqrt(T*T+S*S),T/=K,S/=K,T*=p,S*=p,u.push(m-T*A,_-S*A,m+T*D,_+S*D),l||(s.cap===Kr.ROUND?d+=pi(m-T*(A-D)*.5,_-S*(A-D)*.5,m-T*A,_-S*A,m+T*D,_+S*D,u,!1)+2:s.cap===Kr.SQUARE&&(d+=ig(m,_,T,S,A,D,!1,u)));const k=e.indices,j=Xn.epsilon*Xn.epsilon;for(let N=f;N<d+f-2;++N)g=u[N*2],y=u[N*2+1],m=u[(N+1)*2],_=u[(N+1)*2+1],E=u[(N+2)*2],b=u[(N+2)*2+1],!(Math.abs(g*(_-b)+m*(b-y)+E*(y-_))<j)&&k.push(N,N+1,N+2)}function CI(r,e){let t=0;const i=r.shape,n=r.points||i.points,s=i.type!==Xe.POLY||i.closeStroke;if(n.length===0)return;const o=e.points,a=e.indices,l=n.length/2,h=o.length/2;let u=h;for(o.push(n[0],n[1]),t=1;t<l;t++)o.push(n[t*2],n[t*2+1]),a.push(u,u+1),u++;s&&a.push(u,h)}function ng(r,e){r.lineStyle.native?CI(r,e):AI(r,e)}class yf{static curveLength(e,t,i,n,s,o){const a=e-2*i+s,l=t-2*n+o,h=2*i-2*e,u=2*n-2*t,c=4*(a*a+l*l),d=4*(a*h+l*u),f=h*h+u*u,p=2*Math.sqrt(c+d+f),v=Math.sqrt(c),x=2*c*v,g=2*Math.sqrt(f),y=d/v;return(x*p+v*d*(p-g)+(4*f*c-d*d)*Math.log((2*v+y+p)/(y+g)))/(4*x)}static curveTo(e,t,i,n,s){const o=s[s.length-2],a=s[s.length-1],l=Xn._segmentsCount(yf.curveLength(o,a,e,t,i,n));let h=0,u=0;for(let c=1;c<=l;++c){const d=c/l;h=o+(e-o)*d,u=a+(t-a)*d,s.push(h+(e+(i-e)*d-h)*d,u+(t+(n-t)*d-u)*d)}}}const uu={[Xe.POLY]:lx,[Xe.CIRC]:_l,[Xe.ELIP]:_l,[Xe.RECT]:TI,[Xe.RREC]:SI},sg=[],oa=[];class wl{constructor(e,t=null,i=null,n=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=t,this.matrix=n,this.type=e.type}clone(){return new wl(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const en=new ne,hx=class ux extends mv{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new gl,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),oa.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),sg.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,i=null,n=null){const s=new wl(e,t,i,n);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const i=new wl(e,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=n.lineStyle,n.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let i=0;i<t.length;++i){const n=t[i];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(e,en):en.copyFrom(e),n.shape.contains(en.x,en.y))){let s=!1;if(n.holes){for(let o=0;o<n.holes.length;o++)if(n.holes[o].shape.contains(en.x,en.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let i=null,n=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],n=i.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const h=t[l],u=h.fillStyle,c=h.lineStyle;uu[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(u.visible||c.visible)&&this.processHoles(h.holes);for(let d=0;d<2;d++){const f=d===0?u:c;if(!f.visible)continue;const p=f.texture.baseTexture,v=this.indices.length,x=this.points.length/2;p.wrapMode=ni.REPEAT,d===0?this.processFill(h):this.processLine(h);const g=this.points.length/2-x;g!==0&&(i&&!this._compareStyles(n,f)&&(i.end(v,x),i=null),i||(i=sg.pop()||new bI,i.begin(f,v,x),this.batches.push(i),n=f),this.addUvs(this.points,e,f.texture,x,g,f.matrix))}}const s=this.indices.length,o=this.points.length/2;if(i&&i.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const i=this.graphicsData[e],n=i.fillStyle,s=i.lineStyle;if(n&&!n.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,i=e.length;t<i;t++){const n=e[t];for(let s=0;s<n.size;s++){const o=n.start+s;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<ux.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++Q._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),oa.push(this.drawCalls[c]);this.drawCalls.length=0;const t=this.colors,i=this.textureIds;let n=oa.pop();n||(n=new Mc,n.texArray=new Oc),n.texArray.count=0,n.start=0,n.size=0,n.type=or.TRIANGLES;let s=0,o=null,a=0,l=!1,h=or.TRIANGLES,u=0;this.drawCalls.push(n);for(let c=0;c<this.batches.length;c++){const d=this.batches[c],f=8,p=d.style,v=p.texture.baseTexture;l!==!!p.native&&(l=!!p.native,h=l?or.LINES:or.TRIANGLES,o=null,s=f,e++),o!==v&&(o=v,v._batchEnabled!==e&&(s===f&&(e++,s=0,n.size>0&&(n=oa.pop(),n||(n=new Mc,n.texArray=new Oc),this.drawCalls.push(n)),n.start=u,n.size=0,n.texArray.count=0,n.type=h),v.touched=1,v._batchEnabled=e,v._batchLocation=s,v.wrapMode=ni.REPEAT,n.texArray.elements[n.texArray.count++]=v,s++)),n.size+=d.size,u+=d.size,a=v._batchLocation,this.addColors(t,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(i,a,d.attribSize,d.attribStart)}Q._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,i=this.colors,n=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let h=0;h<e.length/2;h++)o[l++]=e[h*2],o[l++]=e[h*2+1],o[l++]=t[h*2],o[l++]=t[h*2+1],a[l++]=i[h],o[l++]=n[h];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?lx.triangulate(e,this):uu[e.type].triangulate(e,this)}processLine(e){ng(e,this);for(let t=0;t<e.holes.length;t++)ng(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const i=e[t];uu[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let i=0;i<e.length/2;i++){const n=e[i*2],s=e[i*2+1];e[i*2]=t.a*n+t.c*s+t.tx,e[i*2+1]=t.b*n+t.d*s+t.ty}}addColors(e,t,i,n,s=0){const o=de.shared.setValue(t).toLittleEndianNumber(),a=de.shared.setValue(o).toPremultiplied(i);e.length=Math.max(e.length,s+n);for(let l=0;l<n;l++)e[s+l]=a}addTextureIds(e,t,i,n=0){e.length=Math.max(e.length,n+i);for(let s=0;s<i;s++)e[n+s]=t}addUvs(e,t,i,n,s,o=null){let a=0;const l=t.length,h=i.frame;for(;a<s;){let c=e[(n+a)*2],d=e[(n+a)*2+1];if(o){const f=o.a*c+o.c*d+o.tx;d=o.b*c+o.d*d+o.ty,c=f}a++,t.push(c/h.width,d/h.height)}const u=i.baseTexture;(h.width<u.width||h.height<u.height)&&this.adjustUvs(t,i,l,s)}adjustUvs(e,t,i,n){const s=t.baseTexture,o=1e-6,a=i+n*2,l=t.frame,h=l.width/s.width,u=l.height/s.height;let c=l.x/l.width,d=l.y/l.height,f=Math.floor(e[i]+o),p=Math.floor(e[i+1]+o);for(let v=i+2;v<a;v+=2)f=Math.min(f,Math.floor(e[v]+o)),p=Math.min(p,Math.floor(e[v+1]+o));c-=f,d-=p;for(let v=i;v<a;v+=2)e[v]=(e[v]+c)*h,e[v+1]=(e[v+1]+d)*u}};hx.BATCHABLE_SIZE=100;let II=hx;class Zl{constructor(){this.color=16777215,this.alpha=1,this.texture=$.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new Zl;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=$.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class vf extends Zl{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Kr.BUTT,this.join=wt.MITER,this.miterLimit=10}clone(){const e=new vf;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Kr.BUTT,this.join=wt.MITER,this.miterLimit=10}}const cu={},ed=class Ma extends Pt{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Zl,this._lineStyle=new vf,this._matrix=null,this._holeMode=!1,this.state=pr.for2d(),this._geometry=e||new II,this._geometry.refCount++,this._transformID=-1,this._tintColor=new de(16777215),this.blendMode=Z.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Ma(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,i,n=.5,s=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:i,alignment:n,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:$.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Kr.BUTT,join:wt.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new ki,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new ki,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,n=i[i.length-2],s=i[i.length-1];return(n!==e||s!==t)&&i.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,i,n){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),yf.curveTo(e,t,i,n,s),this}bezierCurveTo(e,t,i,n,s,o){return this._initCurve(),gf.curveTo(e,t,i,n,s,o,this.currentPath.points),this}arcTo(e,t,i,n,s){this._initCurve(e,t);const o=this.currentPath.points,a=rg.curveTo(e,t,i,n,s,o);if(a){const{cx:l,cy:h,radius:u,startAngle:c,endAngle:d,anticlockwise:f}=a;this.arc(l,h,u,c,d,f)}return this}arc(e,t,i,n,s,o=!1){if(n===s)return this;if(!o&&s<=n?s+=cl:o&&n<=s&&(n+=cl),s-n===0)return this;const a=e+Math.cos(n)*i,l=t+Math.sin(n)*i,h=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const c=Math.abs(u[u.length-2]-a),d=Math.abs(u[u.length-1]-l);c<h&&d<h||u.push(a,l)}else this.moveTo(a,l),u=this.currentPath.points;return rg.arc(a,l,e,t,i,n,s,o,u),this}beginFill(e=0,t){return this.beginTextureFill({texture:$.WHITE,color:e,alpha:t})}normalizeColor(e){const t=de.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:$.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,i,n){return this.drawShape(new J(e,t,i,n))}drawRoundedRect(e,t,i,n,s){return this.drawShape(new Yl(e,t,i,n,s))}drawCircle(e,t,i){return this.drawShape(new Wl(e,t,i))}drawEllipse(e,t,i,n){return this.drawShape(new Xl(e,t,i,n))}drawPolygon(...e){let t,i=!0;const n=e[0];n.points?(i=n.closeStroke,t=n.points):Array.isArray(e[0])?t=e[0]:t=e;const s=new ki(t);return s.closeStroke=i,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===Xe.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(let n=0;n<i;n++){const s=e.batches[n],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),h=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),u={vertexData:a,blendMode:t,indices:h,uvs:l,_batchRGB:de.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[n]=u}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,i=this.batches.length;t<i;t++){const n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,e.plugins[this.pluginName].render(n)}}}_renderDirect(e){const t=this._resolveDirectShader(e),i=this._geometry,n=this.worldAlpha,s=t.uniforms,o=i.drawCalls;s.translationMatrix=this.transform.worldTransform,de.shared.setValue(this._tintColor).premultiply(n).toArray(s.tint),e.shader.bind(t),e.geometry.bind(i,t),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,i.drawCalls[a])}_renderDrawCallDirect(e,t){const{texArray:i,type:n,size:s,start:o}=t,a=i.count;for(let l=0;l<a;l++)e.texture.bind(i.elements[l],l);e.geometry.draw(n,s,o)}_resolveDirectShader(e){let t=this.shader;const i=this.pluginName;if(!t){if(!cu[i]){const{maxTextures:n}=e.plugins[i],s=new Int32Array(n);for(let l=0;l<n;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new pe,default:Ht.from({uSamplers:s},!0)},a=e.plugins[i]._shader.program;cu[i]=new ur(a,o)}t=cu[i]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:i,maxX:n,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,t,i,n,s)}containsPoint(e){return this.worldTransform.applyInverse(e,Ma._TEMP_POINT),this._geometry.containsPoint(Ma._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=de.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,i=t.a,n=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,h=this._geometry.points,u=this.vertexData;let c=0;for(let d=0;d<h.length;d+=2){const f=h[d],p=h[d+1];u[c++]=i*f+s*p+a,u[c++]=o*p+n*f+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};ed.curves=Xn,ed._TEMP_POINT=new ne;let Tn=ed;class RI{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const du=new ne,og=new ki,cx=class dx extends Pt{constructor(e,t,i,n=or.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=i||pr.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=G.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===or.TRIANGLES&&t.length<dx.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const n=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[n]),e.plugins[n].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,i=e._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,l=n.d,h=n.tx,u=n.ty,c=this.vertexData;for(let d=0;d<c.length/2;d++){const f=t[d*2],p=t[d*2+1];c[d*2]=s*f+a*p+h,c[d*2+1]=o*f+l*p+u}if(this._roundPixels){const d=G.RESOLUTION;for(let f=0;f<c.length;++f)c[f]=Math.round(c[f]*d)/d}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new RI(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,du);const t=this.geometry.getBuffer("aVertexPosition").data,i=og.points,n=this.geometry.getIndex().data,s=n.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=n[a]*2,h=n[a+1]*2,u=n[a+2]*2;if(i[0]=t[l],i[1]=t[l+1],i[2]=t[h],i[3]=t[h+1],i[4]=t[u],i[5]=t[u+1],og.contains(du.x,du.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};cx.BATCHABLE_SIZE=100;let ag=cx;class PI extends ai{constructor(e,t,i){super();const n=new Ie(e),s=new Ie(t,!0),o=new Ie(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,Y.FLOAT).addAttribute("aTextureCoord",s,2,!1,Y.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var MI=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,kI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class lg extends ur{constructor(e,t){const i={uSampler:e,alpha:1,uTextureMatrix:pe.IDENTITY,uColor:new Float32Array([1,1,1,1])};t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t),t.uniforms&&Object.assign(i,t.uniforms),super(t.program||br.from(kI,MI),i),this._colorDirty=!1,this.uvMatrix=new Rv(e),this.batchable=t.program===void 0,this.pluginName=t.pluginName,this._tintColor=new de(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;de.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class hg{constructor(e,t,i){this.geometry=new ai,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<e.length;++n){let s=e[n];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||Y.FLOAT,offset:s.offset},t[n]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new Ie(JS(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=t,t+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Ie(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=n,n+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Ie(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===Y.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===Y.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,t,i){for(let n=0;n<this.dynamicProperties.length;n++){const s=this.dynamicProperties[n];s.uploadFunction(e,t,i,s.type===Y.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,i){for(let n=0;n<this.staticProperties.length;n++){const s=this.staticProperties[n];s.uploadFunction(e,t,i,s.type===Y.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var DI=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,BI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class fx extends Kl{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new pe,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Y.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=ur.from(BI,DI,{}),this.state=pr.for2d()}render(e){const t=e.children,i=e._maxSize,n=e._batchSize,s=this.renderer;let o=t.length;if(o===0)return;o>i&&!e.autoResize&&(o=i);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=t[0]._texture.baseTexture,h=l.alphaMode>0;this.state.blendMode=dv(e.blendMode,h),s.state.set(this.state);const u=s.gl,c=e.worldTransform.copyTo(this.tempMatrix);c.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=de.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=n,p+=1){let v=o-f;v>n&&(v=n),p>=a.length&&a.push(this._generateOneMoreBuffer(e));const x=a[p];x.uploadDynamic(t,f,v);const g=e._bufferUpdateIDs[p]||0;d=d||x._updateID<g,d&&(x._updateID=e._updateID,x.uploadStatic(t,f,v)),s.geometry.bind(x.geometry),u.drawElements(u.TRIANGLES,v*6,u.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],i=e._maxSize,n=e._batchSize,s=e._properties;for(let o=0;o<i;o+=n)t.push(new hg(this.properties,s,n));return t}_generateOneMoreBuffer(e){const t=e._batchSize,i=e._properties;return new hg(this.properties,i,t)}uploadVertices(e,t,i,n,s,o){let a=0,l=0,h=0,u=0;for(let c=0;c<i;++c){const d=e[t+c],f=d._texture,p=d.scale.x,v=d.scale.y,x=f.trim,g=f.orig;x?(l=x.x-d.anchor.x*g.width,a=l+x.width,u=x.y-d.anchor.y*g.height,h=u+x.height):(a=g.width*(1-d.anchor.x),l=g.width*-d.anchor.x,h=g.height*(1-d.anchor.y),u=g.height*-d.anchor.y),n[o]=l*p,n[o+1]=u*v,n[o+s]=a*p,n[o+s+1]=u*v,n[o+s*2]=a*p,n[o+s*2+1]=h*v,n[o+s*3]=l*p,n[o+s*3+1]=h*v,o+=s*4}}uploadPosition(e,t,i,n,s,o){for(let a=0;a<i;a++){const l=e[t+a].position;n[o]=l.x,n[o+1]=l.y,n[o+s]=l.x,n[o+s+1]=l.y,n[o+s*2]=l.x,n[o+s*2+1]=l.y,n[o+s*3]=l.x,n[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,t,i,n,s,o){for(let a=0;a<i;a++){const l=e[t+a].rotation;n[o]=l,n[o+s]=l,n[o+s*2]=l,n[o+s*3]=l,o+=s*4}}uploadUvs(e,t,i,n,s,o){for(let a=0;a<i;++a){const l=e[t+a]._texture._uvs;l?(n[o]=l.x0,n[o+1]=l.y0,n[o+s]=l.x1,n[o+s+1]=l.y1,n[o+s*2]=l.x2,n[o+s*2+1]=l.y2,n[o+s*3]=l.x3,n[o+s*3+1]=l.y3,o+=s*4):(n[o]=0,n[o+1]=0,n[o+s]=0,n[o+s+1]=0,n[o+s*2]=0,n[o+s*2+1]=0,n[o+s*3]=0,n[o+s*3+1]=0,o+=s*4)}}uploadTint(e,t,i,n,s,o){for(let a=0;a<i;++a){const l=e[t+a],h=de.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);n[o]=h,n[o+s]=h,n[o+s*2]=h,n[o+s*3]=h,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}fx.extension={name:"particle",type:L.RendererPlugin};W.add(fx);var Ql=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(Ql||{});const aa={willReadFrequently:!0},Jt=class X{static get experimentalLetterSpacingSupported(){let e=X._experimentalLetterSpacingSupported;if(e!==void 0){const t=G.ADAPTER.getCanvasRenderingContext2D().prototype;e=X._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,n,s,o,a,l,h){this.text=e,this.style=t,this.width=i,this.height=n,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}static measureText(e,t,i,n=X._canvas){i=i??t.wordWrap;const s=t.toFontString(),o=X.measureFont(s);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const a=n.getContext("2d",aa);a.font=s;const l=(i?X.wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),h=new Array(l.length);let u=0;for(let p=0;p<l.length;p++){const v=X._measureText(l[p],t.letterSpacing,a);h[p]=v,u=Math.max(u,v)}let c=u+t.strokeThickness;t.dropShadow&&(c+=t.dropShadowDistance);const d=t.lineHeight||o.fontSize+t.strokeThickness;let f=Math.max(d,o.fontSize+t.strokeThickness*2)+t.leading+(l.length-1)*(d+t.leading);return t.dropShadow&&(f+=t.dropShadowDistance),new X(e,t,c,f,l,h,d+t.leading,u,o)}static _measureText(e,t,i){let n=!1;X.experimentalLetterSpacingSupported&&(X.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,n=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let s=i.measureText(e).width;return s>0&&(n?s-=t:s+=(X.graphemeSegmenter(e).length-1)*t),s}static wordWrap(e,t,i=X._canvas){const n=i.getContext("2d",aa);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:h,whiteSpace:u}=t,c=X.collapseSpaces(u),d=X.collapseNewlines(u);let f=!c;const p=t.wordWrapWidth+h,v=X.tokenize(e);for(let x=0;x<v.length;x++){let g=v[x];if(X.isNewline(g)){if(!d){a+=X.addLine(o),f=!c,o="",s=0;continue}g=" "}if(c){const m=X.isBreakingSpace(g),_=X.isBreakingSpace(o[o.length-1]);if(m&&_)continue}const y=X.getFromCache(g,h,l,n);if(y>p)if(o!==""&&(a+=X.addLine(o),o="",s=0),X.canBreakWords(g,t.breakWords)){const m=X.wordWrapSplit(g);for(let _=0;_<m.length;_++){let E=m[_],b=E,T=1;for(;m[_+T];){const P=m[_+T];if(!X.canBreakChars(b,P,g,_,t.breakWords))E+=P;else break;b=P,T++}_+=T-1;const S=X.getFromCache(E,h,l,n);S+s>p&&(a+=X.addLine(o),f=!1,o="",s=0),o+=E,s+=S}}else{o.length>0&&(a+=X.addLine(o),o="",s=0);const m=x===v.length-1;a+=X.addLine(g,!m),f=!1,o="",s=0}else y+s>p&&(f=!1,a+=X.addLine(o),o="",s=0),(o.length>0||!X.isBreakingSpace(g)||f)&&(o+=g,s+=y)}return a+=X.addLine(o,!1),a}static addLine(e,t=!0){return e=X.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,i,n){let s=i[e];return typeof s!="number"&&(s=X._measureText(e,t,n)+t,i[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!X.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:X._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:X._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let i="";if(typeof e!="string")return t;for(let n=0;n<e.length;n++){const s=e[n],o=e[n+1];if(X.isBreakingSpace(s,o)||X.isNewline(s)){i!==""&&(t.push(i),i=""),t.push(s);continue}i+=s}return i!==""&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,n,s){return!0}static wordWrapSplit(e){return X.graphemeSegmenter(e)}static measureFont(e){if(X._fonts[e])return X._fonts[e];const t={ascent:0,descent:0,fontSize:0},i=X._canvas,n=X._context;n.font=e;const s=X.METRICS_STRING+X.BASELINE_SYMBOL,o=Math.ceil(n.measureText(s).width);let a=Math.ceil(n.measureText(X.BASELINE_SYMBOL).width);const l=Math.ceil(X.HEIGHT_MULTIPLIER*a);if(a=a*X.BASELINE_MULTIPLIER|0,o===0||l===0)return X._fonts[e]=t,t;i.width=o,i.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,a);const h=n.getImageData(0,0,o,l).data,u=h.length,c=o*4;let d=0,f=0,p=!1;for(d=0;d<a;++d){for(let v=0;v<c;v+=4)if(h[f+v]!==255){p=!0;break}if(!p)f+=c;else break}for(t.ascent=a-d,f=u-c,p=!1,d=l;d>a;--d){for(let v=0;v<c;v+=4)if(h[f+v]!==255){p=!0;break}if(!p)f-=c;else break}return t.descent=d-a,t.fontSize=t.ascent+t.descent,X._fonts[e]=t,t}static clearMetrics(e=""){e?delete X._fonts[e]:X._fonts={}}static get _canvas(){var e;if(!X.__canvas){let t;try{const i=new OffscreenCanvas(0,0);if((e=i.getContext("2d",aa))!=null&&e.measureText)return X.__canvas=i,i;t=G.ADAPTER.createCanvas()}catch{t=G.ADAPTER.createCanvas()}t.width=t.height=10,X.__canvas=t}return X.__canvas}static get _context(){return X.__context||(X.__context=X._canvas.getContext("2d",aa)),X.__context}};Jt.METRICS_STRING="|ÉqÅ",Jt.BASELINE_SYMBOL="M",Jt.BASELINE_MULTIPLIER=1.4,Jt.HEIGHT_MULTIPLIER=2,Jt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return e=>[...r.segment(e)].map(t=>t.segment)}return r=>[...r]})(),Jt.experimentalLetterSpacing=!1,Jt._fonts={},Jt._newlines=[10,13],Jt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let zr=Jt;const OI=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],px=class Ts{constructor(e){this.styleID=0,this.reset(),pu(this,e,e)}clone(){const e={};return pu(e,this,Ts.defaultStyle),new Ts(e)}reset(){pu(this,Ts.defaultStyle,Ts.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=fu(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=fu(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){FI(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=fu(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let i=t.length-1;i>=0;i--){let n=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!OI.includes(n)&&(n=`"${n}"`),t[i]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};px.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ql.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let fr=px;function fu(r){const e=de.shared,t=i=>{const n=e.setValue(i);return n.alpha===1?n.toHex():n.toRgbaString()};return Array.isArray(r)?r.map(t):t(r)}function FI(r,e){if(!Array.isArray(r)||!Array.isArray(e)||r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0}function pu(r,e,t){for(const i in t)Array.isArray(e[i])?r[i]=e[i].slice():r[i]=e[i]}const NI={texture:!0,children:!1,baseTexture:!0},mx=class td extends Qn{constructor(e,t,i){let n=!1;i||(i=G.ADAPTER.createCanvas(),n=!0),i.width=3,i.height=3;const s=$.from(i);s.orig=new J,s.trim=new J,super(s),this._ownCanvas=n,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=td.defaultResolution??G.RESOLUTION,this._autoResolution=td.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return zr.experimentalLetterSpacing}static set experimentalLetterSpacing(e){te("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),zr.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const i=this.context,n=zr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=n.width,o=n.height,a=n.lines,l=n.lineHeight,h=n.lineWidths,u=n.maxLineWidth,c=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=t.strokeThickness,i.textBaseline=t.textBaseline,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit;let d,f;const p=t.dropShadow?2:1;for(let v=0;v<p;++v){const x=t.dropShadow&&v===0,g=x?Math.ceil(Math.max(1,o)+t.padding*2):0,y=g*this._resolution;if(x){i.fillStyle="black",i.strokeStyle="black";const _=t.dropShadowColor,E=t.dropShadowBlur*this._resolution,b=t.dropShadowDistance*this._resolution;i.shadowColor=de.shared.setValue(_).setAlpha(t.dropShadowAlpha).toRgbaString(),i.shadowBlur=E,i.shadowOffsetX=Math.cos(t.dropShadowAngle)*b,i.shadowOffsetY=Math.sin(t.dropShadowAngle)*b+y}else i.fillStyle=this._generateFillStyle(t,a,n),i.strokeStyle=t.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let m=(l-c.fontSize)/2;l-c.fontSize<0&&(m=0);for(let _=0;_<a.length;_++)d=t.strokeThickness/2,f=t.strokeThickness/2+_*l+c.ascent+m,t.align==="right"?d+=u-h[_]:t.align==="center"&&(d+=(u-h[_])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[_],d+t.padding,f+t.padding-g,!0),t.fill&&this.drawLetterSpacing(a[_],d+t.padding,f+t.padding-g)}this.updateTexture()}drawLetterSpacing(e,t,i,n=!1){const s=this._style.letterSpacing;let o=!1;if(zr.experimentalLetterSpacingSupported&&(zr.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){n?this.context.strokeText(e,t,i):this.context.fillText(e,t,i);return}let a=t;const l=zr.graphemeSegmenter(e);let h=this.context.measureText(e).width,u=0;for(let c=0;c<l.length;++c){const d=l[c];n?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);let f="";for(let p=c+1;p<l.length;++p)f+=l[p];u=this.context.measureText(f).width,a+=h-u+s,h=u}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=ib(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const t=this._texture,i=this._style,n=i.trim?0:i.padding,s=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,i){const n=e.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,h=this.canvas.height/this._resolution-o-a*2,u=n.slice(),c=e.fillGradientStops.slice();if(!c.length){const d=u.length+1;for(let f=1;f<d;++f)c.push(f/d)}if(u.unshift(n[0]),c.unshift(0),u.push(n[n.length-1]),c.push(1),e.fillGradientType===Ql.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,h+a);const d=i.fontProperties.fontSize+e.strokeThickness;for(let f=0;f<t.length;f++){const p=i.lineHeight*(f-1)+d,v=i.lineHeight*f;let x=v;f>0&&p>v&&(x=(v+p)/2);const g=v+d,y=i.lineHeight*(f+1);let m=g;f+1<t.length&&y<g&&(m=(g+y)/2);const _=(m-x)/h;for(let E=0;E<u.length;E++){let b=0;typeof c[E]=="number"?b=c[E]:b=E/u.length;let T=Math.min(1,Math.max(0,x/h+b*_));T=Number(T.toFixed(5)),s.addColorStop(T,u[E])}}}else{s=this.context.createLinearGradient(a,h/2,l+a,h/2);const d=u.length+1;let f=1;for(let p=0;p<u.length;p++){let v;typeof c[p]=="number"?v=c[p]:v=f/d,s.addColorStop(v,u[p]),f++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},NI,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=Yr(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=Yr(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof fr?this._style=e:this._style=new fr(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};mx.defaultAutoResolution=!0;let Bi=mx;class LI{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function UI(r,e){var i;let t=!1;if((i=r==null?void 0:r._textures)!=null&&i.length){for(let n=0;n<r._textures.length;n++)if(r._textures[n]instanceof $){const s=r._textures[n].baseTexture;e.includes(s)||(e.push(s),t=!0)}}return t}function GI(r,e){if(r.baseTexture instanceof Q){const t=r.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function zI(r,e){if(r._texture&&r._texture instanceof $){const t=r._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function jI(r,e){return e instanceof Bi?(e.updateText(!0),!0):!1}function HI(r,e){if(e instanceof fr){const t=e.toFontString();return zr.measureFont(t),!0}return!1}function $I(r,e){if(r instanceof Bi){e.includes(r.style)||e.push(r.style),e.includes(r)||e.push(r);const t=r._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function VI(r,e){return r instanceof fr?(e.includes(r)||e.push(r),!0):!1}const gx=class yx{constructor(e){this.limiter=new LI(yx.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook($I),this.registerFindHook(VI),this.registerFindHook(UI),this.registerFindHook(GI),this.registerFindHook(zI),this.registerUploadHook(jI),this.registerUploadHook(HI)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,gt.system.addOnce(this.tick,this,Hi.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let i=0,n=this.uploadHooks.length;i<n;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)gt.system.addOnce(this.tick,this,Hi.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,i=e.length;t<i;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Pt)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&gt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};gx.uploadsPerFrame=4;let rd=gx;Object.defineProperties(G,{UPLOADS_PER_FRAME:{get(){return rd.uploadsPerFrame},set(r){te("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),rd.uploadsPerFrame=r}}});function vx(r,e){return e instanceof Q?(e._glTextures[r.CONTEXT_UID]||r.texture.bind(e),!0):!1}function WI(r,e){if(!(e instanceof Tn))return!1;const{geometry:t}=e;e.finishPoly(),t.updateBatches();const{batches:i}=t;for(let n=0;n<i.length;n++){const{texture:s}=i[n].style;s&&vx(r,s.baseTexture)}return t.batchable||r.geometry.bind(t,e._resolveDirectShader(r)),!0}function XI(r,e){return r instanceof Tn?(e.push(r),!0):!1}class xx extends rd{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(XI),this.registerUploadHook(vx),this.registerUploadHook(WI)}}xx.extension={name:"prepare",type:L.RendererSystem};W.add(xx);var YI=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,KI=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,qI=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,ug=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,ZI=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const la=new pe;class _x extends Kl{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new bv,this.state=pr.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=ur.from(ug,ZI,t),this.shader=e.context.webGLVersion>1?ur.from(KI,YI,t):ur.from(ug,qI,t)}render(e){const t=this.renderer,i=this.quad;let n=i.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;n=i.uvs,n[0]=n[6]=-s,n[1]=n[3]=-o,n[2]=n[4]=1-s,n[5]=n[7]=1-o,i.invalidate();const a=e._texture,l=a.baseTexture,h=l.alphaMode>0,u=e.tileTransform.localTransform,c=e.uvMatrix;let d=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;d&&(l._glTextures[t.CONTEXT_UID]?d=l.wrapMode!==ni.CLAMP:l.wrapMode===ni.CLAMP&&(l.wrapMode=ni.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,v=a.height,x=e._width,g=e._height;la.set(u.a*p/x,u.b*p/g,u.c*v/x,u.d*v/g,u.tx/x,u.ty/g),la.invert(),d?la.prepend(c.mapCoord):(f.uniforms.uMapCoord=c.mapCoord.toArray(!0),f.uniforms.uClampFrame=c.uClampFrame,f.uniforms.uClampOffset=c.uClampOffset),f.uniforms.uTransform=la.toArray(!0),f.uniforms.uColor=de.shared.setValue(e.tint).premultiply(e.worldAlpha,h).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,t.shader.bind(f),t.geometry.bind(i),this.state.blendMode=dv(e.blendMode,h),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}_x.extension={name:"tilingSprite",type:L.RendererPlugin};W.add(_x);const wx=class Ss{constructor(e,t,i){this.linkedSheets=[],(e instanceof Q||e instanceof $)&&(e={texture:e,data:t,resolutionFilename:i});const{texture:n,data:s,resolutionFilename:o=null,cachePrefix:a=""}=e;this.cachePrefix=a,this._texture=n instanceof $?n:null,this.baseTexture=n instanceof Q?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;const l=this.baseTexture.resource;this.resolution=this._updateResolution(o||(l?l.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let i=kr(e,null);return i===null&&(i=typeof t=="number"?t:parseFloat(t??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Ss.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const i=Ss.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const n=this._frameKeys[t],s=this._frames[n],o=s.frame;if(o){let a=null,l=null;const h=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,u=new J(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);s.rotated?a=new J(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new J(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new J(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new $(this.baseTexture,a,u,l,s.rotated?2:0,s.anchor,s.borders),$.addToCache(this.textures[n],this.cachePrefix+n.toString())}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const n=e[t][i];this.animations[t].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ss.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ss.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};wx.BATCH_SIZE=1e3;let cg=wx;const QI=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function Ex(r,e,t){const i={};if(r.forEach(n=>{i[n]=e}),Object.keys(e.textures).forEach(n=>{i[`${e.cachePrefix}${n}`]=e.textures[n]}),!t){const n=He.dirname(r[0]);e.linkedSheets.forEach((s,o)=>{Object.assign(i,Ex([`${n}/${e.data.meta.related_multi_packs[o]}`],s,!0))})}return i}const JI={extension:L.Asset,cache:{test:r=>r instanceof cg,getCacheableAssets:(r,e)=>Ex(r,e,!1)},resolver:{test:r=>{const e=r.split("?")[0].split("."),t=e.pop(),i=e.pop();return t==="json"&&QI.includes(i)},parse:r=>{var t;const e=r.split(".");return{resolution:parseFloat(((t=G.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:e[e.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:L.LoadParser,priority:Vt.Normal},async testParse(r,e){return He.extname(e.src).toLowerCase()===".json"&&!!r.frames},async parse(r,e,t){var u,c;const{texture:i,imageFilename:n,cachePrefix:s}=(e==null?void 0:e.data)??{};let o=He.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(i&&i.baseTexture)a=i;else{const d=Zc(o+(n??r.meta.image),e.src);a=(await t.load([d]))[d]}const l=new cg({texture:a.baseTexture,data:r,resolutionFilename:e.src,cachePrefix:s});await l.parse();const h=(u=r==null?void 0:r.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(h)){const d=[];for(const p of h){if(typeof p!="string")continue;let v=o+p;(c=e.data)!=null&&c.ignoreMultiPack||(v=Zc(v,e.src),d.push(t.load({src:v,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(d);l.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[l].concat(l.linkedSheets.filter(v=>v!==p))})}return l},unload(r){r.destroy(!0)}}};W.add(JI);class El{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class ka{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in t){const o=t[s].match(/^[a-z]+/gm)[0],a=t[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const h in a){const u=a[h].split("="),c=u[0],d=u[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;l[c]=p}i[o].push(l)}const n=new El;return i.info.forEach(s=>n.info.push({face:s.face,size:parseInt(s.size,10)})),i.common.forEach(s=>n.common.push({lineHeight:parseInt(s.lineHeight,10)})),i.page.forEach(s=>n.page.push({id:parseInt(s.id,10),file:s.file})),i.char.forEach(s=>n.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),i.kerning.forEach(s=>n.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),i.distanceField.forEach(s=>n.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),n}}class id{static test(e){const t=e;return typeof e!="string"&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const t=new El,i=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let h=0;h<i.length;h++)t.info.push({face:i[h].getAttribute("face"),size:parseInt(i[h].getAttribute("size"),10)});for(let h=0;h<n.length;h++)t.common.push({lineHeight:parseInt(n[h].getAttribute("lineHeight"),10)});for(let h=0;h<s.length;h++)t.page.push({id:parseInt(s[h].getAttribute("id"),10)||0,file:s[h].getAttribute("file")});for(let h=0;h<o.length;h++){const u=o[h];t.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let h=0;h<a.length;h++)t.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});for(let h=0;h<l.length;h++)t.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return t}}class nd{static test(e){return typeof e=="string"&&e.includes("<font>")?id.test(G.ADAPTER.parseXML(e)):!1}static parse(e){return id.parse(G.ADAPTER.parseXML(e))}}const mu=[ka,id,nd];function eR(r){for(let e=0;e<mu.length;e++)if(mu[e].test(r))return mu[e];return null}function tR(r,e,t,i,n,s){const o=t.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=t.dropShadow?t.dropShadowDistance:0,h=t.padding||0,u=r.width/i-l-h*2,c=r.height/i-l-h*2,d=o.slice(),f=t.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let v=1;v<p;++v)f.push(v/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),t.fillGradientType===Ql.LINEAR_VERTICAL){a=e.createLinearGradient(u/2,h,u/2,c+h);let p=0;const v=(s.fontProperties.fontSize+t.strokeThickness)/c;for(let x=0;x<n.length;x++){const g=s.lineHeight*x;for(let y=0;y<d.length;y++){let m=0;typeof f[y]=="number"?m=f[y]:m=y/d.length;const _=g/c+m*v;let E=Math.max(p,_);E=Math.min(E,1),a.addColorStop(E,d[y]),p=E}}}else{a=e.createLinearGradient(h,c/2,u+h,c/2);const p=d.length+1;let v=1;for(let x=0;x<d.length;x++){let g;typeof f[x]=="number"?g=f[x]:g=v/p,a.addColorStop(g,d[x]),v++}}return a}function rR(r,e,t,i,n,s,o){const a=t.text,l=t.fontProperties;e.translate(i,n),e.scale(s,s);const h=o.strokeThickness/2,u=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=tR(r,e,o,s,[a],t),e.strokeStyle=o.stroke,o.dropShadow){const c=o.dropShadowColor,d=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor=de.shared.setValue(c).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=d,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,h,u+t.lineHeight-l.descent),o.fill&&e.fillText(a,h,u+t.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Da(r){return r.codePointAt?r.codePointAt(0):r.charCodeAt(0)}function Tx(r){return Array.from?Array.from(r):r.split("")}function iR(r){typeof r=="string"&&(r=[r]);const e=[];for(let t=0,i=r.length;t<i;t++){const n=r[t];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const s=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...Tx(n))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Nr=class er{constructor(e,t,i){var u;const[n]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=kr(o.file),h={};this._ownsTextures=i,this.font=n.face,this.size=n.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=h;for(let c=0;c<e.page.length;c++){const{id:d,file:f}=e.page[c];h[d]=t instanceof Array?t[c]:t[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(h[d].baseTexture.alphaMode=lt.NO_PREMULTIPLIED_ALPHA,h[d].baseTexture.mipmap=dr.OFF)}for(let c=0;c<e.char.length;c++){const{id:d,page:f}=e.char[c];let{x:p,y:v,width:x,height:g,xoffset:y,yoffset:m,xadvance:_}=e.char[c];p/=l,v/=l,x/=l,g/=l,y/=l,m/=l,_/=l;const E=new J(p+h[f].frame.x/l,v+h[f].frame.y/l,x,g);this.chars[d]={xOffset:y,yOffset:m,xAdvance:_,kerning:{},texture:new $(h[f].baseTexture,E),page:f}}for(let c=0;c<e.kerning.length;c++){let{first:d,second:f,amount:p}=e.kerning[c];d/=l,f/=l,p/=l,this.chars[f]&&(this.chars[f].kerning[d]=p)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((u=a==null?void 0:a.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,i){let n;if(e instanceof El)n=e;else{const o=eR(e);if(!o)throw new Error("Unrecognized data format for font.");n=o.parse(e)}t instanceof $&&(t=[t]);const s=new er(n,t,i);return er.available[s.font]=s,s}static uninstall(e){const t=er.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete er.available[e]}static from(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:s,resolution:o,textureWidth:a,textureHeight:l,...h}=Object.assign({},er.defaultOptions,i),u=iR(n),c=t instanceof fr?t:new fr(t),d=a,f=new El;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};let p=0,v=0,x,g,y,m=0;const _=[];for(let b=0;b<u.length;b++){x||(x=G.ADAPTER.createCanvas(),x.width=a,x.height=l,g=x.getContext("2d"),y=new Q(x,{resolution:o,...h}),_.push(new $(y)),f.page.push({id:_.length-1,file:""}));const T=u[b],S=zr.measureText(T,c,!1,x),P=S.width,R=Math.ceil(S.height),K=Math.ceil((c.fontStyle==="italic"?2:1)*P);if(v>=l-R*o){if(v===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${T}')`);--b,x=null,g=null,y=null,v=0,p=0,m=0;continue}if(m=Math.max(R+S.fontProperties.descent,m),K*o+p>=d){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${T}')`);--b,v+=m*o,v=Math.ceil(v),p=0,m=0;continue}rR(x,g,S,p,v,o,c);const F=Da(S.text);f.char.push({id:F,page:_.length-1,x:p/o,y:v/o,width:K,height:R,xoffset:0,yoffset:0,xadvance:P-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),p+=(K+2*s)*o,p=Math.ceil(p)}if(!(i!=null&&i.skipKerning))for(let b=0,T=u.length;b<T;b++){const S=u[b];for(let P=0;P<T;P++){const R=u[P],K=g.measureText(S).width,F=g.measureText(R).width,A=g.measureText(S+R).width-(K+F);A&&f.kerning.push({first:Da(S),second:Da(R),amount:A})}}const E=new er(f,_,!0);return er.available[e]!==void 0&&er.uninstall(e),er.available[e]=E,E}};Nr.ALPHA=[["a","z"],["A","Z"]," "],Nr.NUMERIC=[["0","9"]],Nr.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Nr.ASCII=[[" ","~"]],Nr.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Nr.ALPHANUMERIC},Nr.available={};let Lr=Nr;var nR=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,sR=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const dg=[],fg=[],pg=[],oR=class Sx extends Pt{constructor(e,t={}){super();const{align:i,tint:n,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},Sx.styleDefaults,t);if(!Lr.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new de(n),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Sr(()=>{this.dirty=!0},this,0,0),this._roundPixels=G.ROUND_PIXELS,this.dirty=!0,this._resolution=G.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var K;const e=Lr.available[this._fontName],t=this.fontSize,i=t/e.size,n=new ne,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=Tx(l),u=this._maxWidth*e.size/t,c=e.distanceFieldType==="none"?dg:fg;let d=null,f=0,p=0,v=0,x=-1,g=0,y=0,m=0,_=0;for(let F=0;F<h.length;F++){const A=h[F],D=Da(A);if(/(?:\s)/.test(A)&&(x=F,g=f,_++),A==="\r"||A===`
`){o.push(f),a.push(-1),p=Math.max(p,f),++v,++y,n.x=0,n.y+=e.lineHeight,d=null,_=0;continue}const k=e.chars[D];if(!k)continue;d&&k.kerning[d]&&(n.x+=k.kerning[d]);const j=pg.pop()||{texture:$.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ne};j.texture=k.texture,j.line=v,j.charCode=D,j.position.x=Math.round(n.x+k.xOffset+this._letterSpacing/2),j.position.y=Math.round(n.y+k.yOffset),j.prevSpaces=_,s.push(j),f=j.position.x+Math.max(k.xAdvance-k.xOffset,k.texture.orig.width),n.x+=k.xAdvance+this._letterSpacing,m=Math.max(m,k.yOffset+k.texture.height),d=D,x!==-1&&u>0&&n.x>u&&(++y,Dn(s,1+x-y,1+F-x),F=x,x=-1,o.push(g),a.push(s.length>0?s[s.length-1].prevSpaces:0),p=Math.max(p,g),v++,n.x=0,n.y+=e.lineHeight,d=null,_=0)}const E=h[h.length-1];E!=="\r"&&E!==`
`&&(/(?:\s)/.test(E)&&(f=g),o.push(f),p=Math.max(p,f),a.push(-1));const b=[];for(let F=0;F<=v;F++){let A=0;this._align==="right"?A=p-o[F]:this._align==="center"?A=(p-o[F])/2:this._align==="justify"&&(A=a[F]<0?0:(p-o[F])/a[F]),b.push(A)}const T=s.length,S={},P=[],R=this._activePagesMeshData;c.push(...R);for(let F=0;F<T;F++){const A=s[F].texture,D=A.baseTexture.uid;if(!S[D]){let k=c.pop();if(!k){const N=new PI;let I,z;e.distanceFieldType==="none"?(I=new lg($.EMPTY),z=Z.NORMAL):(I=new lg($.EMPTY,{program:br.from(sR,nR),uniforms:{uFWidth:0}}),z=Z.NORMAL_NPM);const C=new ag(N,I);C.blendMode=z,k={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:C,vertices:null,uvs:null,indices:null}}k.index=0,k.indexCount=0,k.vertexCount=0,k.uvsCount=0,k.total=0;const{_textureCache:j}=this;j[D]=j[D]||new $(A.baseTexture),k.mesh.texture=j[D],k.mesh.tint=this._tintColor.value,P.push(k),S[D]=k}S[D].total++}for(let F=0;F<R.length;F++)P.includes(R[F])||this.removeChild(R[F].mesh);for(let F=0;F<P.length;F++)P[F].mesh.parent!==this&&this.addChild(P[F].mesh);this._activePagesMeshData=P;for(const F in S){const A=S[F],D=A.total;if(!(((K=A.indices)==null?void 0:K.length)>6*D)||A.vertices.length<ag.BATCHABLE_SIZE*2)A.vertices=new Float32Array(4*2*D),A.uvs=new Float32Array(4*2*D),A.indices=new Uint16Array(6*D);else{const k=A.total,j=A.vertices;for(let N=k*4*2;N<j.length;N++)j[N]=0}A.mesh.size=6*D}for(let F=0;F<T;F++){const A=s[F];let D=A.position.x+b[A.line]*(this._align==="justify"?A.prevSpaces:1);this._roundPixels&&(D=Math.round(D));const k=D*i,j=A.position.y*i,N=A.texture,I=S[N.baseTexture.uid],z=N.frame,C=N._uvs,M=I.index++;I.indices[M*6+0]=0+M*4,I.indices[M*6+1]=1+M*4,I.indices[M*6+2]=2+M*4,I.indices[M*6+3]=0+M*4,I.indices[M*6+4]=2+M*4,I.indices[M*6+5]=3+M*4,I.vertices[M*8+0]=k,I.vertices[M*8+1]=j,I.vertices[M*8+2]=k+z.width*i,I.vertices[M*8+3]=j,I.vertices[M*8+4]=k+z.width*i,I.vertices[M*8+5]=j+z.height*i,I.vertices[M*8+6]=k,I.vertices[M*8+7]=j+z.height*i,I.uvs[M*8+0]=C.x0,I.uvs[M*8+1]=C.y0,I.uvs[M*8+2]=C.x1,I.uvs[M*8+3]=C.y1,I.uvs[M*8+4]=C.x2,I.uvs[M*8+5]=C.y2,I.uvs[M*8+6]=C.x3,I.uvs[M*8+7]=C.y3}this._textWidth=p*i,this._textHeight=(n.y+e.lineHeight)*i;for(const F in S){const A=S[F];if(this.anchor.x!==0||this.anchor.y!==0){let N=0;const I=this._textWidth*this.anchor.x,z=this._textHeight*this.anchor.y;for(let C=0;C<A.total;C++)A.vertices[N++]-=I,A.vertices[N++]-=z,A.vertices[N++]-=I,A.vertices[N++]-=z,A.vertices[N++]-=I,A.vertices[N++]-=z,A.vertices[N++]-=I,A.vertices[N++]-=z}this._maxLineHeight=m*i;const D=A.mesh.geometry.getBuffer("aVertexPosition"),k=A.mesh.geometry.getBuffer("aTextureCoord"),j=A.mesh.geometry.getIndex();D.data=A.vertices,k.data=A.uvs,j.data=A.indices,D.update(),k.update(),j.update()}for(let F=0;F<s.length;F++)pg.push(s[F]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:i,size:n}=Lr.available[this._fontName];if(i!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,h=Math.sqrt(s*s+o*o),u=Math.sqrt(a*a+l*l),c=(Math.abs(h)+Math.abs(u))/2,d=this.fontSize/n,f=e._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=c*t*d*f}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=Lr.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Lr.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Lr.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,i=Lr.available[this._fontName].distanceFieldType==="none"?dg:fg;i.push(...this._activePagesMeshData);for(const n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=$.EMPTY});for(const n in t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};oR.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const aR=[".xml",".fnt"],lR={extension:{type:L.LoadParser,priority:Vt.Normal},name:"loadBitmapFont",test(r){return aR.includes(He.extname(r).toLowerCase())},async testParse(r){return ka.test(r)||nd.test(r)},async parse(r,e,t){const i=ka.test(r)?ka.parse(r):nd.parse(r),{src:n}=e,{page:s}=i,o=[];for(let h=0;h<s.length;++h){const u=s[h].file;let c=He.join(He.dirname(n),u);c=Zc(c,n),o.push(c)}const a=await t.load(o),l=o.map(h=>a[h]);return Lr.install(i,l,!0)},async load(r,e){return(await G.ADAPTER.fetch(r)).text()},unload(r){r.destroy()}};W.add(lR);const sd=class an extends fr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new an(Object.keys(an.defaultOptions).reduce((t,i)=>({...t,[i]:e[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete an.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:i}=an;if(i[e]){const n=i[e];return this._fonts.push(n),n.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return G.ADAPTER.fetch(e).then(n=>n.blob()).then(async n=>new Promise((s,o)=>{const a=URL.createObjectURL(n),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(n)})).then(async([n,s])=>{const o=Object.assign({family:He.basename(e,He.extname(e)),weight:"normal",style:"normal",display:"auto",src:n,dataSrc:s,refs:1,originalUrl:e,fontFace:null},t);i[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const t=e.filter(i=>!this._overrides.includes(i));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter(i=>this._overrides.includes(i));t.length>0&&(this._overrides=this._overrides.filter(i=>!t.includes(i)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style};
                font-display: ${t.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=ZS(e)),typeof e=="number"?qS(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),n=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));const s=`${i}px ${n}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,an.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=G.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};sd.availableFonts={},sd.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let gu=sd;const ha=class ln extends Qn{constructor(e="",t={}){super($.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,n=$.from(i,{scaleMode:G.SCALE_MODE,resourceOptions:{autoLoad:!1}});n.orig=new J,n.trim=new J,this.texture=n;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),h=document.createElementNS(o,"div"),u=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=ln.defaultMaxWidth,this.maxHeight=ln.defaultMaxHeight,this._domElement=h,this._styleElement=u,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(u),this._foreignObject.appendChild(h),this._image=i,this._loadImage=new Image,this._autoResolution=ln.defaultAutoResolution,this._resolution=ln.defaultResolution??G.RESOLUTION,this.text=e,this.style=t}measureText(e){var u,c;const{text:t,style:i,resolution:n}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:i.toCSS(n)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),h=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",h.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(u=this._style)==null?void 0:u.toCSS(n)}),this._styleElement.textContent=(c=this._style)==null?void 0:c.toGlobalCSS()),{width:l+i.padding*2,height:h+i.padding*2}}async updateText(e=!0){const{style:t,_image:i,_loadImage:n}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();i.width=n.width=Math.ceil(Math.max(1,s)),i.height=n.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{n.onload=async()=>{if(a<this._updateID){l();return}await t.onBeforeDraw(),i.src=n.src,n.onload=null,n.src="",this.updateTexture(),l()};const h=new XMLSerializer().serializeToString(this._svgRoot);n.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(h)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:i,resolution:n}=this,{padding:s}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=i.width/n,t.trim.height=t._frame.height=i.height/n,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,n),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var i,n,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},ln.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=t,(n=this._svgRoot)==null||n.remove(),this._svgRoot=t,(s=this._domElement)==null||s.remove(),this._domElement=t,(o=this._foreignObject)==null||o.remove(),this._foreignObject=t,(a=this._styleElement)==null||a.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=Yr(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=Yr(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof gu?(this.ownsStyle=!1,this._style=e):e instanceof fr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=gu.from(e)):(this.ownsStyle=!0,this._style=new gu(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};ha.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},ha.defaultMaxWidth=2024,ha.defaultMaxHeight=2024,ha.defaultAutoResolution=!0;class hR{constructor(e,t){he(this,"app");he(this,"container");he(this,"gameState","ready");he(this,"settings");he(this,"startTime",0);he(this,"currentScore",0);he(this,"gameTimer",null);he(this,"scoreText",null);he(this,"timerText",null);he(this,"messageText",null);he(this,"isDestroyed",!1);he(this,"isStageAttached",!1);console.log("🏗️ GameTemplate constructor called"),this.app=e,this.container=new Pt,this.settings=t,console.log("✅ GameTemplate constructor completed (stage attachment deferred)")}ensureStageAttachment(){if(!(this.isStageAttached||this.isDestroyed))try{if(this.app&&this.app.stage&&this.container)this.app.stage.children.includes(this.container)||(this.app.stage.addChild(this.container),this.isStageAttached=!0,console.log("✅ Container attached to stage"));else throw console.error("❌ Cannot attach to stage - app, stage, or container is null"),new Error("Invalid PIXI.Application or stage is null")}catch(e){throw console.error("❌ Stage attachment failed:",e),e}}showResult(e){console.log(`GameTemplate.showResult called: ${e.success?"SUCCESS":"FAILED"}, Score: ${e.score}`),this.showMessage(`${e.message}
スコア: ${e.score}
時間: ${e.timeElapsed.toFixed(1)}秒`,5e3),setTimeout(()=>{this.isDestroyed||this.showRestartOption()},3e3)}async initialize(){this.isDestroyed||(console.log("🔧 GameTemplate.initialize() called"),this.ensureStageAttachment(),await this.createScene(),this.createUI(),this.gameState="ready",console.log("✅ GameTemplate.initialize() completed"))}start(){if(!this.isDestroyed){if(console.log(`GameTemplate.start() called, gameState=${this.gameState}`),this.gameState!=="ready"){console.warn(`Cannot start game in state: ${this.gameState}`);return}this.ensureStageAttachment(),this.gameState="playing",this.startTime=Date.now(),this.currentScore=0,console.log("GameTemplate: Game started, state=playing"),this.startGameTimer(),this.app&&this.app.ticker&&this.app.ticker.add(this.gameLoop,this),this.showMessage("スタート！",1e3)}}gameLoop(e){if(!(this.isDestroyed||this.gameState!=="playing"))try{this.updateGame(e),this.updateUI(),this.checkWinCondition()&&this.endGame(!0)}catch(t){console.error("GameLoop error:",t),this.endGame(!1)}}startGameTimer(){this.isDestroyed||(console.log(`GameTemplate: Starting timer for ${this.settings.duration} seconds`),this.gameTimer=window.setTimeout(()=>{console.log("GameTemplate: Timer expired"),!this.isDestroyed&&this.gameState==="playing"&&this.endGame(this.checkWinCondition())},this.settings.duration*1e3))}checkWinCondition(){return this.currentScore>=this.settings.targetScore}endGame(e){if(this.isDestroyed)return;console.log(`GameTemplate.endGame called: ${e?"SUCCESS":"FAILED"}`),this.gameState=e?"completed":"failed",this.gameTimer&&(clearTimeout(this.gameTimer),this.gameTimer=null),this.app&&this.app.ticker&&this.app.ticker.remove(this.gameLoop,this);const t=(Date.now()-this.startTime)/1e3,i={success:e,score:this.currentScore,timeElapsed:t,message:e?"やったね！🎉":"もう一回チャレンジ！💪"};console.log("GameTemplate: Calling showResult..."),this.showResult(i)}createUI(){if(!(this.isDestroyed||!this.app||!this.container))try{console.log("🎨 Creating UI elements...");const e=new fr({fontFamily:"Arial",fontSize:20,fill:5395035,fontWeight:"bold"});this.scoreText=new Bi(`スコア: ${this.currentScore}`,e),this.scoreText.x=20,this.scoreText.y=20,this.container.addChild(this.scoreText),this.timerText=new Bi(`時間: ${this.settings.duration}`,e),this.timerText.anchor.x=1,this.timerText.x=this.app.screen.width-20,this.timerText.y=20,this.container.addChild(this.timerText);const t=new fr({fontFamily:"Arial",fontSize:24,fill:14239471,fontWeight:"bold",align:"center"});this.messageText=new Bi("",t),this.messageText.anchor.set(.5),this.messageText.x=this.app.screen.width/2,this.messageText.y=100,this.messageText.visible=!1,this.container.addChild(this.messageText),console.log("✅ UI elements created successfully")}catch(e){console.error("❌ UI作成エラー:",e)}}updateUI(){if(!this.isDestroyed)try{if(this.scoreText&&(this.scoreText.text=`スコア: ${this.currentScore}`),this.timerText&&this.gameState==="playing"){const e=(Date.now()-this.startTime)/1e3,t=Math.max(0,this.settings.duration-e);this.timerText.text=`時間: ${t.toFixed(1)}`}}catch(e){console.error("❌ UI更新エラー:",e)}}showMessage(e,t=2e3){if(!(this.isDestroyed||!this.messageText))try{this.messageText.text=e,this.messageText.visible=!0,setTimeout(()=>{!this.isDestroyed&&this.messageText&&(this.messageText.visible=!1)},t)}catch(i){console.error("❌ メッセージ表示エラー:",i)}}showRestartOption(){console.log("ゲーム終了 - リスタートオプション表示")}destroy(){if(this.isDestroyed){console.log("GameTemplate already destroyed, skipping...");return}console.log("🗑️ GameTemplate.destroy() called"),this.isDestroyed=!0;try{if(this.gameState="ready",this.gameTimer&&(clearTimeout(this.gameTimer),this.gameTimer=null),this.app&&this.app.ticker&&typeof this.app.ticker.remove=="function"&&this.app.ticker.remove(this.gameLoop,this),this.scoreText=null,this.timerText=null,this.messageText=null,this.isStageAttached&&this.container&&this.app&&this.app.stage){try{this.app.stage.children&&Array.isArray(this.app.stage.children)&&this.app.stage.children.includes(this.container)&&(this.app.stage.removeChild(this.container),console.log("✅ Container removed from stage"))}catch(e){console.warn("⚠️ Container removal warning:",e)}this.isStageAttached=!1}if(this.container&&typeof this.container.destroy=="function")try{this.container.destroy({children:!0,texture:!1,baseTexture:!1}),console.log("✅ Container destroyed")}catch(e){console.warn("⚠️ Container destroy warning:",e)}this.container=null}catch(e){console.error("❌ GameTemplate.destroy() error (non-fatal):",e)}console.log("✅ GameTemplate.destroy() completed successfully")}}class yu extends hR{constructor(t,i){super(t,i);he(this,"character",null);he(this,"tapEffect",null);he(this,"tapCount",0);he(this,"settings");he(this,"onGameEnd");he(this,"reactions",["えへへ♪","もっと！","きゃー！","うれしい！","たのしー！"]);this.settings=i,console.log("CuteTapGame: Constructor completed")}async createScene(){var n,s,o,a;console.log("CuteTapGame: Creating scene...");const t=((n=this.app.renderer)==null?void 0:n.width)||((s=this.app.view)==null?void 0:s.width)||375,i=((o=this.app.renderer)==null?void 0:o.height)||((a=this.app.view)==null?void 0:a.height)||600;console.log(`CuteTapGame: Using dimensions ${t}x${i}`),this.createBackground(t,i),this.createCharacter(t,i),this.createTapEffect(),this.createUI(),console.log("CuteTapGame: Scene creation completed")}createBackground(t,i){const n=new Tn;n.beginFill(16574463),n.drawRect(0,0,t,i),n.endFill();for(let s=0;s<5;s++){const o=new Tn;o.beginFill(14239471,.1),o.drawCircle(0,0,20+Math.random()*30),o.endFill(),o.x=Math.random()*t,o.y=Math.random()*i,n.addChild(o)}this.container.addChild(n)}createCharacter(t,i){switch(this.character=new Tn,this.settings.characterType){case"girl":this.drawGirlCharacter();break;case"animal":this.drawAnimalCharacter();break;case"child":this.drawChildCharacter();break}this.character.x=t/2,this.character.y=i/2,this.character.eventMode="static",this.character.cursor="pointer",this.character.on("pointerdown",this.handleTap.bind(this)),this.container.addChild(this.character),console.log("CuteTapGame: Character created and added to container")}drawGirlCharacter(){this.character&&(this.character.beginFill(16767916),this.character.drawCircle(0,-20,40),this.character.endFill(),this.character.beginFill(0),this.character.drawCircle(-15,-30,5),this.character.drawCircle(15,-30,5),this.character.endFill(),this.character.beginFill(16777215),this.character.drawCircle(-13,-32,2),this.character.drawCircle(17,-32,2),this.character.endFill(),this.character.lineStyle(2,16738740),this.character.arc(0,-10,8,0,Math.PI),this.character.lineStyle(),this.character.beginFill(16761035),this.character.drawCircle(-25,-45,25),this.character.drawCircle(25,-45,25),this.character.drawCircle(0,-50,35),this.character.endFill(),this.character.beginFill(14239471),this.character.drawRoundedRect(-30,20,60,80,10),this.character.endFill(),this.character.beginFill(16767916),this.character.drawCircle(-40,40,12),this.character.drawCircle(40,40,12),this.character.endFill())}drawAnimalCharacter(){this.character&&(this.character.beginFill(16753920),this.character.drawCircle(0,0,50),this.character.endFill(),this.character.beginFill(16753920),this.character.drawCircle(0,-60,35),this.character.endFill(),this.character.beginFill(16753920),this.character.drawPolygon([-20,-80,-30,-95,-10,-85]),this.character.drawPolygon([20,-80,30,-95,10,-85]),this.character.endFill(),this.character.beginFill(0),this.character.drawCircle(-12,-65,4),this.character.drawCircle(12,-65,4),this.character.endFill(),this.character.beginFill(16738740),this.character.drawPolygon([0,-50,-5,-45,5,-45]),this.character.endFill())}drawChildCharacter(){this.character&&(this.character.beginFill(16767916),this.character.drawCircle(0,-10,45),this.character.endFill(),this.character.beginFill(0),this.character.drawCircle(-18,-20,8),this.character.drawCircle(18,-20,8),this.character.endFill(),this.character.beginFill(16777215),this.character.drawCircle(-15,-23,4),this.character.drawCircle(21,-23,4),this.character.endFill(),this.character.beginFill(1357990),this.character.drawRoundedRect(-25,35,50,60,15),this.character.endFill())}createTapEffect(){this.tapEffect=new Tn,this.tapEffect.visible=!1,this.container.addChild(this.tapEffect)}handleTap(t){if(console.log(`CuteTapGame: handleTap called, gameState=${this.gameState}`),this.gameState!=="playing")return;this.tapCount++,this.currentScore=this.tapCount,console.log(`CuteTapGame: tap count: ${this.tapCount}/${this.settings.targetTaps}`),this.showCharacterReaction(),this.showTapEffect(t.global.x,t.global.y);const i=this.reactions[Math.floor(Math.random()*this.reactions.length)];this.showMessage(i,800),this.checkWinCondition()&&(console.log("CuteTap: Target reached! Calling endGame(true)..."),this.endGame(!0),console.log("CuteTap: endGame(true) called"))}showCharacterReaction(){this.character&&(this.character.scale.set(1.1),this.character.tint=16755370,setTimeout(()=>{this.character&&(this.character.scale.set(1),this.character.tint=16777215)},150))}showTapEffect(t,i){if(!this.tapEffect)return;this.tapEffect.clear(),this.tapEffect.beginFill(14239471,.6),this.tapEffect.drawCircle(0,0,20),this.tapEffect.endFill(),this.tapEffect.x=t,this.tapEffect.y=i,this.tapEffect.visible=!0,this.tapEffect.scale.set(.5);const n=Date.now(),s=()=>{const a=(Date.now()-n)/300;a<1&&this.tapEffect?(this.tapEffect.scale.set(.5+a*.5),this.tapEffect.alpha=1-a,requestAnimationFrame(s)):this.tapEffect&&(this.tapEffect.visible=!1)};s()}checkWinCondition(){return this.tapCount>=this.settings.targetTaps}handleInput(t){}updateGame(t){}showResult(t){console.log(`CuteTap showResult called: ${t.success?"SUCCESS":"FAILED"}, Score: ${t.score}`),console.log(`CuteTap onGameEnd callback exists: ${!!this.onGameEnd}`),this.onGameEnd?(console.log("CuteTap: Calling onGameEnd callback..."),this.onGameEnd(t.success,t.score),console.log("CuteTap: onGameEnd callback completed")):console.warn("CuteTap: onGameEnd callback is not set!")}customizeDisplayForFallback(t,i){const n=this.container.children.find(o=>o instanceof Bi&&o.text.includes("キュートタップ"));n&&(n.text=t);const s=this.container.children.find(o=>o instanceof Bi&&o.text.includes("タップして"));s&&(s.text=i)}}class cr{static async initialize(){this.initialized||(await this.loadTemplateConfigurations(),this.registerCoreTemplates(),this.initialized=!0,console.log(`Template Factory initialized: ${this.registry.size} templates registered`))}static async loadTemplateConfigurations(){const e=[{id:"cute_tap",name:"キュートタップ",description:"キャラクターをタップしてスコアを稼ごう！",instruction:`キャラクターをタップして
魔力を集めよう！`,category:"action",duration:10,targetScore:30},{id:"memory_match",name:"メモリーマッチ",description:"同じ絵柄のペアを見つけよう！",instruction:`カードをめくって
同じ絵柄を見つけて！`,category:"puzzle",duration:30,targetScore:8},{id:"quick_dodge",name:"クイックドッジ",description:"落ちてくる障害物を避け続けよう！",instruction:`スワイプで移動して
障害物を避けて！`,category:"action",duration:15,targetScore:10},{id:"timing_perfect",name:"パーフェクトタイミング",description:"ベストタイミングでタップしよう！",instruction:`針がぴったりの位置で
タップして！`,category:"timing",duration:20,targetScore:5},{id:"collect_items",name:"アイテムコレクト",description:"アイテムを集めて目標を達成！",instruction:`ドラッグしてアイテムを
集めよう！`,category:"action",duration:15,targetScore:20},{id:"jump_adventure",name:"ジャンプアドベンチャー",description:"ジャンプして穴を避けてゴールへ！",instruction:`タップでジャンプして
穴を飛び越えて！`,category:"action",duration:20,targetScore:1},{id:"friendly_shoot",name:"フレンドリーシュート",description:"愛情弾で敵を友達にしよう！",instruction:`タップして愛情弾で
敵を友達にして！`,category:"action",duration:25,targetScore:10},{id:"animal_chase",name:"アニマルチェイス",description:"動物を優しく追いかけよう！",instruction:`線をなぞって動物を
優しく捕まえて！`,category:"action",duration:30,targetScore:5},{id:"rainbow_match",name:"レインボーマッチ",description:"色が変わる瞬間にタップ！",instruction:`指定された色になったら
すぐにタップ！`,category:"reaction",duration:15,targetScore:10},{id:"puzzle_princess",name:"パズルプリンセス",description:"パズルを完成させてお姫様を助けよう！",instruction:`ピースをドラッグして
美しい絵を完成させて！`,category:"puzzle",duration:60,targetScore:1},{id:"speed_friend",name:"スピードフレンド",description:"素早く正答して友達クイズ！",instruction:`友達についての問題に
素早く答えて！`,category:"reaction",duration:20,targetScore:10},{id:"spot_difference",name:"スポットザディファレンス",description:"2つの絵の違いを見つけよう！",instruction:`2つの絵を比べて
違いを見つけてタップ！`,category:"puzzle",duration:45,targetScore:3},{id:"opposite_action",name:"オポジットアクション",description:"指示と逆の行動をしよう！",instruction:`指示と反対のことを
してね！`,category:"reaction",duration:20,targetScore:10},{id:"count_star",name:"カウントスター",description:"夜空の星を正確に数えよう！",instruction:`画面の星の数を数えて
正しい数をタップ！`,category:"puzzle",duration:15,targetScore:5},{id:"number_hunt",name:"ナンバーハント",description:"隠された数字を見つけよう！",instruction:`計算して正しい答えを
見つけてタップ！`,category:"puzzle",duration:30,targetScore:5},{id:"order_master",name:"オーダーマスター",description:"正しい順序に並び替えよう！",instruction:`アイテムをドラッグして
正しい順番に並べて！`,category:"puzzle",duration:40,targetScore:3},{id:"size_perfect",name:"サイズパーフェクト",description:"指定サイズでぴったりストップ！",instruction:`拡大する円が指定サイズに
なったらタップ！`,category:"timing",duration:25,targetScore:5},{id:"dreamy_jump",name:"ドリーミージャンプ",description:"雲の上をジャンプして夢の世界へ！",instruction:`雲から雲へジャンプして
夢の世界を冒険！`,category:"action",duration:30,targetScore:20},{id:"magical_collect",name:"マジカルコレクト",description:"魔法のアイテムを集めよう！",instruction:`魔法の素材をドラッグで
集めて魔法を完成！`,category:"action",duration:20,targetScore:15},{id:"balance_game",name:"バランスゲーム",description:"バランスを保って落とさないで！",instruction:`デバイスを傾けて
ボールを落とさないで！`,category:"timing",duration:30,targetScore:1}];this.configCache.set("embedded",e)}static registerCoreTemplates(){Array.from(this.configCache.values()).flat().forEach(t=>{this.registerTemplateFromConfig(t)})}static registerTemplateFromConfig(e){const t={id:e.id,name:e.name,description:e.description,instruction:e.instruction,category:e.category,defaultSettings:{duration:e.duration,targetScore:e.targetScore,difficulty:e.difficulty||"normal"},implementationStatus:"implemented"},i=async(n,s)=>{try{switch(e.id){case"cute_tap":return new yu(n,{duration:s.duration,targetScore:s.targetScore,targetTaps:s.targetScore,difficulty:s.difficulty,characterType:s.characterType});case"memory_match":const{MemoryMatchGame:o}=await ge(()=>import("./MemoryMatchGame-bfac22d1.js"),[]);return new o(n,s);case"quick_dodge":const{QuickDodgeGame:a}=await ge(()=>import("./QuickDodgeGame-f6072646.js"),[]);return new a(n,s);case"timing_perfect":const{TimingPerfectGame:l}=await ge(()=>import("./TimingPerfectGame-11e42f7d.js"),[]);return new l(n,s);case"collect_items":const{CollectItemsGame:h}=await ge(()=>import("./CollectItemsGame-402277c3.js"),[]);return new h(n,s);case"jump_adventure":const{JumpAdventureGame:u}=await ge(()=>import("./JumpAdventureGame-1aefd93a.js"),[]);return new u(n,s);case"friendly_shoot":const{FriendlyShootGame:c}=await ge(()=>import("./FriendlyShootGame-75c26dff.js"),[]);return new c(n,s);case"animal_chase":const{AnimalChaseGame:d}=await ge(()=>import("./AnimalChaseGame-135d25b6.js"),[]);return new d(n,s);case"rainbow_match":const{RainbowMatchGame:f}=await ge(()=>import("./RainbowMatchGame-4e82a8e4.js"),[]);return new f(n,s);case"puzzle_princess":const{PuzzlePrincessGame:p}=await ge(()=>import("./PuzzlePrincessGame-ed5781ee.js"),[]);return new p(n,s);case"speed_friend":const{SpeedFriendGame:v}=await ge(()=>import("./SpeedFriendGame-60f38a5f.js"),[]);return new v(n,s);case"spot_difference":const{SpotDifferenceGame:x}=await ge(()=>import("./SpotDifferenceGame-aa5bc3d9.js"),[]);return new x(n,s);case"opposite_action":const{OppositeActionGame:g}=await ge(()=>import("./OppositeActionGame-a998da06.js"),[]);return new g(n,s);case"count_star":const{CountStarGame:y}=await ge(()=>import("./CountStarGame-969caf49.js"),[]);return new y(n,s);case"number_hunt":const{NumberHuntGame:m}=await ge(()=>import("./NumberHuntGame-c49b11bb.js"),[]);return new m(n,s);case"order_master":const{OrderMasterGame:_}=await ge(()=>import("./OrderMasterGame-e507a786.js"),[]);return new _(n,s);case"size_perfect":const{ReactionSpeedGame:E}=await ge(()=>import("./ReactionSpeedGame-bd30dad7.js"),[]);return new E(n,s);case"dreamy_jump":const{DreamyJumpGame:b}=await ge(()=>import("./DreamyJumpGame-5f626a82.js"),[]);return new b(n,s);case"magical_collect":const{MagicalCollectGame:T}=await ge(()=>import("./MagicalCollectGame-733f719c.js"),[]);return new T(n,s);case"balance_game":const{BalanceGame:S}=await ge(()=>import("./BalanceGame-570799f1.js"),[]);return new S(n,s);default:return console.warn(`Unknown template: ${e.id}, using fallback`),this.createCustomizedFallback(n,s,e)}}catch(o){return console.error(`Failed to create ${e.id}:`,o),this.createCustomizedFallback(n,s,e)}};this.registry.set(e.id,{info:t,createInstance:i})}static createCustomizedFallback(e,t,i){console.warn(`Using customized fallback for ${i.id}`);const n=new yu(e,{duration:t.duration,targetScore:t.targetScore,targetTaps:t.targetScore,difficulty:t.difficulty,characterType:t.characterType}),s=n.createScene.bind(n);return n.createScene=async function(){await s(),typeof this.customizeDisplayForFallback=="function"&&this.customizeDisplayForFallback(i.name,i.instruction)},n}static async ensureInitialized(){this.initialized||await this.initialize()}static async createTemplate(e,t,i){await this.ensureInitialized();const n=this.registry.get(e);if(!n)return console.error(`Template ${e} not registered`),null;try{return await n.createInstance(t,i)}catch(s){return console.error(`Error creating template ${e}:`,s),this.createEmergencyFallback(t,i)}}static createEmergencyFallback(e,t){return console.error("Using emergency fallback - CuteTap"),new yu(e,{duration:t.duration,targetScore:t.targetScore,targetTaps:t.targetScore,difficulty:t.difficulty,characterType:t.characterType})}static async upgradeToImplemented(e,t){await this.ensureInitialized();const i=this.registry.get(e);if(!i)return console.error(`Template ${e} not found for upgrade`),!1;try{return this.registry.set(e,{info:{...i.info,implementationStatus:"implemented"},createInstance:async(n,s)=>new t(n,s)}),console.log(`Template ${e} upgraded to implemented`),!0}catch(n){return console.error(`Failed to upgrade template ${e}:`,n),!1}}static async checkImplementationStatus(e){var i;await this.ensureInitialized();const t=this.registry.get(e);if(!t)return{implemented:!1,hasFile:!1,isRegistered:!1,status:"missing",error:"テンプレート未登録"};try{const n=document.createElement("canvas"),s=new pf({view:n,width:100,height:100}),o={gameType:e,characterType:"girl",difficulty:"normal",duration:10,targetScore:10},a=await t.createInstance(s,o);return s.destroy(!0),a?{implemented:t.info.implementationStatus==="implemented",hasFile:!0,isRegistered:!0,status:t.info.implementationStatus,error:void 0}:{implemented:!1,hasFile:!1,isRegistered:!0,status:"missing",error:"インスタンス作成失敗"}}catch(n){return{implemented:!1,hasFile:!0,isRegistered:!0,status:"fallback",error:`エラー: ${((i=n.message)==null?void 0:i.slice(0,50))||"Unknown"}`}}}static async checkAllImplementations(){await this.ensureInitialized();const e={};for(const[t]of this.registry)e[t]=await this.checkImplementationStatus(t);return e}static async getTemplateInfo(e){await this.ensureInitialized();const t=this.registry.get(e);return(t==null?void 0:t.info)||null}static async getAllTemplates(){return await this.ensureInitialized(),Array.from(this.registry.values()).map(e=>e.info)}static async getDebugInfo(){const e=await this.getAllTemplates(),t=e.filter(s=>s.implementationStatus==="implemented").length,i=e.filter(s=>s.implementationStatus==="fallback").length,n=e.filter(s=>s.implementationStatus==="missing").length;return{totalRegistered:e.length,implemented:t,fallback:i,missing:n,implementationRate:`${Math.round(t/e.length*100)}%`}}}he(cr,"registry",new Map),he(cr,"configCache",new Map),he(cr,"initialized",!1);const bx=({width:r=375,height:e=600,config:t,onGameEnd:i,bgmVolume:n=.5,seVolume:s=.5,isMuted:o=!1,onSkip:a,onExit:l})=>{const h=V.useRef(null),[u,c]=V.useState("読み込み中..."),[d,f]=V.useState(!1),[p,v]=V.useState(!1),[x,g]=V.useState(n),[y,m]=V.useState(s),[_,E]=V.useState(o),b=V.useRef(null),[T,S]=V.useState(t.duration),[P]=V.useState(t.duration),[R,K]=V.useState(!1);V.useEffect(()=>{typeof window<"u"&&(window.gameDebugData={gameStatus:u,bgmVolume:n,seVolume:s,isMuted:o,timeRemaining:T,totalTime:P,isGameRunning:R,gameType:t.gameType})},[u,n,s,o,T,P,R,t.gameType]),V.useEffect(()=>{let k=null;return(async()=>{if(h.current)try{console.log("🎮 ゲーム初期化開始:",t.gameType),c("初期化中..."),k=new pf({width:r,height:e,backgroundColor:16574463}),h.current.innerHTML="",h.current.appendChild(k.view),console.log("✅ Canvas追加完了");const N=await cr.createTemplate(t.gameType,k,{gameType:t.gameType,characterType:t.characterType,difficulty:t.difficulty,duration:t.duration,targetScore:t.targetScore});if(!N)throw new Error("ゲーム作成失敗");b.current=N,console.log("✅ ゲーム作成完了"),N.createScene&&(await N.createScene(),console.log("✅ シーン作成完了")),N.start&&(N.start(),console.log("✅ ゲーム開始"),c("ゲーム実行中"),K(!0)),"onGameEnd"in N&&(N.onGameEnd=(I,z)=>{console.log("🎁 ゲーム終了:",I,z),K(!1),i==null||i(I,z)})}catch(N){console.error("❌ エラー発生:",N),c("エラー発生")}})(),()=>{if(k)try{k.destroy(!0),console.log("🗑️ リソース削除完了")}catch(N){console.warn("クリーンアップエラー:",N)}}},[t,r,e,i]),V.useEffect(()=>{let k;return R&&T>0&&!d&&!p&&(k=setInterval(()=>{S(j=>{const N=Math.max(0,j-.1);return N<=0&&(K(!1),b.current&&typeof b.current.forceEnd=="function"?b.current.forceEnd(!1,0):setTimeout(()=>i==null?void 0:i(!1,0),100)),N})},100)),()=>{k&&clearInterval(k)}},[R,T,d,p,i]),V.useEffect(()=>{d||p?b.current&&typeof b.current.pause=="function"&&b.current.pause():b.current&&typeof b.current.resume=="function"&&b.current.resume()},[d,p]);const F=()=>{f(!1)},A=()=>{v(!1)},D=()=>{console.log("音量設定適用:",{localBgmVolume:x,localSeVolume:y,localIsMuted:_}),v(!1)};return w.jsxs("div",{className:"enhanced-game-canvas-container",style:{position:"relative",width:"100%",maxWidth:"400px",margin:"0 auto"},children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 15px",backgroundColor:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[w.jsxs("div",{style:{display:"flex",gap:"10px"},children:[w.jsx("button",{style:{padding:"8px 12px",backgroundColor:"#d946ef",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},onClick:()=>v(!0),children:"🔊 音量"}),w.jsx("button",{style:{padding:"8px 12px",backgroundColor:"#6366f1",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},onClick:()=>f(!0),children:"ログイン"})]}),w.jsxs("div",{style:{display:"flex",gap:"8px"},children:[w.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"8px 12px",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:"🔄"}),w.jsx("button",{style:{padding:"8px 12px",backgroundColor:"#f59e0b",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},onClick:a,children:"Skip"}),w.jsx("button",{style:{padding:"8px 12px",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},onClick:l,children:"Exit"})]})]}),w.jsx("div",{style:{padding:"10px 15px",backgroundColor:"#fce7ff",borderBottom:"1px solid #e2e8f0",textAlign:"center"},children:w.jsxs("h3",{style:{margin:"0",color:"#d946ef",fontSize:"18px",fontWeight:"bold"},children:["🌟 ",t.gameType]})}),w.jsxs("div",{style:{position:"relative",width:`${r}px`,height:`${e}px`,margin:"0 auto",backgroundColor:"#fce7ff",overflow:"hidden",zIndex:1},children:[w.jsx("div",{ref:h,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}}),w.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"8px",backgroundColor:"#e5e7eb",overflow:"hidden"},children:[w.jsx("div",{style:{height:"100%",backgroundColor:T<=3?"#ef4444":T<=10?"#f59e0b":"#d946ef",width:`${Math.max(0,T/P*100)}%`,transition:"width 0.1s linear, background-color 0.3s ease",boxShadow:T<=5?"0 0 8px rgba(239, 68, 68, 0.6)":"none"}}),T<=3&&T>0&&w.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"100%",backgroundColor:"#ef4444",opacity:.3,animation:"pulse 0.5s ease-in-out infinite alternate"}})]})]}),w.jsx("style",{children:`
        @keyframes pulse {
          from { opacity: 0.3; }
          to { opacity: 0.7; }
        }
      `}),p&&w.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},onClick:A,children:w.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",width:"320px",maxWidth:"90vw",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:k=>k.stopPropagation(),children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[w.jsx("h2",{style:{fontSize:"20px",fontWeight:"bold",color:"#1f2937",margin:0},children:"🔊 音量設定"}),w.jsx("button",{onClick:A,style:{background:"none",border:"none",fontSize:"24px",color:"#6b7280",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},children:"×"})]}),w.jsx("div",{style:{marginBottom:"20px",textAlign:"center"},children:w.jsx("button",{onClick:()=>E(!_),style:{padding:"10px 20px",backgroundColor:_?"#ef4444":"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"background-color 0.2s"},children:_?"🔇 ミュート中":"🔊 音声ON"})}),w.jsxs("div",{style:{marginBottom:"16px"},children:[w.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"8px"},children:["🎵 BGM音量: ",Math.round(x*100),"%"]}),w.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:x,onChange:k=>g(parseFloat(k.target.value)),disabled:_,style:{width:"100%",height:"6px",borderRadius:"3px",background:_?"#d1d5db":`linear-gradient(to right, #d946ef 0%, #d946ef ${x*100}%, #e5e7eb ${x*100}%, #e5e7eb 100%)`,outline:"none",cursor:_?"not-allowed":"pointer"}})]}),w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"8px"},children:["🎯 効果音量: ",Math.round(y*100),"%"]}),w.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:y,onChange:k=>m(parseFloat(k.target.value)),disabled:_,style:{width:"100%",height:"6px",borderRadius:"3px",background:_?"#d1d5db":`linear-gradient(to right, #14b8a6 0%, #14b8a6 ${y*100}%, #e5e7eb ${y*100}%, #e5e7eb 100%)`,outline:"none",cursor:_?"not-allowed":"pointer"}})]}),w.jsxs("div",{style:{display:"flex",gap:"8px"},children:[w.jsx("button",{type:"button",style:{flex:1,backgroundColor:"#d946ef",color:"white",padding:"12px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:"pointer"},onClick:D,children:"適用"}),w.jsx("button",{type:"button",style:{flex:1,backgroundColor:"#6b7280",color:"white",padding:"12px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:"pointer"},onClick:A,children:"キャンセル"})]})]})}),d&&w.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},onClick:F,children:w.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",width:"320px",maxWidth:"90vw",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",transform:d?"scale(1)":"scale(0.9)",transition:"transform 0.2s ease-out"},onClick:k=>k.stopPropagation(),children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[w.jsx("h2",{style:{fontSize:"20px",fontWeight:"bold",color:"#1f2937",margin:0},children:"🔐 ログイン"}),w.jsx("button",{onClick:F,style:{background:"none",border:"none",fontSize:"24px",color:"#6b7280",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},children:"×"})]}),w.jsxs("div",{style:{marginBottom:"16px"},children:[w.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"4px"},children:"メールアドレス"}),w.jsx("input",{type:"email",placeholder:"example@email.com",style:{width:"100%",padding:"10px 12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",outline:"none",transition:"border-color 0.2s"},onFocus:k=>{const j=k.target;j.style.borderColor="#3b82f6"},onBlur:k=>{const j=k.target;j.style.borderColor="#e5e7eb"}})]}),w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"4px"},children:"パスワード"}),w.jsx("input",{type:"password",placeholder:"パスワードを入力",style:{width:"100%",padding:"10px 12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",outline:"none",transition:"border-color 0.2s"},onFocus:k=>{const j=k.target;j.style.borderColor="#3b82f6"},onBlur:k=>{const j=k.target;j.style.borderColor="#e5e7eb"}})]}),w.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[w.jsx("button",{type:"button",style:{flex:1,backgroundColor:"#3b82f6",color:"white",padding:"12px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"background-color 0.2s"},onClick:()=>{alert("ログイン機能は後で実装予定"),F()},onMouseOver:k=>{const j=k.target;j.style.backgroundColor="#2563eb"},onMouseOut:k=>{const j=k.target;j.style.backgroundColor="#3b82f6"},children:"ログイン"}),w.jsx("button",{type:"button",style:{flex:1,backgroundColor:"#6b7280",color:"white",padding:"12px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"background-color 0.2s"},onClick:()=>{alert("新規登録機能は後で実装予定"),F()},onMouseOver:k=>{const j=k.target;j.style.backgroundColor="#4b5563"},onMouseOut:k=>{const j=k.target;j.style.backgroundColor="#6b7280"},children:"新規登録"})]}),w.jsx("div",{style:{textAlign:"center",fontSize:"12px",color:"#6b7280"},children:"ゲスト使用も可能です"})]})})]})},bi=class bi{constructor(){he(this,"allTemplates",[]);he(this,"playHistory",[]);he(this,"maxHistorySize",7);he(this,"characterTypes",["girl","animal","child"]);he(this,"creators",["あいうえお","ねこすき","たのしい","はやい","どうぶつ","まほう","げーまー"])}static getInstance(){return bi.instance||(bi.instance=new bi),bi.instance}async loadAllTemplates(){try{if(console.log("RandomGameManager: 全テンプレート読み込み開始..."),this.allTemplates=await cr.getAllTemplates(),!this.allTemplates||this.allTemplates.length===0)throw new Error("テンプレートが見つかりません");return console.log(`RandomGameManager: ${this.allTemplates.length}個のテンプレート読み込み完了`),this.allTemplates}catch(e){throw console.error("RandomGameManager: テンプレート読み込みエラー:",e),e}}getNextRandomGame(){if(this.allTemplates.length===0)throw new Error("テンプレートが読み込まれていません。loadAllTemplates()を先に実行してください。");const e=this.getAvailableTemplates();if(e.length===0)return console.log("RandomGameManager: 履歴リセット（全テンプレートが最近プレイ済み）"),this.playHistory=[],this.getNextRandomGame();const t=this.selectRandomTemplate(e);this.addToHistory(t.id);const i=this.generateGameConfig(t);return console.log(`RandomGameManager: 選択されたゲーム - ${t.name} (${t.id})`),i}getAvailableTemplates(){return this.allTemplates.filter(e=>!this.isRecentlyPlayed(e.id))}selectRandomTemplate(e){const t=Math.floor(Math.random()*e.length);return e[t]}generateGameConfig(e){const t=this.getRandomCharacterType();return this.getRandomCreator(),{gameType:e.id,characterType:t,difficulty:e.defaultSettings.difficulty,duration:e.defaultSettings.duration,targetScore:e.defaultSettings.targetScore}}getRandomCharacterType(){const e=Math.floor(Math.random()*this.characterTypes.length);return this.characterTypes[e]}getRandomCreator(){const e=Math.floor(Math.random()*this.creators.length);return this.creators[e]}addToHistory(e){this.playHistory.push(e),this.playHistory.length>this.maxHistorySize&&(this.playHistory=this.playHistory.slice(-this.maxHistorySize)),console.log(`RandomGameManager: 履歴追加 ${e}, 現在の履歴: [${this.playHistory.join(", ")}]`)}isRecentlyPlayed(e){return this.playHistory.includes(e)}getStatus(){const e=this.getAvailableTemplates();return{totalTemplates:this.allTemplates.length,playHistory:[...this.playHistory],availableTemplates:e.length}}resetHistory(){this.playHistory=[],console.log("RandomGameManager: プレイ履歴リセット")}async reloadTemplates(){await this.loadAllTemplates(),console.log("RandomGameManager: テンプレート再読み込み完了")}};he(bi,"instance");let od=bi;const uR=({onExit:r})=>{const[e,t]=V.useState(null),[i,n]=V.useState(0),[s,o]=V.useState(!0),[a,l]=V.useState(1),[h,u]=V.useState(null),[c,d]=V.useState(!0),[f,p]=V.useState(null),v=V.useRef(od.getInstance()),x=async()=>{try{const m=v.current,_=m.getNextRandomGame(),b=(await cr.getAllTemplates()).find(R=>R.id===_.gameType);if(!b)throw new Error(`テンプレート ${_.gameType} が見つかりません`);const T=["あいうえお","ねこすき","たのしい","はやい","どうぶつ","まほう","げーまー"],S=T[Math.floor(Math.random()*T.length)],P={id:`${b.id}_${Date.now()}`,templateInfo:b,config:_,creator:S};return console.log("RandomGameManager統合: 新しいゲーム生成",{template:b.name,characterType:_.characterType,creator:S,status:m.getStatus()}),P}catch(m){throw console.error("ゲーム生成エラー:",m),m}};V.useEffect(()=>{(async()=>{d(!0),p(null);try{console.log("RandomGameManager統合: 初期化開始..."),await v.current.loadAllTemplates();const E=await x();t(E),console.log("RandomGameManager統合: 初期化完了")}catch(_){const E=_ instanceof Error?_.message:"不明なエラーが発生しました";p(E),console.error("初期化エラー:",_)}finally{d(!1)}})()},[]),V.useEffect(()=>{if(s&&a>0){const m=setTimeout(()=>{l(_=>_-1)},1e3);return()=>clearTimeout(m)}else s&&a===0&&o(!1)},[s,a]);const g=async(m,_)=>{console.log("Game ended:",m,_);const E=m?`🎉 やったね！
スコア: ${_||0}`:`😅 惜しい！
スコア: ${_||0}`;u({success:m||!1,message:E});try{const b=await x();setTimeout(()=>{u(null),t(b),n(T=>T+1),o(!0),l(1)},500)}catch(b){console.error("次のゲーム準備エラー:",b),p("次のゲームの準備に失敗しました")}},y=()=>{s?(o(!1),l(0)):g(!1,0)};return c?w.jsxs("div",{style:{height:"600px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",color:"white",fontSize:"18px",textAlign:"center"},children:[w.jsx("div",{style:{fontSize:"60px",marginBottom:"20px",animation:"spin 2s linear infinite"},children:"🎮"}),w.jsx("div",{style:{fontWeight:"bold",marginBottom:"10px"},children:"RandomGameManager準備中..."}),w.jsx("div",{style:{fontSize:"14px",opacity:.8},children:"全20テンプレート読み込み中"}),w.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]}):f||!e?w.jsxs("div",{style:{height:"600px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)",borderRadius:"12px",color:"white",fontSize:"18px",textAlign:"center"},children:[w.jsx("div",{style:{fontSize:"60px",marginBottom:"20px"},children:"❌"}),w.jsx("div",{style:{fontWeight:"bold",marginBottom:"10px"},children:"RandomGameManager エラー"}),w.jsx("div",{style:{fontSize:"14px",opacity:.8,maxWidth:"300px",marginBottom:"20px"},children:f||"ゲーム生成に失敗しました"}),w.jsx("button",{onClick:()=>window.location.reload(),style:{background:"rgba(255,255,255,0.2)",color:"white",border:"2px solid rgba(255,255,255,0.3)",borderRadius:"20px",padding:"10px 20px",fontSize:"14px",cursor:"pointer"},children:"リロードして再試行"})]}):h?w.jsxs("div",{style:{height:"600px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:h.success?"linear-gradient(135deg, #10b981 0%, #047857 100%)":"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",borderRadius:"12px",color:"white",fontSize:"24px",fontWeight:"bold",textAlign:"center"},children:[w.jsx("div",{style:{fontSize:"80px",marginBottom:"20px",textShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:h.success?"🎉":"😅"}),w.jsx("div",{style:{whiteSpace:"pre-line",textShadow:"0 2px 4px rgba(0,0,0,0.3)",lineHeight:"1.4"},children:h.message}),w.jsx("div",{style:{position:"absolute",bottom:"20px",fontSize:"14px",opacity:.8},children:"次のランダムゲームまで... (高速遷移)"})]}):s?w.jsxs("div",{style:{height:"600px",background:"#fce7ff",borderRadius:"12px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"#a21caf",position:"relative"},children:[w.jsx("div",{style:{fontSize:"80px",marginBottom:"20px"},children:"🎮"}),w.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",textAlign:"center",marginBottom:"10px"},children:e.templateInfo.instruction}),w.jsxs("div",{style:{fontSize:"12px",opacity:.6,textAlign:"center",marginBottom:"10px"},children:[e.templateInfo.name," - ",e.creator,"作"]}),w.jsx("div",{style:{fontSize:"14px",opacity:.8,textAlign:"center"},children:a>0?`${a}秒後に開始...`:"開始中..."})]}):w.jsx("div",{style:{position:"relative"},children:w.jsx(bx,{config:e.config,onGameEnd:g,onSkip:y,onExit:r},i)})},cR=({onExit:r})=>{const[e,t]=V.useState(null),[i,n]=V.useState(""),[s,o]=V.useState(0),[a,l]=V.useState({}),[h,u]=V.useState(!0),[c,d]=V.useState([]);V.useEffect(()=>{(async()=>{u(!0);try{console.log("テンプレート情報を読み込み中...");const g=await cr.getAllTemplates();d(g),console.log(`${g.length}個のテンプレートを発見`);const y=await cr.checkAllImplementations();l(y),console.log("実装状況チェック完了:",y)}catch(g){console.error("実装状況チェックでエラー:",g),d([]),l({})}finally{u(!1)}})()},[]);const f=async x=>{try{const g=await cr.getTemplateInfo(x);if(!g)throw new Error(`テンプレート情報が見つかりません: ${x}`);return{gameType:g.id,characterType:"girl",difficulty:g.defaultSettings.difficulty,duration:g.defaultSettings.duration,targetScore:g.defaultSettings.targetScore}}catch(g){return console.error("テスト設定作成エラー:",g),null}},p=async x=>{u(!0);try{const g=a[x];if(g!=null&&g.implemented?n(""):n(`ℹ️ ${x} は未実装のため CuteTapGame で代用テスト中...`),!await f(x)){n(`❌ ${x} のテスト設定作成に失敗しました`),u(!1);return}t(x),o(m=>m+1)}catch(g){console.error("テスト開始エラー:",g),n(`❌ テスト開始に失敗: ${g instanceof Error?g.message:"Unknown error"}`)}finally{u(!1)}},v=(x,g)=>{const y=x?`✅ 成功! スコア: ${g}`:`❌ 失敗 スコア: ${g}`,m=a[e],_=m!=null&&m.implemented?"(独自実装)":"(CuteTap代用)";n(`${y} ${_}`),setTimeout(()=>{t(null),n("")},3e3)};return h&&c.length===0?w.jsxs("div",{style:{padding:"40px",textAlign:"center",fontFamily:"Inter, sans-serif"},children:[w.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🔄"}),w.jsx("div",{style:{fontSize:"18px",color:"#374151",marginBottom:"10px"},children:"実装状況を自動チェック中..."}),w.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"全テンプレートの動作確認を行っています"})]}):e?w.jsxs("div",{style:{position:"relative"},children:[w.jsxs("div",{style:{position:"absolute",top:"-60px",left:"0",right:"0",backgroundColor:"#f3f4f6",borderRadius:"8px",padding:"10px",fontSize:"12px",textAlign:"center",zIndex:10,border:"2px solid #d946ef"},children:[w.jsxs("div",{style:{color:"#d946ef",fontWeight:"bold",marginBottom:"5px"},children:["🧪 テストモード: ",e]}),w.jsx("div",{style:{color:"#374151"},children:"テスト実行中...（エラーハンドリング強化版）"}),i&&w.jsx("div",{style:{marginTop:"5px",fontWeight:"bold",color:i.includes("✅")?"#10b981":"#ef4444"},children:i})]}),w.jsx("button",{onClick:r,style:{position:"absolute",top:"10px",right:"10px",background:"#ef4444",color:"white",border:"none",borderRadius:"15px",padding:"5px 10px",fontSize:"12px",cursor:"pointer",zIndex:10},children:"テスト終了"}),w.jsx("div",{style:{border:"3px solid #d946ef",borderRadius:"12px"},children:w.jsx(dR,{templateId:e,onGameEnd:v})})]}):w.jsxs("div",{style:{padding:"20px",fontFamily:"Inter, sans-serif"},children:[w.jsxs("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",backgroundColor:"#f3f4f6",borderRadius:"12px"},children:[w.jsx("h2",{style:{color:"#d946ef",margin:"0 0 10px 0"},children:"🧪 テンプレート動作確認モード (強化版)"}),w.jsx("p",{style:{color:"#6b7280",margin:0,fontSize:"14px"},children:"各テンプレートを個別にテスト + エラーハンドリング確認"})]}),w.jsx("button",{onClick:r,style:{position:"absolute",top:"20px",right:"20px",background:"#6b7280",color:"white",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",cursor:"pointer"},children:"通常モードに戻る"}),c.length===0?w.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[w.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"❌"}),w.jsx("div",{style:{fontSize:"18px",color:"#dc2626"},children:"テンプレートが見つかりません"}),w.jsx("div",{style:{fontSize:"14px",color:"#6b7280",marginTop:"10px"},children:"GameTemplateFactory の初期化に問題がある可能性があります"})]}):w.jsx("div",{style:{display:"grid",gap:"10px",maxHeight:"500px",overflowY:"auto"},children:c.map(x=>{const g=a[x.id]||{implemented:!1,hasFile:!1,isRegistered:!1,error:"状況不明"};let y,m,_,E,b,T,S;return g.implemented?(y="#f0f9ff",m="#0ea5e9",_="#0284c7",E="🧪 テスト実行 (強化版)",b="#10b981",T="✅",S="実装完了"):g.hasFile&&!g.isRegistered?(y="#f0fdf4",m="#22c55e",_="#15803d",E="⚙️ 要Factory登録",b="#22c55e",T="🔶",S="ファイルあり・未登録"):g.error?(y="#fef2f2",m="#ef4444",_="#dc2626",E="🚨 エラー確認 (強化版)",b="#ef4444",T="❌",S="エラー"):(y="#fef3c7",m="#f59e0b",_="#d97706",E="⚠️ 代用テスト (強化版)",b="#f59e0b",T="⏳",S="ChatGPT制作待ち"),w.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"15px",backgroundColor:y,borderRadius:"10px",border:`2px solid ${m}`},children:[w.jsxs("div",{style:{flex:1},children:[w.jsxs("div",{style:{fontWeight:"bold",color:_,marginBottom:"5px",display:"flex",alignItems:"center",gap:"8px"},children:[w.jsx("span",{children:T}),x.name,w.jsxs("span",{style:{fontSize:"12px"},children:["[",x.category,"]"]})]}),w.jsx("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"5px"},children:x.description}),w.jsxs("div",{style:{fontSize:"11px",color:"#9ca3af"},children:[x.defaultSettings.duration,"秒 | 目標:",x.defaultSettings.targetScore," |",x.defaultSettings.difficulty,w.jsxs("span",{style:{marginLeft:"10px",color:_,fontWeight:"bold"},children:["| ",S]}),g.error&&w.jsx("span",{style:{marginLeft:"5px",fontSize:"10px",backgroundColor:"#fee2e2",color:"#dc2626",padding:"1px 4px",borderRadius:"4px"},children:g.error})]})]}),w.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:w.jsx("button",{onClick:()=>p(x.id),disabled:h,style:{backgroundColor:b,color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",fontSize:"14px",cursor:h?"not-allowed":"pointer",fontWeight:"bold",minWidth:"140px",opacity:h?.6:1},children:h?"⏳ 準備中...":E})})]},x.id)})}),w.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#fef3c7",borderRadius:"10px",fontSize:"12px",color:"#92400e"},children:[w.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"🔍 強化版テスト手順"}),w.jsxs("div",{style:{lineHeight:"1.4"},children:["1. 「🧪 テスト」ボタンをクリック",w.jsx("br",{}),"2. ゲームが正常に開始するかチェック",w.jsx("br",{}),"3. キャラクター・UI・操作が正常かチェック",w.jsx("br",{}),"4. 制限時間・勝利条件が機能するかチェック",w.jsx("br",{}),"5. ゲーム終了時に結果が表示されるかチェック",w.jsx("br",{}),"6. ",w.jsx("strong",{children:"エラー発生時の自動復旧機能をチェック"}),w.jsx("br",{}),"7. ",w.jsx("strong",{children:"FPS・メモリ使用量の表示確認"}),w.jsx("br",{}),"8. ",w.jsx("strong",{children:"エラーモーダルの表示・操作確認"})]})]})]})},dR=({templateId:r,onGameEnd:e})=>{const[t,i]=V.useState(null),[n,s]=V.useState(!0);return V.useEffect(()=>{(async()=>{try{const a=await cr.getTemplateInfo(r);a&&i({gameType:a.id,characterType:"girl",difficulty:a.defaultSettings.difficulty,duration:a.defaultSettings.duration,targetScore:a.defaultSettings.targetScore})}catch(a){console.error("Config loading error:",a)}finally{s(!1)}})()},[r]),n||!t?w.jsx("div",{style:{padding:"40px",textAlign:"center",fontSize:"16px",color:"#6b7280"},children:"テスト設定を読み込み中..."}):w.jsx(bx,{config:t,onGameEnd:e})},fR=({isOpen:r,onClose:e})=>{const[t,i]=V.useState(null),[n,s]=V.useState({fps:0,memory:0,viewport:{width:0,height:0,ratio:"0:0"},env:{NODE_ENV:"unknown",SUPABASE_URL:"unknown",SUPABASE_KEY:"unknown",AUTH_ENABLED:!1}});return V.useEffect(()=>{let o=0,a=performance.now(),l=0,h;const u=()=>{l++;const c=performance.now();if(c-a>=1e3){o=Math.round(l*1e3/(c-a)),l=0,a=c;const d=performance.memory?Math.round(performance.memory.usedJSHeapSize/1024/1024):0,f={width:window.innerWidth,height:window.innerHeight,ratio:`${window.innerWidth}:${window.innerHeight}`},p=x=>{try{return{VITE_SUPABASE_URL:"https://rqzehjsygvkkvntswqbs.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxemVoanN5Z3Zra3ZudHN3cWJzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzOTA4MjEsImV4cCI6MjA3MTk2NjgyMX0.e6jBgtNNr1bPlP0L8XYqoMyZmWOjJaojgRrHvRhUU_0",VITE_ENABLE_AUTH:"true",VITE_ENABLE_USER_GAMES:"false",VITE_ENABLE_FAVORITES:"false",VITE_ENABLE_PLAYLISTS:"false",VITE_DEBUG_MODE:"true",VITE_ENABLE_AUTH_DEBUG:"true",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}[x]}catch{return}},v={NODE_ENV:p("MODE")||"unknown",SUPABASE_URL:p("VITE_SUPABASE_URL")?"✅ Set":"❌ Missing",SUPABASE_KEY:p("VITE_SUPABASE_ANON_KEY")?"✅ Set":"❌ Missing",AUTH_ENABLED:p("VITE_ENABLE_AUTH")==="true"};s({fps:o,memory:d,viewport:f,env:v})}h=requestAnimationFrame(u)};return u(),()=>{h&&cancelAnimationFrame(h)}},[]),V.useEffect(()=>{const o=setInterval(()=>{typeof window<"u"&&window.gameDebugData&&i(window.gameDebugData)},100);return()=>clearInterval(o)},[]),r?w.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},onClick:e,children:w.jsxs("div",{style:{backgroundColor:"#1f2937",color:"white",borderRadius:"16px",padding:"24px",width:"500px",maxWidth:"90vw",maxHeight:"80vh",overflow:"auto",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",fontFamily:"monospace"},onClick:o=>o.stopPropagation(),children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",borderBottom:"2px solid #374151",paddingBottom:"12px"},children:[w.jsx("h2",{style:{fontSize:"20px",fontWeight:"bold",color:"#10b981",margin:0},children:"🔧 統合デバッグ画面"}),w.jsx("button",{onClick:e,style:{background:"none",border:"none",fontSize:"24px",color:"#ef4444",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},children:"×"})]}),w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsx("h3",{style:{fontSize:"16px",color:"#fbbf24",marginBottom:"12px",borderLeft:"4px solid #fbbf24",paddingLeft:"8px"},children:"📊 システム情報"}),w.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",fontSize:"14px"},children:[w.jsxs("div",{style:{backgroundColor:"#374151",padding:"8px",borderRadius:"6px"},children:[w.jsx("div",{style:{color:"#10b981",fontWeight:"bold"},children:"FPS"}),w.jsx("div",{style:{fontSize:"18px",color:n.fps>50?"#10b981":"#ef4444"},children:n.fps})]}),w.jsxs("div",{style:{backgroundColor:"#374151",padding:"8px",borderRadius:"6px"},children:[w.jsx("div",{style:{color:"#10b981",fontWeight:"bold"},children:"Memory"}),w.jsxs("div",{style:{fontSize:"18px",color:n.memory>100?"#ef4444":"#10b981"},children:[n.memory," MB"]})]})]})]}),w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsx("h3",{style:{fontSize:"16px",color:"#3b82f6",marginBottom:"12px",borderLeft:"4px solid #3b82f6",paddingLeft:"8px"},children:"📱 ビューポート情報"}),w.jsxs("div",{style:{backgroundColor:"#374151",padding:"12px",borderRadius:"6px",fontSize:"12px"},children:[w.jsxs("div",{style:{marginBottom:"4px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"サイズ:"})," ",n.viewport.width," × ",n.viewport.height]}),w.jsxs("div",{style:{marginBottom:"4px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"比率:"})," ",n.viewport.ratio]}),w.jsxs("div",{children:[w.jsx("span",{style:{color:"#9ca3af"},children:"推奨:"})," 375 × 667 (9:16)"]})]})]}),w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsx("h3",{style:{fontSize:"16px",color:"#8b5cf6",marginBottom:"12px",borderLeft:"4px solid #8b5cf6",paddingLeft:"8px"},children:"🔐 環境変数"}),w.jsxs("div",{style:{backgroundColor:"#374151",padding:"12px",borderRadius:"6px",fontSize:"12px"},children:[w.jsxs("div",{style:{marginBottom:"4px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"NODE_ENV:"})," ",n.env.NODE_ENV]}),w.jsxs("div",{style:{marginBottom:"4px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"Supabase URL:"})," ",n.env.SUPABASE_URL]}),w.jsxs("div",{style:{marginBottom:"4px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"Supabase Key:"})," ",n.env.SUPABASE_KEY]}),w.jsxs("div",{children:[w.jsx("span",{style:{color:"#9ca3af"},children:"認証有効:"}),w.jsx("span",{style:{color:n.env.AUTH_ENABLED?"#10b981":"#f59e0b",fontWeight:"bold"},children:n.env.AUTH_ENABLED?" ✅ ON":" ⚠️ OFF"})]})]})]}),t&&w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsx("h3",{style:{fontSize:"16px",color:"#d946ef",marginBottom:"12px",borderLeft:"4px solid #d946ef",paddingLeft:"8px"},children:"🎮 ゲーム状態"}),w.jsxs("div",{style:{backgroundColor:"#374151",padding:"12px",borderRadius:"6px",fontSize:"12px"},children:[w.jsxs("div",{style:{marginBottom:"8px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"ステータス:"}),w.jsx("span",{style:{color:t.gameStatus==="ゲーム実行中"?"#10b981":"#f59e0b",fontWeight:"bold",marginLeft:"8px"},children:t.gameStatus})]}),w.jsxs("div",{style:{marginBottom:"8px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"ゲーム種類:"})," ",t.gameType]}),w.jsxs("div",{style:{marginBottom:"8px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"残り時間:"}),w.jsxs("span",{style:{color:t.timeRemaining<=3?"#ef4444":"#10b981",fontWeight:"bold",marginLeft:"8px"},children:[t.timeRemaining.toFixed(1),"s / ",t.totalTime,"s"]})]}),w.jsxs("div",{style:{marginBottom:"8px"},children:[w.jsx("span",{style:{color:"#9ca3af"},children:"実行中:"}),w.jsx("span",{style:{color:t.isGameRunning?"#10b981":"#ef4444",fontWeight:"bold",marginLeft:"8px"},children:t.isGameRunning?"▶️ Running":"⏸️ Paused"})]}),w.jsxs("div",{children:[w.jsx("span",{style:{color:"#9ca3af"},children:"音量:"}),w.jsx("div",{style:{marginTop:"4px"},children:t.isMuted?w.jsx("span",{style:{color:"#ef4444",fontWeight:"bold"},children:"🔇 ミュート"}):w.jsxs("div",{style:{fontSize:"11px"},children:[w.jsxs("span",{style:{color:"#3b82f6"},children:["BGM: ",Math.round(t.bgmVolume*100),"%"]}),w.jsxs("span",{style:{color:"#14b8a6",marginLeft:"8px"},children:["SE: ",Math.round(t.seVolume*100),"%"]})]})})]})]})]}),w.jsxs("div",{style:{display:"flex",gap:"8px",paddingTop:"12px",borderTop:"1px solid #374151"},children:[w.jsx("button",{onClick:()=>{console.log("=== COMPLETE DEBUG INFO ==="),console.log("System Info:",n),console.log("Game Debug Data:",t),console.log("Window Debug Data:",window.gameDebugData),alert("✅ デバッグ情報をコンソールに出力しました！")},style:{flex:1,backgroundColor:"#3b82f6",color:"white",padding:"8px 12px",borderRadius:"6px",border:"none",fontSize:"12px",cursor:"pointer"},children:"📋 コンソール出力"}),w.jsx("button",{onClick:()=>window.location.reload(),style:{flex:1,backgroundColor:"#f59e0b",color:"white",padding:"8px 12px",borderRadius:"6px",border:"none",fontSize:"12px",cursor:"pointer"},children:"🔄 リロード"})]})]})}):null},Fe={VIEWPORT:{WIDTH:1080,HEIGHT:1920,ASPECT_RATIO:9/16,MIN_WIDTH:320,MIN_HEIGHT:568,MAX_WIDTH:1440,MAX_HEIGHT:2560,PIXEL_RATIO:typeof window<"u"&&window.devicePixelRatio||1},GAME_AREA:{MAIN:{Y_START:.2,Y_END:.8,HEIGHT_RATIO:.6},HEADER:{Y_START:0,Y_END:.2,HEIGHT_RATIO:.2},FOOTER:{Y_START:.8,Y_END:1,HEIGHT_RATIO:.2}},ASSETS:{IMAGE:{FORMAT:"webp",FALLBACK_FORMAT:"png",QUALITY:60,BACKGROUND:{WIDTH:1080,HEIGHT:1920,MAX_SIZE_KB:500},XL:{MAX_WIDTH:400,MAX_HEIGHT:400,MAX_SIZE_KB:200},L:{MAX_WIDTH:200,MAX_HEIGHT:200,MAX_SIZE_KB:100},M:{MAX_WIDTH:100,MAX_HEIGHT:100,MAX_SIZE_KB:50},S:{MAX_WIDTH:50,MAX_HEIGHT:50,MAX_SIZE_KB:25}},AUDIO:{FORMAT:"mp3",FALLBACK_FORMAT:"ogg",BITRATE:64,BGM:{MAX_DURATION:30,MAX_SIZE_KB:240,LOOP:!0},SE:{MAX_DURATION:3,MAX_SIZE_KB:24,LOOP:!1}}},PERFORMANCE:{TARGET_FPS:60,MIN_FPS:30,MAX_MEMORY_MB:100,MAX_CONCURRENT_LOADS:5,CACHE_SIZE_MB:50},UI:{BUTTON_HEIGHT:60,BUTTON_RADIUS:30,TIMER_BAR:{HEIGHT:8,POSITION_Y:1900,MARGIN:20},VOLUME_BUTTON:{SIZE:48,POSITION_X:1020,POSITION_Y:60},SKIP_EXIT_BUTTONS:{HEIGHT:40,POSITION_Y:80,SPACING:20}},ANIMATION:{DURATION:{FAST:200,NORMAL:300,SLOW:500},EASING:{IN:"easeInQuad",OUT:"easeOutQuad",IN_OUT:"easeInOutQuad"}}};function lo(){const r=window.innerWidth,e=window.innerHeight,t=r/e,i=window.devicePixelRatio||1,n=r/Fe.VIEWPORT.WIDTH,s=e/Fe.VIEWPORT.HEIGHT,o=Math.min(n,s);let a="desktop";r<=768?a="mobile":r<=1024&&(a="tablet");const l=r>e?"landscape":"portrait",h={top:ua("safe-area-inset-top")||0,right:ua("safe-area-inset-right")||0,bottom:ua("safe-area-inset-bottom")||0,left:ua("safe-area-inset-left")||0};return{width:r,height:e,scale:o,aspectRatio:t,deviceType:a,orientation:l,pixelRatio:i,safeArea:h}}function Ax(r,e){const t=lo(),i=r||t.width,n=e||t.height,s=Math.min(i/Fe.VIEWPORT.WIDTH,n/Fe.VIEWPORT.HEIGHT),o=Fe.VIEWPORT.WIDTH*s,a=Fe.VIEWPORT.HEIGHT*s,l=(i-o)/2,h=(n-a)/2;return{game:{x:l,y:h,width:o,height:a},header:{x:l,y:h,width:o,height:a*Fe.GAME_AREA.HEADER.HEIGHT_RATIO},main:{x:l,y:h+a*Fe.GAME_AREA.MAIN.Y_START,width:o,height:a*Fe.GAME_AREA.MAIN.HEIGHT_RATIO},footer:{x:l,y:h+a*Fe.GAME_AREA.FOOTER.Y_START,width:o,height:a*Fe.GAME_AREA.FOOTER.HEIGHT_RATIO}}}function ua(r){var i,n;if(typeof window>"u"||!((n=(i=window.CSS)==null?void 0:i.supports)!=null&&n.call(i,"top",`env(${r})`)))return 0;const e=document.createElement("div");e.style.position="absolute",e.style.top=`env(${r})`,document.body.appendChild(e);const t=window.getComputedStyle(e).top;return document.body.removeChild(e),parseFloat(t)||0}function pR(r,e={}){const{throttleMs:t=100,includeOrientation:i=!0}=e;let n=null,s=lo();const o=()=>{n&&clearTimeout(n),n=setTimeout(()=>{const a=lo();(s.width!==a.width||s.height!==a.height||i&&s.orientation!==a.orientation)&&(s=a,r(a)),n=null},t)};return window.addEventListener("resize",o),i&&window.addEventListener("orientationchange",o),r(s),()=>{n&&clearTimeout(n),window.removeEventListener("resize",o),i&&window.removeEventListener("orientationchange",o)}}function mg(r){const e=r||lo(),t=Ax();if(typeof document<"u"){const i=document.documentElement;i.style.setProperty("--viewport-width",`${e.width}px`),i.style.setProperty("--viewport-height",`${e.height}px`),i.style.setProperty("--viewport-scale",e.scale.toString()),i.style.setProperty("--pixel-ratio",e.pixelRatio.toString()),i.style.setProperty("--game-width",`${t.game.width}px`),i.style.setProperty("--game-height",`${t.game.height}px`),i.style.setProperty("--game-offset-x",`${t.game.x}px`),i.style.setProperty("--game-offset-y",`${t.game.y}px`),i.style.setProperty("--safe-area-top",`${e.safeArea.top}px`),i.style.setProperty("--safe-area-right",`${e.safeArea.right}px`),i.style.setProperty("--safe-area-bottom",`${e.safeArea.bottom}px`),i.style.setProperty("--safe-area-left",`${e.safeArea.left}px`),i.className=i.className.replace(/device-(mobile|tablet|desktop)/g,"").trim(),i.classList.add(`device-${e.deviceType}`),i.className=i.className.replace(/orientation-(portrait|landscape)/g,"").trim(),i.classList.add(`orientation-${e.orientation}`)}}const mR=()=>{const[r,e]=V.useState(()=>lo()),[t,i]=V.useState(!0);V.useEffect(()=>(mg(),console.log("🚀 Phase 4 Viewport Integration Test Started"),console.log("Viewport Info:",r),console.log("Game Config:",{viewport:Fe.VIEWPORT,ui:Fe.UI}),pR(o=>{e(o),mg(o),console.log("Viewport Changed:",o)})),[]);const n=()=>i(!t);return t?w.jsxs("div",{style:{position:"fixed",top:"60px",left:"10px",backgroundColor:"rgba(0, 0, 0, 0.9)",color:"white",padding:"12px",fontSize:"11px",fontFamily:"monospace",zIndex:9998,borderRadius:"6px",maxWidth:"280px",boxShadow:"0 4px 12px rgba(0,0,0,0.5)",border:"1px solid #4f46e5"},children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[w.jsx("h3",{style:{margin:0,color:"#4ade80",fontSize:"12px"},children:"📱 Viewport Test (Week 1)"}),w.jsx("button",{onClick:n,style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",fontSize:"12px"},children:"✕"})]}),w.jsxs("div",{style:{marginBottom:"8px"},children:[w.jsx("div",{style:{color:"#fbbf24",fontWeight:"bold"},children:"Current Viewport:"}),w.jsxs("div",{children:["Size: ",r.width,"×",r.height]}),w.jsxs("div",{children:["Scale: ",r.scale.toFixed(3)]}),w.jsxs("div",{children:["Device: ",r.deviceType]}),w.jsxs("div",{children:["Orientation: ",r.orientation]}),w.jsxs("div",{children:["Ratio: ",r.aspectRatio.toFixed(3)]})]}),w.jsxs("div",{style:{marginBottom:"8px"},children:[w.jsx("div",{style:{color:"#fbbf24",fontWeight:"bold"},children:"Game Config:"}),w.jsxs("div",{children:["Base: ",Fe.VIEWPORT.WIDTH,"×",Fe.VIEWPORT.HEIGHT]}),w.jsxs("div",{children:["Aspect: ",Fe.VIEWPORT.ASPECT_RATIO]}),w.jsxs("div",{children:["Timer Y: ",Fe.UI.TIMER_BAR.POSITION_Y]}),w.jsxs("div",{children:["Volume: (",Fe.UI.VOLUME_BUTTON.POSITION_X,", ",Fe.UI.VOLUME_BUTTON.POSITION_Y,")"]})]}),w.jsxs("div",{style:{marginTop:"8px",padding:"4px",backgroundColor:"rgba(34, 197, 94, 0.2)",borderRadius:"3px",fontSize:"10px"},children:[w.jsx("div",{style:{color:"#10b981",fontWeight:"bold"},children:"Integration Status:"}),w.jsx("div",{children:"✅ gameConfig imported"}),w.jsx("div",{children:"✅ viewportUtils imported"}),w.jsx("div",{children:"✅ CSS variables set"}),w.jsx("div",{children:"✅ Responsive monitoring"})]}),w.jsx("div",{style:{marginTop:"8px"},children:w.jsx("button",{onClick:()=>{const s=Ax();console.log("=== VIEWPORT TEST RESULTS ==="),console.log("Current Viewport:",r),console.log("Game Area Bounds:",s),console.log("CSS Variables Check:",{viewportWidth:getComputedStyle(document.documentElement).getPropertyValue("--viewport-width"),gameWidth:getComputedStyle(document.documentElement).getPropertyValue("--game-width"),gameOffsetX:getComputedStyle(document.documentElement).getPropertyValue("--game-offset-x")}),alert("✅ Test completed! Check browser console for detailed results.")},style:{width:"100%",padding:"4px 8px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"3px",fontSize:"10px",cursor:"pointer"},children:"🔍 Run Console Test"})})]}):w.jsx("button",{onClick:n,style:{position:"fixed",top:"10px",left:"50%",transform:"translateX(-50%)",zIndex:1e4,padding:"8px 16px",backgroundColor:"#4f46e5",color:"white",border:"none",borderRadius:"6px",fontSize:"12px",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"📱 Show Viewport Test"})},gR=({children:r})=>(V.useEffect(()=>{console.log("%c🚀 Phase 4 Week 1 Integration Active","color: #10b981; font-weight: bold; font-size: 14px; background: #000; padding: 4px 8px; border-radius: 4px;")},[]),w.jsxs(w.Fragment,{children:[r,w.jsx(mR,{})]})),yR=({onClose:r})=>w.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #fce7ff 0%, #ccfbf1 100%)"},children:w.jsxs("div",{style:{backgroundColor:"white",padding:"40px",borderRadius:"20px",textAlign:"center",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},children:[w.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"🚧"}),w.jsx("h2",{style:{color:"#dc2626",marginBottom:"16px"},children:"エディター機能を読み込めませんでした"}),w.jsxs("p",{style:{color:"#6b7280",marginBottom:"24px"},children:["エディター機能の実装が必要です。",w.jsx("br",{}),"Phase 6.2のファイルが正しく配置されていることを確認してください。"]}),w.jsx("button",{onClick:r||(()=>{}),style:{padding:"12px 24px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"16px"},children:"ゲームに戻る"})]})}),vR=uo.lazy(()=>ge(()=>import("./EditorApp-d03081f6.js"),[]).then(r=>({default:r.EditorApp})).catch(r=>(console.warn("EditorApp読み込み失敗:",r),{default:yR}))),xR={bgm:.7,se:.8,muted:!1},gg=uo.lazy(async()=>{try{return{default:(await ge(()=>import("./useAuth-c99b66df.js"),[])).AuthProvider}}catch(r){return console.warn("AuthProvider読み込み失敗:",r),{default:({children:e})=>w.jsx(w.Fragment,{children:e})}}}),yg=uo.lazy(async()=>{try{return await ge(()=>import("./AuthModal-64200e9d.js"),["assets/AuthModal-64200e9d.js","assets/useAuth-c99b66df.js"])}catch(r){return console.warn("AuthModal読み込み失敗:",r),{default:()=>null}}}),vg=uo.lazy(async()=>{try{return await ge(()=>import("./ProfileSetup-91fbc1f9.js"),["assets/ProfileSetup-91fbc1f9.js","assets/useAuth-c99b66df.js"])}catch(r){return console.warn("ProfileSetup読み込み失敗:",r),{default:()=>null}}}),_R=()=>{var h,u,c,d,f,p;const[r,e]=V.useState(null),[t,i]=V.useState(!1),[n,s]=V.useState("signin"),[o,a]=V.useState(!1);if(V.useEffect(()=>{ge(()=>import("./useAuth-c99b66df.js"),[]).then(v=>{e(()=>v.useAuth)}).catch(v=>{console.warn("useAuth読み込み失敗:",v),e(()=>()=>({isAuthenticated:!1,user:null,profile:null,loading:!1,error:null,signOut:()=>{},clearError:()=>{}}))})},[]),V.useEffect(()=>{const v=g=>{var y;s(((y=g.detail)==null?void 0:y.mode)||"signin"),i(!0)},x=()=>{a(!0)};return window.addEventListener("openAuthModal",v),window.addEventListener("openProfileSetup",x),()=>{window.removeEventListener("openAuthModal",v),window.removeEventListener("openProfileSetup",x)}},[]),!r)return w.jsx("div",{style:{backgroundColor:"white",borderRadius:"15px",padding:"15px",marginBottom:"20px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb",textAlign:"center"},children:w.jsx("div",{style:{color:"#6b7280",fontSize:"14px"},children:"認証システム読み込み中..."})});const l=r();return w.jsxs("div",{style:{backgroundColor:"white",borderRadius:"15px",padding:"15px",marginBottom:"20px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[w.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(45deg, #d946ef, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"16px"},children:((u=(h=l.profile)==null?void 0:h.display_name)==null?void 0:u.charAt(0).toUpperCase())||((d=(c=l.profile)==null?void 0:c.username)==null?void 0:d.charAt(0).toUpperCase())||((p=(f=l.user)==null?void 0:f.email)==null?void 0:p.charAt(0).toUpperCase())||"?"}),w.jsx("div",{children:l.profile?w.jsxs(w.Fragment,{children:[w.jsx("div",{style:{fontWeight:"600",color:"#111827"},children:l.profile.display_name||l.profile.username}),w.jsxs("div",{style:{fontSize:"12px",color:"#6b7280"},children:["@",l.profile.username]})]}):l.user?w.jsxs(w.Fragment,{children:[w.jsx("div",{style:{fontWeight:"600",color:"#111827"},children:l.user.email}),w.jsx("div",{style:{fontSize:"12px",color:"#f59e0b"},children:"プロフィール設定が必要"})]}):w.jsx("div",{style:{fontWeight:"600",color:"#6b7280"},children:"ゲスト"})})]}),w.jsx("div",{style:{display:"flex",gap:"8px"},children:l.isAuthenticated?w.jsxs(w.Fragment,{children:[l.profile?w.jsx("button",{onClick:()=>a(!0),style:{padding:"6px 12px",fontSize:"12px",color:"#3b82f6",backgroundColor:"#eff6ff",border:"none",borderRadius:"6px",cursor:"pointer"},children:"編集"}):w.jsx("button",{onClick:()=>a(!0),style:{padding:"6px 12px",fontSize:"12px",color:"white",background:"linear-gradient(45deg, #3b82f6, #8b5cf6)",border:"none",borderRadius:"6px",cursor:"pointer"},children:"設定"}),w.jsx("button",{onClick:l.signOut,disabled:l.loading,style:{padding:"6px 12px",fontSize:"12px",color:"#ef4444",backgroundColor:"#fef2f2",border:"none",borderRadius:"6px",cursor:"pointer",opacity:l.loading?.5:1},children:"ログアウト"})]}):w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:()=>{s("signin"),i(!0)},style:{padding:"6px 12px",fontSize:"12px",color:"#3b82f6",backgroundColor:"#eff6ff",border:"none",borderRadius:"6px",cursor:"pointer"},children:"ログイン"}),w.jsx("button",{onClick:()=>{s("signup"),i(!0)},style:{padding:"6px 12px",fontSize:"12px",color:"white",background:"linear-gradient(45deg, #3b82f6, #8b5cf6)",border:"none",borderRadius:"6px",cursor:"pointer"},children:"新規登録"})]})})]}),l.error&&w.jsxs("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"6px",color:"#dc2626",fontSize:"14px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[w.jsx("span",{children:l.error}),w.jsx("button",{onClick:l.clearError,style:{color:"#dc2626",backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"0",fontSize:"16px"},children:"×"})]}),yg&&w.jsx(V.Suspense,{fallback:null,children:w.jsx(yg,{isOpen:t,onClose:()=>i(!1),defaultMode:n})}),vg&&w.jsx(V.Suspense,{fallback:null,children:w.jsx(vg,{isOpen:o,onClose:()=>a(!1),mode:l.profile?"edit":"setup"})})]})};function xg(){const[r,e]=V.useState("sequence"),[t,i]=V.useState(!1),[n,s]=V.useState(xR);V.useEffect(()=>{try{const c=localStorage.getItem("gameVolumeSettings");if(c){const d=JSON.parse(c);s(f=>({...f,...d}))}}catch(c){console.warn("音量設定の読み込みに失敗:",c)}},[]),V.useCallback(c=>{try{localStorage.setItem("gameVolumeSettings",JSON.stringify(c)),s(c),typeof window<"u"&&(window.gameVolumeSettings=c)}catch(d){console.warn("音量設定の保存に失敗:",d)}},[]);const o=()=>{window.location.reload()},a=()=>{e("test")},l=()=>{e("sequence")},h=()=>{e("editor")},u=()=>{e("sequence")};return r==="editor"?w.jsx(V.Suspense,{fallback:w.jsx("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center",background:"linear-gradient(135deg, #fce7ff 0%, #ccfbf1 100%)"},children:w.jsxs("div",{style:{textAlign:"center"},children:[w.jsx("div",{style:{marginBottom:"16px",fontSize:"48px"},children:"🎨"}),w.jsx("div",{style:{color:"#6b7280",fontSize:"18px",fontWeight:"600"},children:"エディターを読み込み中..."}),w.jsx("div",{style:{color:"#9ca3af",fontSize:"14px",marginTop:"8px"},children:"Phase 6.2 ゲームエディター機能"})]})}),children:w.jsx(vR,{onClose:u})}):w.jsxs("div",{className:"App",style:{minHeight:"100vh",background:"linear-gradient(135deg, #fce7ff 0%, #ccfbf1 100%)",padding:"20px",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"Inter, sans-serif"},children:[w.jsxs("header",{style:{marginBottom:"20px",textAlign:"center"},children:[w.jsx("h1",{style:{color:"#a21caf",fontSize:"2.5rem",margin:"0 0 10px 0",textShadow:"2px 2px 4px rgba(0,0,0,0.1)"},children:"🌟 Swizzle Platform"}),w.jsx("p",{style:{color:"#52525b",margin:0,fontSize:"1.2rem",fontWeight:"500"},children:r==="sequence"?"メイドイン俺風・完全自動連続ゲーム体験":"テンプレート動作確認モード"}),w.jsx("div",{style:{marginTop:"10px",padding:"6px 12px",backgroundColor:"rgba(236, 72, 153, 0.1)",border:"1px solid #ec4899",borderRadius:"15px",fontSize:"12px",color:"#be185d",display:"inline-block"},children:"✨ Phase 6.2: ゲームエディター機能実装完了 - プロジェクト作成・管理・4タブUI"}),w.jsxs("div",{style:{marginTop:"15px",display:"flex",gap:"8px",justifyContent:"center",flexWrap:"wrap"},children:[w.jsx("button",{onClick:l,style:{backgroundColor:r==="sequence"?"#10b981":"white",color:r==="sequence"?"white":"#10b981",border:"2px solid #10b981",borderRadius:"20px",padding:"8px 16px",fontSize:"12px",cursor:"pointer",fontWeight:"bold"},children:"🎮 通常プレイ"}),w.jsx("button",{onClick:a,style:{backgroundColor:r==="test"?"#f59e0b":"white",color:r==="test"?"white":"#f59e0b",border:"2px solid #f59e0b",borderRadius:"20px",padding:"8px 16px",fontSize:"12px",cursor:"pointer",fontWeight:"bold"},children:"🧪 テストモード"}),w.jsxs("button",{onClick:h,style:{backgroundColor:"#ec4899",color:"white",border:"2px solid #ec4899",borderRadius:"20px",padding:"8px 16px",fontSize:"12px",cursor:"pointer",fontWeight:"bold",position:"relative",overflow:"hidden"},children:[w.jsx("span",{style:{position:"relative",zIndex:2},children:"🎨 エディター"}),w.jsx("div",{style:{position:"absolute",top:"-2px",right:"-2px",background:"linear-gradient(45deg, #fbbf24, #f59e0b)",color:"white",fontSize:"8px",padding:"2px 4px",borderRadius:"4px",fontWeight:"bold",animation:"pulse 2s infinite"},children:"NEW"})]}),w.jsx("button",{onClick:()=>i(!0),style:{backgroundColor:"#8b5cf6",color:"white",border:"2px solid #8b5cf6",borderRadius:"20px",padding:"8px 16px",fontSize:"12px",cursor:"pointer",fontWeight:"bold"},children:"🔧 デバッグ画面"})]})]}),w.jsx(_R,{}),w.jsxs("main",{style:{backgroundColor:"white",borderRadius:"20px",padding:"20px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",maxWidth:"450px",width:"100%",position:"relative"},children:[r==="sequence"&&w.jsx(uR,{onExit:o}),r==="test"&&w.jsx(cR,{onExit:l})]}),w.jsxs("footer",{style:{marginTop:"20px",color:"#6b7280",fontSize:"14px",textAlign:"center"},children:[w.jsxs("div",{children:["Phase 6.2: ",r==="sequence"?"完全自動連続プレイ":r==="test"?"テンプレート動作確認":"ゲームエディター"," | 🎯 エディター機能実装完了 ✨"]}),w.jsx("div",{style:{fontSize:"12px",marginTop:"5px",color:"#10b981"},children:"🔐 認証システム統合完了 | ユーザー管理・プロフィール機能対応"}),w.jsx("div",{style:{fontSize:"12px",marginTop:"5px",color:"#3b82f6"},children:"📱 ビューポート統合・アセット仕様策定 | 9:16アスペクト比対応"}),w.jsx("div",{style:{fontSize:"12px",marginTop:"5px",color:"#22c55e"},children:"🔊 音量設定・ゲーム内UI統合完了 | 残り時間バー・オーバーレイ統合"}),w.jsx("div",{style:{fontSize:"12px",marginTop:"5px",color:"#8b5cf6"},children:"🔧 統合デバッグ画面完成 | Viewport・環境変数・FPS・Memory・ゲーム状態統合"}),w.jsx("div",{style:{fontSize:"12px",marginTop:"5px",color:"#ec4899"},children:"🎨 エディター機能: プロジェクト作成・4タブUI（絵・音・ルール・公開）・容量管理"}),w.jsxs("div",{style:{fontSize:"12px",marginTop:"5px"},children:["💡 ",r==="sequence"?"完成: 上部バー・タイトル・残り時間バー・ログイン/音量オーバーレイ":r==="test"?"ChatGPT制作テンプレートの動作確認・デバッグ用":"5-30秒ショートゲームの簡単作成・公開プラットフォーム"]}),w.jsx("div",{style:{fontSize:"11px",marginTop:"8px",color:"#9ca3af"},children:"🚀 進捗: 基盤完成 → テンプレート量産 → 認証統合 → 画面統一 → 音量統合 → UI完成 → ✨ エディター実装"})]}),w.jsx(fR,{isOpen:t,onClose:()=>i(!1)}),w.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
      `})]})}function wR(){const r=()=>gg?w.jsx(V.Suspense,{fallback:w.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"linear-gradient(135deg, #fce7ff 0%, #ccfbf1 100%)"},children:w.jsxs("div",{style:{textAlign:"center"},children:[w.jsx("div",{style:{marginBottom:"16px",fontSize:"24px"},children:"🌟"}),w.jsx("div",{style:{color:"#6b7280"},children:"認証システム読み込み中..."})]})}),children:w.jsx(gg,{children:w.jsx(xg,{})})}):w.jsx(xg,{});return w.jsx(gR,{children:w.jsx(r,{})})}vu.createRoot(document.getElementById("root")).render(w.jsx(uo.StrictMode,{children:w.jsx(wR,{})}));export{Pt as C,hR as G,uo as R,Qn as S,$ as T,ge as _,Tn as a,Bi as b,bs as c,J as d,Px as g,w as j,V as r};
//# sourceMappingURL=index-a4c7ba8a.js.map
