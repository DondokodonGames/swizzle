import{r as o,j as e}from"./index-a4c7ba8a.js";import{useAuth as F}from"./useAuth-c99b66df.js";const z=({isOpen:d,onClose:c,defaultMode:u="signin"})=>{const{signIn:N,signUp:v,resetPassword:k,loading:n,error:b,clearError:f}=F(),[a,m]=o.useState(u),[s,j]=o.useState({email:"",password:"",confirmPassword:"",username:"",displayName:"",age:"",language:"ja"}),[t,p]=o.useState({}),[x,C]=o.useState(!1),[y,g]=o.useState(!1);o.useEffect(()=>{d&&(m(u),j({email:"",password:"",confirmPassword:"",username:"",displayName:"",age:"",language:"ja"}),p({}),f())},[d,u,f]),o.useEffect(()=>{const r=i=>{i.key==="Escape"&&d&&c()};return d&&(document.addEventListener("keydown",r),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",r),document.body.style.overflow="unset"}},[d,c]);const P=()=>{const r={};if(s.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)||(r.email="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“"):r.email="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",a!=="reset"&&(s.password.trim()?s.password.length<6&&(r.password="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯6æ–‡å­—ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™"):r.password="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"),a==="signup"){s.password!==s.confirmPassword&&(r.confirmPassword="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“"),s.username.trim()?s.username.length<3?r.username="ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯3æ–‡å­—ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™":/^[a-zA-Z0-9_]+$/.test(s.username)||(r.username="ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯è‹±æ•°å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã®ã¿ä½¿ç”¨ã§ãã¾ã™"):r.username="ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„";const i=parseInt(s.age);!s.age.trim()||isNaN(i)?r.age="å¹´é½¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„":(i<6||i>100)&&(r.age="å¹´é½¢ã¯6æ­³ä»¥ä¸Š100æ­³ä»¥ä¸‹ã§å…¥åŠ›ã—ã¦ãã ã•ã„")}return p(r),Object.keys(r).length===0},w=async r=>{if(r.preventDefault(),!!P())try{if(a==="signin")await N(s.email,s.password),c();else if(a==="signup"){const i=parseInt(s.age);if(i<13&&!y){g(!0);return}await v(s.email,s.password,{username:s.username,displayName:s.displayName||s.username,age:i,language:s.language}),c()}else a==="reset"&&(await k(s.email),alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚ãƒ¡ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚"),m("signin"))}catch(i){console.error("Auth error:",i)}},l=r=>{const{name:i,value:E}=r.target;j(h=>({...h,[i]:E})),t[i]&&p(h=>({...h,[i]:""}))};return d?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:c}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 transform transition-all",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{onClick:c,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",disabled:n,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"ğŸ®"})}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:[a==="signin"&&"ãƒ­ã‚°ã‚¤ãƒ³",a==="signup"&&"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ",a==="reset"&&"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ"]}),e.jsxs("p",{className:"text-gray-600 mt-2",children:[a==="signin"&&"ã‚²ãƒ¼ãƒ ä½œæˆã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼",a==="signup"&&"æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ",a==="reset"&&"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"]})]}),b&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm",children:b}),y&&e.jsxs("div",{className:"mb-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-amber-800 mb-2",children:"âš ï¸ ä¿è­·è€…ã®åŒæ„ã«ã¤ã„ã¦"}),e.jsx("p",{className:"text-amber-700 text-sm mb-3",children:"13æ­³æœªæº€ã®ãŠå­æ§˜ã«ã¯ä¿è­·è€…ã®åŒæ„ãŒå¿…è¦ã§ã™ã€‚ä¿è­·è€…ã®æ–¹ã¨ä¸€ç·’ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-3 py-1 bg-white border border-amber-300 text-amber-700 rounded-lg text-sm",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),e.jsx("button",{type:"button",onClick:()=>{g(!1),w({preventDefault:()=>{}})},className:"px-3 py-1 bg-amber-600 text-white rounded-lg text-sm",children:"åŒæ„ã—ã¦ç¶šã‘ã‚‹"})]})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹"}),e.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:l,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors ${t.email?"border-red-300 bg-red-50":"border-gray-300"}`,placeholder:"your@example.com",disabled:n}),t.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.email})]}),a!=="reset"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:x?"text":"password",id:"password",name:"password",value:s.password,onChange:l,className:`w-full px-4 py-3 pr-12 border rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors ${t.password?"border-red-300 bg-red-50":"border-gray-300"}`,placeholder:"6æ–‡å­—ä»¥ä¸Š",disabled:n}),e.jsx("button",{type:"button",onClick:()=>C(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:n,children:x?"ğŸ™ˆ":"ğŸ‘ï¸"})]}),t.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.password})]}),a==="signup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª"}),e.jsx("input",{type:x?"text":"password",id:"confirmPassword",name:"confirmPassword",value:s.confirmPassword,onChange:l,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors ${t.confirmPassword?"border-red-300 bg-red-50":"border-gray-300"}`,placeholder:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†å…¥åŠ›",disabled:n}),t.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.confirmPassword})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"}),e.jsx("input",{type:"text",id:"username",name:"username",value:s.username,onChange:l,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors ${t.username?"border-red-300 bg-red-50":"border-gray-300"}`,placeholder:"åŠè§’è‹±æ•°å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢",disabled:n}),t.username&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.username})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 mb-1",children:["è¡¨ç¤ºå ",e.jsx("span",{className:"text-gray-400 text-xs",children:"(ä»»æ„)"})]}),e.jsx("input",{type:"text",id:"displayName",name:"displayName",value:s.displayName,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors",placeholder:"ã¿ã‚“ãªã«è¡¨ç¤ºã•ã‚Œã‚‹åå‰",disabled:n})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 mb-1",children:"å¹´é½¢"}),e.jsx("input",{type:"number",id:"age",name:"age",value:s.age,onChange:l,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors ${t.age?"border-red-300 bg-red-50":"border-gray-300"}`,placeholder:"15",min:"6",max:"100",disabled:n}),t.age&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.age})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-gray-700 mb-1",children:"è¨€èª"}),e.jsxs("select",{id:"language",name:"language",value:s.language,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors",disabled:n,children:[e.jsx("option",{value:"ja",children:"æ—¥æœ¬èª"}),e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"ko",children:"í•œêµ­ì–´"}),e.jsx("option",{value:"zh",children:"ä¸­æ–‡"})]})]})]})]}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 rounded-xl font-semibold hover:from-pink-600 hover:to-purple-700 focus:ring-4 focus:ring-pink-200 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"å‡¦ç†ä¸­..."]}):e.jsxs(e.Fragment,{children:[a==="signin"&&"ãƒ­ã‚°ã‚¤ãƒ³",a==="signup"&&"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ",a==="reset"&&"ãƒªã‚»ãƒƒãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡"]})})]}),e.jsxs("div",{className:"mt-6 text-center text-sm",children:[a==="signin"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-600",children:["ã¾ã ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„æ–¹ã¯"," ",e.jsx("button",{type:"button",onClick:()=>m("signup"),className:"text-pink-600 hover:text-pink-700 font-medium",disabled:n,children:"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ"})]}),e.jsx("p",{className:"mt-2",children:e.jsx("button",{type:"button",onClick:()=>m("reset"),className:"text-gray-500 hover:text-gray-700",disabled:n,children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸæ–¹"})})]}),a==="signup"&&e.jsxs("p",{className:"text-gray-600",children:["æ—¢ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã®æ–¹ã¯"," ",e.jsx("button",{type:"button",onClick:()=>m("signin"),className:"text-pink-600 hover:text-pink-700 font-medium",disabled:n,children:"ãƒ­ã‚°ã‚¤ãƒ³"})]}),a==="reset"&&e.jsx("p",{className:"text-gray-600",children:e.jsx("button",{type:"button",onClick:()=>m("signin"),className:"text-pink-600 hover:text-pink-700 font-medium",disabled:n,children:"ãƒ­ã‚°ã‚¤ãƒ³ã«æˆ»ã‚‹"})})]})]})})]}):null};export{z as default};
//# sourceMappingURL=AuthModal-64200e9d.js.map
